<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.10.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Devil的个人博客">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Devil的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Devil">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Devil的个人博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Devil的个人博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Devil的个人博客</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">永远详细美好的事情永远发生</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Devil"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Devil</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Devildyw" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Devildyw" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1842501760@qq.com" title="E-Mail → mailto:1842501760@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>
  
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width:100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/" rel="tag">database</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a><span class="tag-list-count">11</span></li></ul>
        </canvas>
    </div>
</div>




    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/28/Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Devil">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/28/Spring/" class="post-title-link" itemprop="url">Spring</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-02-28 20:58:54 / 修改时间：21:03:29" itemprop="dateCreated datePublished" datetime="2022-02-28T20:58:54+08:00">2022-02-28</time>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>13k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>spring全家桶：spring ， springmvc ，spring boot , spring cloud </p>
<p>  spring: 出现是在2002左右，解决企业开发的难度。减轻对项目模块之间的管理，<br>          类和类之间的管理， 帮助开发人员创建对象，管理对象之间的关系。<br>             spring核心技术 ioc ， aop 。能实现模块之间，类之间的解耦合。</p>
<p><strong>耦合</strong>:是指两个或两个以上的体系或两种运动形式间通过相互作用而彼此影响以至联合起来的现象。</p>
<p><strong>解耦合</strong>:指将程序的结构变得松散不是固定的而是可变化的 例如接口的实现类是可以更换的 而直接写的类是顶死的 <strong>解耦就是用数学方法将两种运动分离开来处理问题。</strong>程序的解耦合大概就是让代码和程序不绑定不互相依赖</p>
<p>  依赖：classa中使用classb的属性或者方法， 叫做classa依赖classb</p>
<hr>
<p>框架怎么学： 框架是一个软件，其它人写好的软件。<br> 1）知道框架能做什么， mybatis–访问数据库， 对表中的数据执行增删改查。<br> 2）框架的语法， 框架要完成一个功能，需要一定的步骤支持的，<br> 3）框架的内部实现， 框架内部怎么做。 原理是什么。<br> 4）通过学习，可以实现一个框架。</p>
<h3 id="IOC-反转控制"><a href="#IOC-反转控制" class="headerlink" title="IOC(反转控制)"></a>IOC(反转控制)</h3><p>spring的第一个核心功能 ioc</p>
<p>IoC (Inversion of Control) : 控制反转， 是一个理论，概念，思想。<br> 描述的：把对象的创建，赋值，管理工作都交给代码之外的容器实现， 也就是对象的创建是有其它外部资源完成。</p>
<p>控制： 创建对象，对象的属性赋值，对象之间的关系管理。<br>反转： 把原来的开发人员管理，创建对象的权限转移给代码之外的容器实现。 由容器代替开发人员管理对象。创建对象，<br>        给属性赋值。</p>
<p>正转：由开发人员在代码中，使用new 构造方法创建对象， 开发人员主动管理对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">           <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(); <span class="comment">// 在代码中， 创建对象。--正转。</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>容器：是一个服务器软件， 一个框架（spring）</p>
<p>为什么要使用 ioc ： 目的就是减少对代码的改动， 也能实现不同的功能。 实现解耦合。 </p>
<p>java中创建对象有哪些方式：</p>
<ol>
<li>构造方法 ， new Student（）</li>
<li>反射</li>
<li>序列化</li>
<li>克隆</li>
<li>ioc ：容器创建对象</li>
<li>动态代理</li>
</ol>
<p>ioc的体现：<br>   servlet  1： 创建类继承HttpServelt<br>             2:  在web.xml 注册servlet ， 使用<servlet-name> myservlet </servlet-name><br>                                                 <servelt-class>com.bjpwernode.controller.MyServlet1</servlet-class></p>
<pre><code>3. 没有创建 Servlet对象， 没有 MyServlet myservlet = new MyServlet()

4. Servlet 是Tomcat服务器它能你创建的。 Tomcat也称为容器 Tomcat作为容器：里面存放的有Servlet对象， Listener ， Filter对象
</code></pre>
<p>IoC的技术实现 ，<br>  DI 是ioc的技术实现，<br>  DI（Dependency Injection） :依赖注入， 只需要在程序中提供要使用的对象名称就可以， 至于对象如何在容器中创建，<br>                              赋值，查找都由容器内部实现。</p>
<p>spring是使用的di实现了ioc的功能， spring底层创建对象，使用的是<strong>反射机制</strong>。</p>
<p>spring是一个容器，管理对象，给属性赋值， 底层是反射创建对象。</p>
<p><strong>几种一般注入</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        声明Student对象</span></span><br><span class="line"><span class="comment">        注入:就是赋值的意思</span></span><br><span class="line"><span class="comment">        简单类型</span></span><br><span class="line"><span class="comment">        di:给属性赋值</span></span><br><span class="line"><span class="comment">        1.set注入(设置注入):spring调用类的set方法;你可以再set方法中完成属性赋值&lt;property&gt;(普通赋值 调用类中写好的set方法)</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba01.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span><span class="comment">&lt;!--调用类中的对应的set方法 setName()--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    对引用类型进行set设置注入</span></span><br><span class="line"><span class="comment">    引用类型的set注入:spring调用类的set方法</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba01.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;school&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mySchool&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mySchool&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba02.School&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;成信大&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;四川成都双流区&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        2.构造注入:spring调用类有参构造方法,再创建对象的同时,在构造方法中给属性赋值.</span></span><br><span class="line"><span class="comment">        构造注入使用&lt;constructor-arg&gt;标签</span></span><br><span class="line"><span class="comment">        &lt;constructor-arg&gt;标签:一个&lt;constructor-arg&gt;标签表示构造方法的一个参数</span></span><br><span class="line"><span class="comment">        &lt;constructor-arg&gt;标签属性:</span></span><br><span class="line"><span class="comment">            name:表示构造方法的形参名</span></span><br><span class="line"><span class="comment">            index:表示构造方法的参数的位置.参数从左往右位置是0,1,2</span></span><br><span class="line"><span class="comment">            value:构造方法的形参类型是简单类型,使用value</span></span><br><span class="line"><span class="comment">            ref:构造方法的形参是引用类性,使用ref;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba01.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;school&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mySchool&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--使用index--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent01&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba01.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mySchool&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mySchool&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba02.School&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cuit&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sccd&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--省略index 但要按照0,1,2的顺序--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent02&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba01.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span>  <span class="attr">value</span>=<span class="string">&quot;阿丁&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span>  <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span>  <span class="attr">ref</span>=<span class="string">&quot;mySchool&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>引用类型的自动注入</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        引用类型的自动注入:spring框架根据某些规则可以给引用类型赋值.不用我们自己给引用类型赋值了</span></span><br><span class="line"><span class="comment">        使用的规则常用的是byName,byType</span></span><br><span class="line"><span class="comment">        1.byName(按名称注入):java类中的引用类型的属性名和spring容器中(配置文件)&lt;bean&gt;的id一样</span></span><br><span class="line"><span class="comment">        且数据类型是一致的,这样的容器中的bean,spring能够赋值给引用类型.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--1.ByName--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myStudent&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba03.Student&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;school&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba03.School&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cuit&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sccd&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        ByType:按类型注入: java中引用的数据类型和spring容器中(配置文件)&lt;bean&gt;的class=&quot;&quot;中的</span></span><br><span class="line"><span class="comment">                            类是同源关系,这样的bean能够赋值给引用类型</span></span><br><span class="line"><span class="comment">                            同源就是一类的意思:</span></span><br><span class="line"><span class="comment">                            1.java类中引用类型的数据类型和bean的class的值是一样的</span></span><br><span class="line"><span class="comment">                            2.java类中引用类型的数据类型和bean的class的值是父子关系.</span></span><br><span class="line"><span class="comment">                            3.java类中引用类型的数据类型和bean的class的值是接口和实现类的关系.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        注意bean下是常规的set注入除了引用类型(它是由ByType注入)</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--2.ByType--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;Student01&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba04.Student&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;丁杨维&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mSchool&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Ba04.School&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cuit&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sccd&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>spring-conetxt 和 spring-webmvc是spring中的两个模块</p>
<p>spring-context：是ioc功能的，创建对象的。<br>spring-webmvc做web开发使用的， 是servlet的升级。<br>spring-webmvc中也会用到spring-context中创建对象的功能的。</p>
<p>junit : 单元测试， 一个工具类库，做测试方法使用的。<br>  单元：指定的是方法， 一个类中有很多方法，一个方法称为单元。</p>
<p>  使用单元测试<br>   1.需要加入junit依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>  2.创建测试作用的类：叫做测试类<br>    src&#x2F;test&#x2F;java目录中创建类</p>
<p>  3.创建测试方法</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1）public 方法</span><br><span class="line"> 2）没有返回值 void </span><br><span class="line"> 3）方法名称自定义，建议名称是test + 你要测试方法名称</span><br><span class="line"> 4）方法没有参数</span><br><span class="line"> 5）方法的上面加入 @Test ,这样的方法是可以单独执行的。 不用使用main方法。</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><ol>
<li>多个配置优势<br> 1.每个文件的大小比一个文件要小很多。效率高<br> 2.避免多人竞争带来的冲突。</li>
</ol>
<p>  如果你的项目有多个模块（相关的功能在一起） ，一个模块一个配置文件。<br>  学生考勤模块一个配置文件，  张三<br>  学生成绩一个配置文件，      李四</p>
<p>  多文件的分配方式：</p>
<ol>
<li>按功能模块，一个模块一个配置文件</li>
<li>按类的功能，数据库相关的配置一个文件配置文件， 做事务的功能一个配置文件， 做service功能的一个配置文件等</li>
</ol>
<h3 id="基于注解的DI"><a href="#基于注解的DI" class="headerlink" title="基于注解的DI"></a>基于注解的DI</h3><p>2.基于注解的di： 通过注解完成java对象创建，属性赋值。<br>  使用注解的步骤：<br>   1.加入maven的依赖 spring-context ，在你加入spring-context的同时， 间接加入spring-aop的依赖。<br>      使用注解必须使用spring-aop依赖</p>
<pre><code>2.在类中加入spring的注解（多个不同功能的注解）

3.在spring的配置文件中，加入一个组件扫描器的标签，说明注解在你的项目中的位置
</code></pre>
<p>   学习的注解：<br>     1.@Component </p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> 用于创建对象 等同于bean的功能</span><br><span class="line">value里的值就等同于&lt;bean&gt;中的id</span><br><span class="line">value的值应当是唯一的 创建的对象在整个spring容器中就一个</span><br><span class="line"></span><br><span class="line">位置:定义类的上面</span><br><span class="line"><span class="meta">@Component(value = &quot;myStudent&quot;)</span></span><br><span class="line">如果就只有value一个参数也可省略value</span><br><span class="line"><span class="meta">@Component(&quot;myStudent&quot;)</span>    </span><br><span class="line">也可不写(中的内容)spring提供默认名称(类的名称但首字母小写)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">一般用第二种</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> 声明组件扫描器(component-scan),组件指的就是java对象</span></span><br><span class="line"><span class="comment"> base-package:指定注解在你项目中的包名</span></span><br><span class="line"><span class="comment"> component-scan工作方式:spring会扫描遍历vase-package指定的包</span></span><br><span class="line"><span class="comment">     把包中和子包中的所有类遍历,找到类中的注解,按照注解的功能,按照注解的功能创建对象,或给属性赋值</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在配置文件中添加一个组件扫描器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Ba01&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--组件扫描器指定多个包的三种方式--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--第一种:使用多次组件扫描器,指定不同的包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Ba01&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Ba02&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--第二种:使用分隔符(;或,)分隔多个包名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Ba01;com.dyw.Ba02&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--第三种方式:指定父包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>​    2.@Respotory</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(用在持久层上的):放在dao实现类的上面</span><br><span class="line">表示创建dao对象,dao对象是可以访问数据库的.</span><br><span class="line">用法于@Component一致,但还有额外功能</span><br></pre></td></tr></table></figure>

<p>​     3.@Service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(用在业务层上的):放在service的实现类上面,创建service对象,service对象是做业务处理的,可以有事务功能</span><br><span class="line">用法于@Component一致,但还有额外功能</span><br></pre></td></tr></table></figure>

<p>​     4.@Controller</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(用在控制器上的):放在控制器(处理器)类的上卖弄,创建控制器对象的,</span><br><span class="line">控制器对象,能够接收用户提交的参数,显示请求的处理结果</span><br><span class="line">用法于@Component一致,但还有额外功能</span><br></pre></td></tr></table></figure>

<hr>
<blockquote>
<p>​    <strong>@Respotory(持久层)  @Service(业务层) @Controller(控制层)用于给项目分层</strong></p>
</blockquote>
<p>5.@Value</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@value</span>简单类型的属性赋值</span><br><span class="line">      属性: value 是String类型的,表示简单类型的属性值</span><br><span class="line">      位置:<span class="number">1.</span>在属性定义的上面,无需set方法,推荐使用.</span><br><span class="line">          <span class="number">2.</span>在set方法上面</span><br><span class="line">          </span><br><span class="line">    <span class="meta">@Value(value = &quot;20&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="meta">@Value(value = &quot;丁杨维&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;20&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​     6.@Autowired</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span>应用类型赋值</span><br><span class="line">   <span class="meta">@Autowired</span>:spring框架提供的注解,实现引用类型的赋值.</span><br><span class="line">   spring中通过注解给引用类型赋值,使用的是自动注入原理,支持byName,byType</span><br><span class="line">   <span class="meta">@Atuowired</span>:默认使用的是byType自动注入</span><br><span class="line">    </span><br><span class="line">   <span class="meta">@Autowired</span>默认属性为  require = <span class="literal">true</span> 表示引用类型赋值失败,程序报错,并终止执行</span><br><span class="line">                        require=<span class="literal">false</span>:引用类型如果赋值失败,程序正常执行,引用类型是<span class="literal">null</span>    </span><br><span class="line">       </span><br><span class="line">       位置:<span class="number">1</span>) 在属性定义的上面,无需set方法,推荐使用</span><br><span class="line">            <span class="number">2</span>) 在set方法的上面</span><br><span class="line">           </span><br><span class="line">   如果使用byName方式 需要做的是:</span><br><span class="line">   <span class="number">1.</span>在属性上面加入<span class="meta">@Autowired</span></span><br><span class="line">   <span class="number">2.</span>在属性的上面加入<span class="meta">@Quallifier(value=&quot;bean的id&quot;)</span>:表示使用指定名称的bean完成赋值</span><br><span class="line">   <span class="comment">//byType    </span></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="meta">@Qualifier(value = &quot;school01&quot;)</span></span><br><span class="line">   <span class="keyword">private</span> School school;</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">   <span class="comment">//byName    </span></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="meta">@Qualifier(value = &quot;school01&quot;)</span></span><br><span class="line">   <span class="keyword">private</span> School school;</span><br></pre></td></tr></table></figure>

<p>​     7.@Resource</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">是用之前需要再pom.xml中添加j2ee依赖</span><br><span class="line"><span class="meta">@Resource</span>赋值引用类型: 来自jdk中的注解,spring框架提供了对这个注解的功能的支持,可以使用它给引用类型赋值</span><br><span class="line">     *             使用的也是自动注入原理,支持byName,byType,默认是byName</span><br><span class="line">     * 位置: <span class="number">1</span>)在属性定义的上面,无需set方法,推荐使用</span><br><span class="line">     *       <span class="number">2</span>)在set方法的上面</span><br><span class="line">     *</span><br><span class="line">     * 默认是byName: 先使用byName自动注入,如果byName注入失败,再使用byType</span><br><span class="line">     * 不写(name = <span class="string">&quot;&quot;</span>)是默认属性名 写上就可以指定名称</span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line">    <span class="meta">@Resource(name = &quot;school03&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> School school;</span><br></pre></td></tr></table></figure>

<h4 id="其他注解"><a href="#其他注解" class="headerlink" title="其他注解"></a>其他注解</h4><p><strong>注解可以通过与配置文件结合的方式解耦合</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">name=丁杨维</span><br><span class="line">age=20</span><br><span class="line"><span class="comment">&lt;!--anno.properites--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Ba07&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--将配置文件路劲导入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:anno.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--然后便可再java文件中使用$&#123;&#125;加注解的方式赋值--&gt;</span></span><br><span class="line">public class Student &#123;</span><br><span class="line">    @Value(&quot;$&#123;age&#125;&quot;)</span><br><span class="line">    private int age;</span><br><span class="line">    @Value(&quot;$&#123;name&#125;&quot;)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">但是@Component好像不能使用这个方式赋值 会报错</span><br></pre></td></tr></table></figure>



<p>用户处理请求：<br>   用户form ,参数name ，age—–Servlet(接收请求name，age)—Service类（处理name，age操作）—dao类（访问数据库的）—mysql</p>
<hr>
<h2 id="aop"><a href="#aop" class="headerlink" title="aop"></a><strong>aop</strong></h2><p>1.动态代理<br>  实现方式：jdk动态代理，使用jdk中的Proxy，Method，InvocaitonHanderl创建代理对象。<br>             jdk动态代理要求目标类必须实现接口</p>
<p>  cglib动态代理：第三方的工具库，创建代理对象，原理是继承。 通过继承目标类，创建子类。<br>             子类就是代理对象。 要求目标类不能是final的， 方法也不能是final的</p>
<p>2.动态代理的作用：<br>   1）在目标类源代码不改变的情况下，增加功能。<br>    2）减少代码的重复<br>    3）专注业务逻辑代码<br>    4）解耦合，让你的业务功能和日志，事务非业务功能分离。</p>
<p>3.Aop:面向切面编程， 基于动态代理的，可以使用jdk，cglib两种代理方式。<br>  Aop就是动态代理的规范化， 把动态代理的实现步骤，方式都定义好了，<br>  让开发人员用一种统一的方式，使用动态代理。</p>
<ol start="4">
<li>AOP（Aspect Orient Programming）面向切面编程<br> Aspect: 切面，给你的目标类增加的功能，就是切面。 像上面用的日志，事务都是切面。<br>   切面的特点： 一般都是非业务方法，独立使用的。<br> Orient：面向， 对着。<br> Programming：编程</li>
</ol>
<p>  oop: 面向对象编程</p>
<p>  怎么理解面向切面编程 ？<br>   1）需要在分析项目功能时，找出切面。<br>    2）合理的安排切面的执行时间（在目标方法前， 还是目标方法后）<br>    3）合理的安全切面执行的位置，在哪个类，哪个方法增加增强功能</p>
<p>  术语：<br>   1）Aspect:切面，表示增强的功能， 就是一堆代码，完成某个一个功能。非业务功能，<br>              常见的切面功能有日志， 事务， 统计信息， 参数检查， 权限验证。</p>
<p>   2）JoinPoint:连接点 ，连接业务方法和切面的位置。 就某类中的业务方法,一个类中的每一个方法都是连接点<br>    3）Pointcut : 切入点 ，对连接点的筛选,筛选出需要增强功能的方法<br>    4）目标对象： 给哪个类的方法增加功能， 这个类就是目标对象<br>    5）Advice:通知，通知表示切面功能执行的时间。</p>
<pre><code>说一个切面有三个关键的要素：
1）切面的功能代码，切面干什么
2）切面的执行位置，使用Pointcut表示切面执行的位置
3）切面的执行时间，使用Advice表示时间，在目标方法之前，还是目标方法之后。
</code></pre>
<p> 5.aop的实现<br>   aop是一个规范，是动态的一个规范化，一个标准<br>    aop的技术实现框架：<br>    1.spring：spring在内部实现了aop规范，能做aop的工作。<br>              spring主要在事务处理时使用aop。<br>                 我们项目开发中很少使用spring的aop实现。 因为spring的aop比较笨重。</p>
<p>   2.aspectJ: 一个开源的专门做aop的框架。spring框架中集成了aspectj框架，通过spring就能使用aspectj的功能。<br>      aspectJ框架实现aop有两种方式：<br>       1.使用xml的配置文件 ： 配置全局事务<br>        2.使用注解，我们在项目中要做aop功能，一般都使用注解， aspectj有5个注解。</p>
<p> 6.学习aspectj框架的使用。<br>   1）切面的执行时间， 这个执行时间在规范中叫做Advice(通知，增强)<br>       在aspectj框架中使用注解表示的。也可以使用xml配置文件中的标签</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span>:是aspectj框架中的注解</span><br><span class="line">      作用:表示当前类是切面类</span><br><span class="line">      切面类:是用来给业务方法增加功能的类,在这个类中有切面的功能代码</span><br><span class="line">      位置:在类定义的上面</span><br><span class="line">切面类中的方法:</span><br><span class="line">定义方法:实现切面功能的</span><br><span class="line">	 方法的定义要求:</span><br><span class="line">      <span class="number">1.</span>公共方法 <span class="keyword">public</span></span><br><span class="line">      <span class="number">2.</span>方法没有返回值</span><br><span class="line">      <span class="number">3.</span>方法的名称自定义</span><br><span class="line">      <span class="number">4.</span>方法可以有参数,也可以没有参数</span><br><span class="line">           如果有参数,参数不是自定义的,有几个参数类型可以使用</span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">     指定通知方法中的参数:JoinPoint</span><br><span class="line">     * JoinPoint:业务方法,要加入切面功能的业务方法</span><br><span class="line">     *      作用是:可以在通知方法中获取方法执行的信息,例如方法的名称,方法的实参.</span><br><span class="line">     *      如果你的切面功能中需要用到方法的信息,就加入JoinPoint.</span><br><span class="line">     *      这个JoinPoint参数的值是由框架赋予的,必须是第一个位置的参数,否装上述功能都没有 程序还会报错</span><br></pre></td></tr></table></figure>

<p>​        1）@Before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span>:表示前置通知</span><br><span class="line">     *      属性:value,是切入点表达式,表示切面的功能执行的位置.</span><br><span class="line">     *      位置:在方法的上面</span><br><span class="line">     *特点:  <span class="number">1.</span>在目标方法之前先执行</span><br><span class="line">     *       <span class="number">2.</span>不会改变目标方法的执行结果</span><br><span class="line">     *       <span class="number">3.</span>不会影响目标方法的执行.</span><br><span class="line">     *      execution(<span class="keyword">public</span> <span class="keyword">void</span> com.dyw.ba01.SomeServiceImpl.doSome(String,Integer)表示切入的位置</span><br></pre></td></tr></table></figure>

<p>​        2）@AfterReturning</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 后置通知定义方法,方法是实现切面功能的.</span><br><span class="line">     * 方法定义要求</span><br><span class="line">     * <span class="number">1.</span>公共方法<span class="keyword">public</span></span><br><span class="line">     * <span class="number">2.</span>方法没有返回值</span><br><span class="line">     * <span class="number">3.</span>方法名称自定义</span><br><span class="line">     * <span class="number">4.</span>方法有参数的,推荐Object,参数名自定义</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line"><span class="meta">@AfterReturning</span>:后置通知</span><br><span class="line">     *      属性:<span class="number">1.</span>value 切入点表达式</span><br><span class="line">     *          <span class="number">2.</span>returning 自定义变量,表示方法的返回值的.</span><br><span class="line">     *          自定义变量名必须和通知方法的形参一样</span><br><span class="line">     *  .    位置:在方法定义的上面</span><br><span class="line">     * 特点:</span><br><span class="line">     * <span class="number">1</span>在目标方法之后生效</span><br><span class="line">     * <span class="number">2.</span>能够获取到目标方法的返回值,可以根据这个返回值做不同的处理功能</span><br><span class="line">     * <span class="number">3.</span>可以修改返回值</span><br><span class="line">     *</span><br><span class="line">     *</span><br><span class="line">     * 后置通知的执行</span><br><span class="line">     *      <span class="type">Object</span> <span class="variable">res</span> <span class="operator">=</span> doOther();</span><br><span class="line">     *      myAfterReturning(res);</span><br><span class="line">     *      System.out.println(res);     </span><br></pre></td></tr></table></figure>

<p>​        3）@Around</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> * 环绕通知方法的定义格式</span><br><span class="line"> * <span class="number">1.</span><span class="keyword">public</span></span><br><span class="line"> * <span class="number">2.</span>必须要有一个返回值,推荐使用Object</span><br><span class="line"> * <span class="number">3.</span>方法名称自定义</span><br><span class="line"> * <span class="number">4.</span>方法有参数,固定的参数ProceedingJoinPoint</span><br><span class="line"></span><br><span class="line"><span class="meta">@Around</span>: 环绕通知</span><br><span class="line">    属性:value 切入点表达式</span><br><span class="line">    位置:在方法的定义上面</span><br><span class="line">特点:</span><br><span class="line"> <span class="number">1.</span>他是功能最强的通知</span><br><span class="line"> <span class="number">2.</span>在目标方法的前和后都能被调用执行</span><br><span class="line"> <span class="number">3.</span>控制目标方法是否被调用执行</span><br><span class="line"> <span class="number">4.</span>修改原来的目标方法的执行结果.影响最后调用的结果</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 环绕通知.等同于jdk动态代理的InvocationHandler接口</span><br><span class="line"></span><br><span class="line"> 参数: ProceedingJoinPoint就等同于jdk动态代理的Method</span><br><span class="line">     作用:执行目标方法的</span><br><span class="line"> 返回值:就是目标方法的执行结果,可以被修改</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ProceedingJoinPoint是继承了JoinPoint 所以它具有JoinPoint的特性</span><br><span class="line"></span><br><span class="line"> 环绕通知:经常做事务,在目标方法之前开启事务,执行目标方法,在目标方法之后提交事务</span><br><span class="line"><span class="meta">@param</span> proceedingJoinPoint</span><br><span class="line"><span class="meta">@return</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​        4）@AfterThrowing <strong>异常通知</strong><br>​        5）@After <strong>后置通知</strong></p>
<p><strong>@Pointcut用于指定切入点的别名</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(value = &quot;myPointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">myBefore01</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Pointcut</span>:定义和管理切入点,如果你的项目中有多个切入点表达式是重复的,可以复用.</span></span><br><span class="line"><span class="comment">     *              可以使用<span class="doctag">@Pointcut</span></span></span><br><span class="line"><span class="comment">     *           属性:value 切入点表达式</span></span><br><span class="line"><span class="comment">     *           位置:自定义方法的上面</span></span><br><span class="line"><span class="comment">     *      特点:</span></span><br><span class="line"><span class="comment">     *          当使用<span class="doctag">@Pointcut</span>定义在一个方法的上面,此时这方法的名称就是切入点表达式的别名.</span></span><br><span class="line"><span class="comment">     *          当其他的通知中,value属性就可以使用这个方法的名称,代替切入点表达式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(value = &quot;execution(* *..SomeService.doSome(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">myPointcut</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//无需代码 只是用该方法名代替切入点表达式</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>   2）表示切面执行的位置，使用的是切入点表达式。</p>
<pre><code>    com.service.impl
    com.bjpowrnode.service.impl
    cn.crm.bjpowernode.service


  execution(* *..service.*.*(..))
</code></pre>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">											readme</span></span><br><span class="line"><span class="code">									用aspectj框架实现aop</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"></span><br><span class="line">使用aop的目的是给已经存在的一些了业务方法,增加额外的功能,前提是不会更改原来类中的方法</span><br><span class="line"></span><br><span class="line"><span class="section">###使用aspectj实现aop的基本步骤</span></span><br><span class="line"><span class="section">####1.新建maven项目</span></span><br><span class="line"><span class="section">####2.加入依赖</span></span><br><span class="line"><span class="bullet"> 1.</span> spring依赖</span><br><span class="line"><span class="bullet"> 2.</span> aspectj依赖</span><br><span class="line"><span class="bullet"> 3.</span> junit单元测试</span><br><span class="line"><span class="section">####3.创建目标类:接口和他的实现类</span></span><br><span class="line"></span><br><span class="line"><span class="section">####4.创建切面类:普通类</span></span><br><span class="line"><span class="bullet"> 1.</span> 在类上面加入注解@Aspect</span><br><span class="line"><span class="bullet"> 2.</span> 在类中定义方法,方法就是切面要执行的功能代码</span><br><span class="line"><span class="code">    在方法上面加入aspectj中的通知注解,例如@Before</span></span><br><span class="line"><span class="code">    有需要指定切入点表达式execution()</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">####5.创建spring配置文件:声明对象,把对象交给容器去统一管理声明对象你可以使用注解或xml配置文件&lt;bean&gt;</span></span><br><span class="line"><span class="code">1. 声明目标对象</span></span><br><span class="line"><span class="code">2. 声明切面类对象</span></span><br><span class="line"><span class="code">3. 声明aspectj框架中的自动代理生成器标签.</span></span><br><span class="line"><span class="code">    自动代理生成器:用来完成代理对象的自动创建功能的.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section">####6.创建测试类,从spring容器中获取目标对象(实际就是代理对象).通过代理执行方法,实现aop的功能</span></span><br></pre></td></tr></table></figure>



<hr>
<h3 id="mybatis框架和spring集成"><a href="#mybatis框架和spring集成" class="headerlink" title="mybatis框架和spring集成"></a>mybatis框架和spring集成</h3><p>第四章： 把mybatis框架和spring集成在一起，像一个框架一样使用。</p>
<p>用的技术是：ioc 。<br>为什么ioc：能把mybatis和spring集成在一起，像一个框架， 是因为ioc能创建对象。<br> 可以把mybatis框架中的对象交给spring统一创建， 开发人员从spring中获取对象。<br> 开发人员就不用同时面对两个或多个框架了， 就面对一个spring</p>
<p>mybatis使用步骤，对象<br>1.定义dao接口 ，StudentDao<br>2.定义mapper文件 StudentDao.xml<br>3.定义mybatis的主配置文件 mybatis.xml<br>4.创建dao的代理对象， StudentDao dao &#x3D; SqlSession.getMapper(StudentDao.class);</p>
<p>   List<Student> students  &#x3D; dao.selectStudents();</p>
<p>要使用dao对象，需要使用getMapper()方法，<br>怎么能使用getMapper()方法，需要哪些条件<br>1.获取SqlSession对象， 需要使用SqlSessionFactory的openSession()方法。<br>2.创建SqlSessionFactory对象。 通过读取mybatis的主配置文件，能创建SqlSessionFactory对象</p>
<p>需要SqlSessionFactory对象， 使用Factory能获取SqlSession ，有了SqlSession就能有dao ， 目的就是获取dao对象<br>Factory创建需要读取主配置文件</p>
<p>我们会使用独立的连接池类替换mybatis默认自己带的， 把连接池类也交给spring创建。</p>
<p>主配置文件：<br> 1.数据库信息<br> <environment id="mydev"><br>            <transactionManager type="JDBC"/><br>            <dataSource type="POOLED"><br>                <!--数据库的驱动类名--><br>                <property name="driver" value="com.mysql.jdbc.Driver"/><br>                <!--连接数据库的url字符串--><br>                <property name="url" value="jdbc:mysql://localhost:3306/springdb"/><br>                <!--访问数据库的用户名--><br>                <property name="username" value="root"/><br>                <!--密码--><br>                <property name="password" value="123456"/><br>            </dataSource></p>
<ol start="2">
<li>mapper文件的位置<mappers>
     <mapper resource="com/bjpowernode/dao/StudentDao.xml"/>
     <!--<mapper resource="com/bjpowernode/dao/SchoolDao.xml" />-->
 </mappers></li>
</ol>
<hr>
<p>通过以上的说明，我们需要让spring创建以下对象<br>1.独立的连接池类的对象， 使用阿里的druid连接池 一般我么只需要配置url,user,password,maxActive(最大连接数);</p>
<p>2.SqlSessionFactory对象</p>
<p>3.创建出dao对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--DruidDataSource大部分属性都是参考DBCP的，如果你原来就是使用DBCP，迁移是十分方便的。--&gt;</span></span><br><span class="line">init-method 这里xml配置文件指定init是为了druid连接池启动时自动执行 destroy-method也是指销毁数据库连接池会制动执行close</span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc_url&#125;&quot;</span> /&gt;</span><span class="comment">&lt;!--可以使用properties文件指定jdbc的url等内容 然后加载 最后使用注解来解耦合或是隐藏敏感信息--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc_user&#125;&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc_password&#125;&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;filters&quot;</span> <span class="attr">value</span>=<span class="string">&quot;stat&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxActive&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxWait&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6000&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;timeBetweenEvictionRunsMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;60000&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minEvictableIdleTimeMillis&quot;</span> <span class="attr">value</span>=<span class="string">&quot;300000&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;testWhileIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;testOnBorrow&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;testOnReturn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;poolPreparedStatements&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxOpenPreparedStatements&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;asyncInit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--在上面的配置中，通常你需要配置url、username、password，maxActive这三项。</span></span><br><span class="line"><span class="comment">Druid会自动跟url识别驱动类名，如果连接的数据库非常见数据库，配置属性driverClassName</span></span><br><span class="line"><span class="comment">asyncInit是1.1.4中新增加的配置，如果有initialSize数量较多时，打开会加快应用启动时间--&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">                                            mybatis.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置日志--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--设置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--实体类所在的包名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.dyw.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--name:是包名,是这个包中所有的mapper.xml一次都能加载--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.dyw.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">								applicationContext.xml</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">	 0.使用了properties文件 加载</span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    1.声明数据源 这里用到了上面的druid数据库的spring<span class="tag">&lt;<span class="name">bean</span>&gt;</span>配置</span><br><span class="line">    <span class="comment">&lt;!--声明数据源DataSource ,作用是使用数据库的 这里声明的是DruidDataSource--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.root&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxActive&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    2.声明SqlSessionFactoryBean(spring-mybatis集成中的类 通过这个工厂类可以创建SqlSessionFactory对象)</span><br><span class="line">    主要是指定数据源 因为mybatis.xml中我们是没有指定的 并且需要将mybatis.xml加载 将配置信息导入里面指定的mapper文件和domian类</span><br><span class="line">    <span class="comment">&lt;!--声明的是mybatis中提供的SqlSessionFactoryBean类,这个类内部创建SqlSessionFactory对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--set注入,把数据库的值付给了dataSource属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis主配置文件的位置</span></span><br><span class="line"><span class="comment">            configLocation属性是Resource类型,读取配置文件</span></span><br><span class="line"><span class="comment">            他的赋值,使用value,指定文件的路径,使用classpath:表示文件的位置</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    3.获取了SqlSessionFactory对象后 需要通过他生成的sqlSession对象 再调用getMapper(Dao.class)方法获取到dao接口的代理对象 让其放入到spring容器中管理</span><br><span class="line">    <span class="comment">&lt;!--创建dao对象,使用sqlSession的getMapper(StudentDao.class)</span></span><br><span class="line"><span class="comment">            MapperScannerConfigurer:在内部调用getMapper()生成每个dao接口的代理对象.</span></span><br><span class="line"><span class="comment">            不用指定id</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定SqlSessionFactory对象的id--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            指定包名,包名是dao接口所在的包名.</span></span><br><span class="line"><span class="comment">            MapperScannerConfigurer会扫描这个包中的所有接口,把每个接口都执行一次getMapper方法,得到每个接口的dao对象.			</span></span><br><span class="line"><span class="comment">            创建好了的dao对象放入到spring的容器中的. 创建好的dao对象的名称时接口的首字母小写</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--简单复习 如果赋值时对象内的属性为简单类型 是使用value赋值 如果时引用对象则是ref--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--之所以扫描dao接口的包 是为了获得dao.class调用getMapper(Dao.class)方法创建dao接口的代理对象--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.dyw.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    4.创建业务类(有业务方法)的对象</span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;studentService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.service.studentServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;studentDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>需要学习就是上面三个对象的创建语法，使用xml的bean标签。</p>
<p>连接池：多个连接Connection对象的集合， List<Connection>  connlist : connList就是连接池</p>
<p>通常使用Connection访问数据库<br>Connection conn &#x3D;DriverManger.getConnection(url,username,password);<br>Statemenet stmt &#x3D; conn.createStatement(sql);<br>stmt.executeQuery();<br>conn.close();</p>
<p>使用连接池<br>在程序启动的时候，先创建一些Connection<br>Connection c1 &#x3D; …<br>Connection c2 &#x3D; …<br>Connection c3 &#x3D; …<br>List<Connection>  connlist &#x3D; new ArrayLits();<br>connList.add(c1);<br>connList.add(c2);<br>connList.add(c3);</p>
<p>Connection conn &#x3D; connList.get(0);<br>Statemenet stmt &#x3D; conn.createStatement(sql);<br>stmt.executeQuery();<br>把使用过的connection放回到连接池<br>connList.add(conn);</p>
<p>Connection conn1 &#x3D; connList.get(1);<br>Statemenet stmt &#x3D; conn1.createStatement(sql);<br>stmt.executeQuery();<br>把使用过的connection放回到连接池<br>connList.add(conn1);</p>
<hr>
<h2 id="spring的事务处理"><a href="#spring的事务处理" class="headerlink" title="spring的事务处理"></a>spring的事务处理</h2><h3 id="事务的基本要素-4大性质"><a href="#事务的基本要素-4大性质" class="headerlink" title="事务的基本要素 4大性质"></a><strong>事务的基本要素 4大性质</strong></h3><blockquote>
<ol>
<li>原子性:事务开始后的所有操作,要么全部成功,要么全部失败回滚,不可能停滞在中间环节.事务执行过程中出错,会回滚到事务开始之前的状态,所有操作就像没有发生一样.也就是说事务是一个不可分割的整体,就像化学中学过的原子,是事务构成的基本单位.</li>
<li>一致性:事务开始前和结束后,数据库的完整性约束没有被破坏,如A向B转张,不可能出现A扣了钱而B却没有加的情况</li>
<li>隔离性:同一时间,只允许一个事务请求同一数据,不同事务之间彼此没有任何干扰,如A正在从一张银行卡中取钱,在A取钱的过程结束前,B不能向这张卡转账.</li>
<li>持久性:事务完成之后,事务对数据库更新将会被保存写在数据库上,不能回滚.</li>
</ol>
</blockquote>
<p>回答问题<br>1.什么是事务<br>  讲mysql的时候，提出了事务。 事务是指一组sql语句的集合， 集合中有多条sql语句<br>  可能是insert ， update ，select ，delete， 我们希望这些多个sql语句都能成功，<br>  或者都失败， 这些sql语句的执行是一致的，作为一个整体执行。</p>
<p>2.在什么时候想到使用事务<br>  当我的操作，涉及得到多个表，或者是多个sql语句的insert，update，delete。需要保证<br>  这些语句都是成功才能完成我的功能，或者都失败，保证操作是符合要求的。</p>
<p>  在java代码中写程序，控制事务，此时事务应该放在那里呢？<br>     service类的业务方法上，因为业务方法会调用多个dao方法，执行多个sql语句</p>
<p>3.通常使用JDBC访问数据库， 还是mybatis访问数据库怎么处理事务<br>   jdbc访问数据库，处理事务  Connection conn ; conn.commit(); conn.rollback();<br>    mybatis访问数据库，处理事务， SqlSession.commit();  SqlSession.rollback();<br>    hibernate访问数据库，处理事务， Session.commit(); Session.rollback();</p>
<p>4.3问题中事务的处理方式，有什么不足<br>  1)不同的数据库访问技术，处理事务的对象，方法不同，<br>    需要了解不同数据库访问技术使用事务的原理<br>  2)掌握多种数据库中事务的处理逻辑。什么时候提交事务，什么时候回顾事务<br>  3)处理事务的多种方法。</p>
<p>  总结： 就是多种数据库的访问技术，有不同的事务处理的机制，对象，方法。</p>
<p>5.怎么解决不足<br>  spring提供一种处理事务的统一模型， 能使用统一步骤，方式完成多种不同数据库访问技术的事务处理。</p>
<p>  使用spring的事务处理机制，可以完成mybatis访问数据库的事务处理<br>  使用spring的事务处理机制，可以完成hibernate访问数据库的事务处理。</p>
<h3 id="spring事务的属性"><a href="#spring事务的属性" class="headerlink" title="spring事务的属性"></a><strong>spring事务的属性</strong></h3><p>Spring事务属性对应TransactionDefinition类里面的各个方法。TransactionDefinition类方法如下所示:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TransactionDefinition</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回事务传播行为</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getPropagationBehavior</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回事务的隔离级别，事务管理器根据它来控制另外一个事务可以看到本事务内的哪些数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getIsolationLevel</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务超时时间，事务必须在多少秒之内完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getTimeout</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务是否只读，事务管理器能够根据这个返回值进行优化，确保事务是只读的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isReadOnly</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务名字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    String <span class="title function_">getName</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>事务属性可以理解成事务的一些基本配置，描述了事务策略如何应用到方法上。事务属性包含了5个方面：传播行为、隔离规则、回滚规则、事务超时、是否只读。</strong></p>
<p>6.处理事务，需要怎么做，做什么<br>  spring处理事务的模型，使用的步骤都是固定的。把事务使用的信息提供给spring就可以了</p>
<p>  1）事务内部提交，回滚事务，使用的事务管理器对象，代替你完成commit，rollback<br>     事务管理器是一个接口和他的众多实现类。<br>      接口：PlatformTransactionManager ，定义了事务重要方法 commit ，rollback<br>      实现类：spring把每一种数据库访问技术对应的事务处理类都创建好了。<br>               mybatis访问数据库—spring创建好的是DataSourceTransactionManager<br>                  hibernate访问数据库—-spring创建的是HibernateTransactionManager</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">怎么使用：你需要告诉spring 你用是那种数据库的访问技术，怎么告诉spring呢？</span><br><span class="line"> 声明数据库访问技术对于的事务管理器实现类， 在spring的配置文件中使用<span class="tag">&lt;<span class="name">bean</span>&gt;</span>声明就可以了</span><br><span class="line"> 例如，你要使用mybatis访问数据库，你应该在xml配置文件中</span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">“xxx</span>&quot; <span class="attr">class</span>=<span class="string">&quot;...DataSourceTransactionManager&quot;</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h4 id="Spring事务的隔离级别"><a href="#Spring事务的隔离级别" class="headerlink" title="Spring事务的隔离级别"></a>Spring事务的隔离级别</h4><p>你的业务方法需要什么样的事务，说明需要事务的类型。<br>     说明方法需要的事务：<br>        1）事务的隔离级别：有4个值。<br>        ➢<strong>DEFAULT：采用 DB 默认的事务隔离级别。</strong>MySql 的默认为 REPEATABLE_READ； Oracle默认为 READ_COMMITTED。<br>        ➢ <strong>READ_UNCOMMITTED</strong>：<strong>读未提交</strong>(A事务在执行过程中,读到了B事务修改但未提交的数据,可能会发生B事务未修改回滚但被A事务读取到的情况,出现了<strong>脏读</strong>)。未解决任何并发问题。<br>        ➢ <strong>READ_COMMITTED：读已提交</strong>。解决脏读，存在不可重复读与幻读。<br>        ➢ <strong>REPEATABLE_READ：可重复读</strong>。解决脏读、不可重复读，存在幻读<br>        ➢ <strong>SERIALIZABLE：串行化</strong>(事务A执行完毕后才执行B事务)。不存在并发问题。</p>
<blockquote>
<p> <strong>ISOLATION_SERIALIZABLE(串行化)</strong> 隔离规则类型在开发中很少用到。举个很简单的例子。咱们使用了ISOLATION_SERIALIZABLE规则。A,B两个事务操作同一个数据表并发过来了。A先执行。A事务这个时候会把表给锁住，B事务执行的时候直接报错。</p>
<ol>
<li><p>事务隔离级别为**ISOLATION_READ_UNCOMMITTED(读未提交)**时，写数据只会锁住相应的行。</p>
</li>
<li><p>事务隔离级别为可**ISOLATION_REPEATABLE_READ(可重复读)**时，如果检索条件有索引(包括主键索引)的时候，默认加锁方式是next-key锁；如果检索条件没有索引，更新数据时会锁住整张表。一个间隙被事务加了锁，其他事务是不能在这个间隙插入记录的，这样可以防止幻读。</p>
</li>
<li><p>事务隔离级别为**ISOLATION_SERIALIZABLE(串行化)**时，读写数据都会锁住整张表。</p>
</li>
<li><p>隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能(隔离级别越高 执行的时间越长)的影响也就越大。</p>
</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">2</span>) 事务的超时时间： 表示一个方法最长的执行时间，如果方法执行时超过了时间，事务就回滚。</span><br><span class="line">	  单位是秒， 整数值， 默认是 -<span class="number">1.</span> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   为了使应用程序很好地运行，事务不能运行太长的时间。因为事务可能涉及对后端数据库的锁定，也会占用数据库资源。事务超时就是事务的一个定时器，在特定时间内事务如果没有执行完毕，那么就会自动回滚，而不是一直等待其结束。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">  <span class="number">3</span>) 事务是否只读:isReadOnly() : <span class="type">boolean</span> <span class="title function_">isReadOnlu</span><span class="params">()</span> <span class="literal">true</span>表示是只读,<span class="literal">false</span>表示非只读</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	如果在一个事务中所有关于数据库的操作都是只读的，也就是说，这些操作只读取数据库中的数据，而并不更新数据,　这个时候我们应该给该事务设置只读属性，这样可以帮助数据库引擎优化事务。提升效率。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>事务的传播行为:</strong> 控制业务方法是不是有事务的， 是什么样的事务的。<br>    7个传播行为，表示你的业务方法调用时，事务在方法之间是如果使用的.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/**当前事务传播行为是REQUIRED时,如果存在一个事务那么直接使用当前事务,如果没有事务,那么就创建一个事务,如:单独MethodB时上下文没有事务,执行时会创建一个新的事务;如果MethodA方法中上下文存在事务,在A中调用B时B会发现上下文中存在事务,MethodB就不会创建一个新的事务,而是直接加入到A的事务中*/</span></span><br><span class="line">	PROPAGATION_REQUIRED</span><br><span class="line">        </span><br><span class="line">	<span class="comment">/** 需要使用 JtaTransactionManager作为事务管理器。 </span></span><br><span class="line"><span class="comment">上下文没有事务,它会开启一个新的事务。如果一个事务已经存在，则先将这个存在的事务挂起。*/</span></span><br><span class="line">	PROPAGATION_REQUIRES_NEW</span><br><span class="line">        </span><br><span class="line">    <span class="comment">/** 如果存在事务,支持当前事务,如果没有事务,则非事务的执行.但是对于事务同步的事务管理器，PROPAGATION_SUPPORTS与不使用事务有少许不同。 */</span></span><br><span class="line">	PROPAGATION_SUPPORTS</span><br><span class="line">	以上三个需要掌握的</span><br><span class="line">	<span class="comment">/** 如果已经存在一个事务，支持当前事务。如果没有一个活动的事务，则抛出异常。即必须有事务,没有一个事务就抛出异常*/</span></span><br><span class="line">	PROPAGATION_MANDATORY</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** 如果一个活动的事务存在，则运行在一个嵌套的事务中。 如果没有活动事务, 则按TransactionDefinition.PROPAGATION_REQUIRED 属性执行。 */</span>   </span><br><span class="line">	PROPAGATION_NESTED</span><br><span class="line">        </span><br><span class="line">    <span class="comment">/** 总是非事务地执行，如果存在一个活动事务，则抛出异常。*/</span>  </span><br><span class="line">	PROPAGATION_NEVER</span><br><span class="line">        </span><br><span class="line">    <span class="comment">/** 总是非事务地执行，并挂起任何存在的事务。使用PROPAGATION_NOT_SUPPORTED,也需要使用JtaTransactionManager作为事务管理器。 */</span>  </span><br><span class="line">	PROPAGATION_NOT_SUPPORTED  </span><br></pre></td></tr></table></figure>

<p>​    <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39625809/article/details/80707695">PROPAGATION_NESTED 与PROPAGATION_REQUIRES_NEW的区别:</a></p>
<p>​    </p>
<ol start="4">
<li><strong>事务提交事务，回滚事务的时机</strong><br> 1）当你的业务方法，执行成功，没有异常抛出，当方法执行完毕，spring在方法执行后提交事务。事务管理器commit</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">2</span>）(默认情况下)当你的业务方法抛出运行时异常或<span class="title function_">ERROR</span>(即未受查异常)， spring执行回滚，调用事务管理器的rollback</span><br><span class="line">     运行时异常的定义： <span class="title class_">RuntimeException</span>  和他的子类都是运行时异常， 例如<span class="title class_">NullPointException</span> , <span class="title class_">NumberFormatException</span></span><br><span class="line">  </span><br><span class="line">  <span class="number">3</span>) 当你的业务方法抛出非运行时异常， 主要是受查异常时，提交事务</span><br><span class="line">    受查异常：在你写代码中，必须处理的异常。例如<span class="title class_">IOException</span>, <span class="title class_">SQLException</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	注意:你可以声明事务遇到特定的受查异常时像遇到运行时异常那样回滚,同样,你还可以声明事务遇到特定的异常不回滚,即使这些异常是运行时异常.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>总结spring的事务<br>  1.管理事务的是 事务管理和他的实现类<br>  2.spring的事务是一个统一模型<br>     1）指定要使用的事务管理器实现类，使用<bean></bean>spring容器创建管理对象<br>      2）指定哪些类，哪些方法需要加入事务的功能<br>      3）指定方法需要的隔离级别，传播行为，超时</p>
<pre><code>  你需要告诉spring，你的项目中类信息，方法的名称，方法的事务传播行为。
</code></pre>
<p>spring框架中提供的事务处理方案<br>1.适合中小项目使用的， 注解方案。<br>  spring框架自己用<strong>aop</strong>(aspectj框架的 @Around 环绕依赖)实现给业务方法增加事务的功能， 使用**@Transactional注解**增加事务。<br>  @Transactional注解是spring框架自己注解，放在public方法的上面，表示当前方法具有事务。<br>  可以给注解的属性赋值，表示具体的隔离级别，传播行为，异常信息等等</p>
<p>  使用@Transactional的步骤：<br>  1.需要声明事务管理器对象<br>    <bean id="xx" class="DataSourceTransactionManager"></p>
<hr>
<h3 id="Transactional注解"><a href="#Transactional注解" class="headerlink" title="@Transactional注解"></a><strong>@Transactional注解</strong></h3><h4 id="1-Transactional介绍"><a href="#1-Transactional介绍" class="headerlink" title="1. @Transactional介绍"></a>1. @Transactional介绍</h4><ol>
<li>@Transactional注解 <strong>可以作用于接口、接口方法、类以及类方法上。</strong>当作用于类上时，该类的所有 <strong>public 方法</strong>将都具有该类型的事务属性，同时，<strong>我们也可以在方法级别使用该标注来<em>覆盖</em>类级别的定义。</strong></li>
<li>虽然@Transactional 注解可以作用于接口、接口方法、类以及类方法上，但是 Spring 建议不要在接口或者接口方法上使用该注解，因为这只有在使用基于接口的代理时它才会生效。另外， @Transactional注解应该<strong>只被应用到 public 方法上</strong>，这是由<strong>Spring AOP的本质决定的</strong>。如果你在 <strong>protected、private 或者默认可见性</strong>的方法上使用 @Transactional 注解，<strong>这将被忽略，也不会抛出任何异常。</strong></li>
<li><strong>默认情况下，只有来自外部的方法调用才会被AOP代理捕获</strong>，也就是，类内部方法调用本类内部的其他方法并不会引起事务行为，即使被调用方法使用@Transactional注解进行修饰。</li>
</ol>
<h4 id="2-Transactional注解属性"><a href="#2-Transactional注解属性" class="headerlink" title="2. @Transactional注解属性"></a>2. @Transactional注解属性</h4><ol>
<li>@Transactional注解里面的各个属性和咱们在上面讲的事务属性里面是一一对应的。用来设置<strong>事务的传播行为、隔离规则、回滚规则、事务超时、是否只读</strong>。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Transactional &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当在配置文件中有多个 TransactionManager , 可以用该属性指定选择哪个事务管理器。myBatis是DataSourceTransactionManager 事务管理器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AliasFor(&quot;transactionManager&quot;)</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 同上。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AliasFor(&quot;value&quot;)</span></span><br><span class="line">    String <span class="title function_">transactionManager</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务的传播行为，默认值为 REQUIRED。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Propagation <span class="title function_">propagation</span><span class="params">()</span> <span class="keyword">default</span> Propagation.REQUIRED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务的隔离规则，默认值采用 DEFAULT mysql中是可重复读。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Isolation <span class="title function_">isolation</span><span class="params">()</span> <span class="keyword">default</span> Isolation.DEFAULT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务超时时间。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">timeout</span><span class="params">()</span> <span class="keyword">default</span> TransactionDefinition.TIMEOUT_DEFAULT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否只读事务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">readOnly</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用于指定能够触发事务回滚的异常类型 Class对象的数组。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Throwable</span>&gt;[] rollbackFor() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 同上，指定类名 这个String类型的数组。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] rollbackForClassName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用于指定不会触发事务回滚的异常类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Throwable</span>&gt;[] noRollbackFor() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 同上，指定类名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] noRollbackForClassName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>value、transactionManager属性</li>
</ol>
<p>​    它们两个是一样的意思。当配置了多个事务管理器时，可以使用该属性指定选择哪个事务管理器。大多数项目只需要一个事务管理器。然而，有些项目为了提高效率、或者有多个完全不同又不相干的数据源，从而使用了多个事务管理器。机智的Spring的Transactional管理已经考虑到了这一点，首先定义多个transactional manager，并为qualifier属性指定不同的值；然后在需要使用@Transactional注解的时候指定TransactionManager的qualifier属性值或者直接使用bean名称。配置和代码使用的例子：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">qualifier</span> <span class="attr">value</span>=<span class="string">&quot;datasource1Tx&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">qualifier</span> <span class="attr">value</span>=<span class="string">&quot;datasource2Tx&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionalService</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Transactional(&quot;datasource1Tx&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSomethingInDatasource1</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Transactional(&quot;datasource2Tx&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomethingInDatasource2</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p><strong>propagation属性</strong></p>
<p>propagation用于指定事务的传播行为，默认值为 REQUIRED。propagation有七种类型，就是我们在上文中讲到的事务属性传播行为的七种方式，如下所示:</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>propagation属性</th>
<th>事务属性-传播行为</th>
<th>含义</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>REQUIRED</td>
<td>TransactionDefinition.PROPAGATION_REQUIRED</td>
<td>如果当前没有事务，就新建一个事务，如果已经存在一个事务，则加入到这个事务中。这是最常见的选择。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>SUPPORTS</td>
<td>TransactionDefinition.PROPAGATION_SUPPORTS</td>
<td>支持当前事务，如果当前没有事务，就以非事务方式执行。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>MANDATORY</td>
<td>TransactionDefinition.PROPAGATION_MANDATORY</td>
<td>表示该方法必须在事务中运行，如果当前事务不存在，则会抛出一个异常。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>REQUIRES_NEW</td>
<td>TransactionDefinition.PROPAGATION_REQUIRES_NEW</td>
<td>表示当前方法必须运行在它自己的事务中。一个新的事务将被启动。如果存在当前事务，在该方法执行期间，当前事务会被挂起。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>NOT_SUPPORTED</td>
<td>TransactionDefinition.PROPAGATION_NOT_SUPPORTED</td>
<td>表示该方法不应该运行在事务中。如果当前存在事务，就把当前事务挂起。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>NEVER</td>
<td>TransactionDefinition.PROPAGATION_NEVER</td>
<td>表示当前方法不应该运行在事务上下文中。如果当前正有一个事务在运行，则会抛出异常。</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>NESTED</td>
<td>TransactionDefinition.PROPAGATION_NESTED</td>
<td>如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与PROPAGATION_REQUIRED类似的操作。</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol start="4">
<li><p><strong>isolation属性</strong></p>
<p>​    isolation用于指定事务的隔离规则，默认值为DEFAULT。@Transactional的隔离规则和上文事务属性里面的隔离规则也是一一对应的。总共五种隔离规则，如下所示:</p>
<table>
<thead>
<tr>
<th>@isolation属性</th>
<th>事务属性-隔离规则</th>
<th>含义</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>DEFAULT</td>
<td>TransactionDefinition.ISOLATION_DEFAULT</td>
<td>使用后端数据库默认的隔离级别</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>READ_UNCOMMITTED</td>
<td>TransactionDefinition.ISOLATION_READ_UNCOMMITTED</td>
<td>允许读取尚未提交的数据变更(最低的隔离级别)</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>READ_COMMITTED</td>
<td>TransactionDefinition.ISOLATION_READ_COMMITTED</td>
<td>允许读取并发事务已经提交的数据</td>
<td>否</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>REPEATABLE_READ</td>
<td>TransactionDefinition.ISOLATION_REPEATABLE_READ</td>
<td>对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改</td>
<td>否</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>TransactionDefinition.ISOLATION_SERIALIZABLE</td>
<td>最高的隔离级别，完全服从ACID的隔离级别，也是最慢的事务隔离级别，因为它通常是通过完全锁定事务相关的数据库表来实现的</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
</tbody></table>
</li>
</ol>
<hr>
<ol start="5">
<li><p><strong>timeout</strong></p>
<p>​    timeout用于设置事务的超时属性。</p>
</li>
<li><p><strong>readOnly</strong></p>
<p>​    readOnly用于设置事务是否只读属性。</p>
</li>
<li><p><strong>rollbackFor、rollbackForClassName、noRollbackFor、noRollbackForClassName</strong></p>
<p>​    rollbackFor、rollbackForClassName用于设置那些异常需要回滚；noRollbackFor、noRollbackForClassName用于设置那些异常不需要回滚。他们就是在设置事务的回滚规则。</p>
</li>
</ol>
<h4 id="Transactional注解的使用"><a href="#Transactional注解的使用" class="headerlink" title="@Transactional注解的使用"></a><strong>@Transactional注解的使用</strong></h4><ol>
<li>@Transactional注解内部实现依赖于Spring AOP编程。而AOP在默认情况下，只有来自外部的方法调用才会被AOP代理捕获，也就是，类内部方法调用本类内部的其他方法并不会引起事务行为。</li>
<li><strong>@Transactional 注解尽量直接加在方法上</strong>:因为每个方法的执行情况不一样,加载类上的话不能更好地区分每个方法的操作 比如查询只需要readOnly</li>
<li><strong>@Transactional 注解必须添加在public方法上，private、protected方法上是无效的</strong> spring的@Transactional是基于springAOP特性实现</li>
<li><strong>@Transactional注解在外部调用的函数上才有效果，内部调用的函数添加无效，</strong>要切记。这是由AOP的特性决定的。(即在同一个类中只有只有由@Transactional的方法调用另一个方法有效,两个方法都有@Transactional注解只有外部的生效,内部的不生效  <strong>@Transactional注解只有外部调用才有效。</strong>)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(</span></span><br><span class="line"><span class="meta">         propagation = Propagation.REQUIRED,</span></span><br><span class="line"><span class="meta">         isolation = Isolation.DEFAULT,</span></span><br><span class="line"><span class="meta">         readOnly = false,</span></span><br><span class="line"><span class="meta">         rollbackFor = &#123;</span></span><br><span class="line"><span class="meta">                 NullPointerException.class,  NotEnoughException.class</span></span><br><span class="line"><span class="meta">         &#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>  2.开启事务注解驱动， 告诉spring框架，我要使用注解的方式管理事务。<br>    spring使用aop机制，创建@Transactional所在的类代理对象，给方法加入事务的功能。<br>    spring给业务方法加入事务：<br>        在你的业务方法执行之前，先开启事务，在业务方法之后提交或回滚事务，使用aop的环绕通知</p>
<pre><code>     @Around(&quot;你要增加的事务功能的业务方法名称&quot;)
     Object myAround()&#123;
       开启事务，spring给你开启
          try&#123;
             buy(1001,10);
              spring的事务管理器.commit();
          &#125;catch(Exception e)&#123;
         spring的事务管理器.rollback();
          &#125;
         
     &#125;
</code></pre>
<p>3.在你的方法的上面加入@Trancational 在注解中配置参数</p>
<p>2.适合大型项目，有很多的类，方法，需要大量的配置事务，使用aspectj框架功能，在spring配置文件中<br>  声明类，方法需要的事务。这种方式业务方法和事务配置完全分离。</p>
<p>  实现步骤： 都是在xml配置文件中实现。 即不是用@Apest 和 @Trancational 注解 完全使用xml配置文件<br>   1)要使用的是aspectj框架，需要加入依赖<br>    <dependency><br>        <groupId>org.springframework</groupId><br>        <artifactId>spring-aspects</artifactId><br>        <version>5.2.5.RELEASE</version><br>    </dependency></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2）声明事务管理器对象</span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;xx&quot;</span> <span class="attr">class</span>=<span class="string">&quot;DataSourceTransactionManager&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<pre><code> 3) 声明方法需要的事务类型（配置方法的事务属性【隔离级别，传播行为，超时】）
 4)  配置aop：指定哪些哪类要创建代理。
</code></pre>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span> <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       把数据库的配置信息，写在一个独立的文件，编译修改数据库的配置内容</span></span><br><span class="line"><span class="comment">       spring知道jdbc.properties文件的位置</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明数据源DataSource, 作用是连接数据库的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myDataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--set注入给DruidDataSource提供连接数据库信息 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--    使用属性配置文件中的数据，语法 $&#123;key&#125; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span><span class="comment">&lt;!--setUrl()--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.passwd&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxActive&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.max&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明的是mybatis中提供的SqlSessionFactoryBean类，这个类内部创建SqlSessionFactory的</span></span><br><span class="line"><span class="comment">        SqlSessionFactory  sqlSessionFactory = new ..</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--set注入，把数据库连接池付给了dataSource属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myDataSource&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis主配置文件的位置</span></span><br><span class="line"><span class="comment">           configLocation属性是Resource类型，读取配置文件</span></span><br><span class="line"><span class="comment">           它的赋值，使用value，指定文件的路径，使用classpath:表示文件的位置</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--创建dao对象，使用SqlSession的getMapper（StudentDao.class）</span></span><br><span class="line"><span class="comment">        MapperScannerConfigurer:在内部调用getMapper()生成每个dao接口的代理对象。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定SqlSessionFactory对象的id--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定包名， 包名是dao接口所在的包名。</span></span><br><span class="line"><span class="comment">            MapperScannerConfigurer会扫描这个包中的所有接口，把每个接口都执行</span></span><br><span class="line"><span class="comment">            一次getMapper()方法，得到每个接口的dao对象。</span></span><br><span class="line"><span class="comment">            创建好的dao对象放入到spring的容器中的。 dao对象的默认名称是 接口名首字母小写</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.bjpowernode.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明service--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;buyService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.bjpowernode.service.impl.BuyGoodsServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;goodsDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;goodsDao&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;saleDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;saleDao&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明式事务处理：和源代码完全分离的--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--1.声明事务管理器对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myDataSource&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--2.声明业务方法它的事务属性（隔离级别，传播行为，超时时间）</span></span><br><span class="line"><span class="comment">          id:自定义名称，表示 &lt;tx:advice&gt; 和 &lt;/tx:advice&gt;之间的配置内容的</span></span><br><span class="line"><span class="comment">          transaction-manager:事务管理器对象的id 不设置就是默认配置</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--tx:attributes：配置事务属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--tx:method：给具体的方法配置事务属性，method可以有多个，分别给不同的方法设置事务属性</span></span><br><span class="line"><span class="comment">                name:方法名称，1）完整的方法名称，不带有包和类。</span></span><br><span class="line"><span class="comment">                              2）方法可以使用通配符,* 表示任意字符</span></span><br><span class="line"><span class="comment">                propagation：传播行为，枚举值</span></span><br><span class="line"><span class="comment">                isolation：隔离级别</span></span><br><span class="line"><span class="comment">                rollback-for：你指定的异常类名，全限定类名。 发生异常一定回滚</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;buy&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">rollback-for</span>=<span class="string">&quot;java.lang.NullPointerException,com.bjpowernode.excep.NotEnoughException&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--使用通配符，指定很多的方法--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRES_NEW&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定修改方法--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;modify*&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--删除方法--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;remove*&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--查询方法，query，search，find--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;SUPPORTS&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置aop--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置切入点表达式：指定哪些包中类，要使用事务</span></span><br><span class="line"><span class="comment">            id:切入点表达式的名称，唯一值</span></span><br><span class="line"><span class="comment">            expression：切入点表达式，指定哪些类要使用事务，aspectj会创建代理对象</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            com.bjpowernode.service</span></span><br><span class="line"><span class="comment">            com.crm.service</span></span><br><span class="line"><span class="comment">            com.service</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;servicePt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *..service..*.*(..))&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--配置增强器：关联adivce和pointcut</span></span><br><span class="line"><span class="comment">           advice-ref:通知，上面tx:advice哪里的配置</span></span><br><span class="line"><span class="comment">           pointcut-ref：切入点表达式的id</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;servicePt&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="web项目中怎么使用容器对象。"><a href="#web项目中怎么使用容器对象。" class="headerlink" title="web项目中怎么使用容器对象。"></a>web项目中怎么使用容器对象。</h2><ol>
<li><p>做的是javase项目有main方法的，执行代码是执行main方法的，<br>  在main里面创建的容器对象<br>  ApplicationContext ctx &#x3D; new ClassPathXmlApplicationContext(“applicationContext.xml”);</p>
</li>
<li><p>web项目是在tomcat服务器上运行的。 tomcat一起动，项目一直运行的。</p>
</li>
</ol>
<p><strong>需求：</strong><br>web项目中容器对象只需要创建一次，  把容器对象放入到全局作用域ServletContext中。</p>
<p><strong>怎么实现：</strong><br>   使用监听器 当全局作用域对象被创建时 创建容器 存入ServletContext</p>
<pre><code>监听器作用：
1）创建容器对象，执行 ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
2）把容器对象放入到ServletContext， ServletContext.setAttribute(key,ctx)

监听器可以自己创建，也可以使用框架中提供好的ContextLoaderListener


 private WebApplicationContext context;
 public interface WebApplicationContext extends ApplicationContext


 ApplicationContext:javase项目中使用的容器对象
WebApplicationContext：web项目中的使用的容器对象

把创建的容器对象，放入到全局作用域
 key： WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE
       WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE
 value：this.context

 servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, this.context);
</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/28/SpringMVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Devil">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/28/SpringMVC/" class="post-title-link" itemprop="url">SpringMVC</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-02-28 20:58:54 / 修改时间：21:04:35" itemprop="dateCreated datePublished" datetime="2022-02-28T20:58:54+08:00">2022-02-28</time>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>15k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>14 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a><strong>SpringMVC</strong></h1><p>SpringMVC：是基于spring的一个框架， 实际上就是spring的一个模块， 专门是做web开发的。<br>           理解是servlet的一个升级</p>
<pre><code>   web开发底层是servlet ， 框架是在servlet基础上面加入一些功能，让你做web开发方便。
</code></pre>
<p>SpringMVC就是一个Spring。 Spring是容器，ioc能够管理对象，使用<bean>, @Component, @Repository, @Service, @Controller<br>  SpringMVC能够创建对象， 放入到容器中（SpringMVC容器）， springmvc容器中放的是控制器对象，</p>
<p>  我们要做的是 使用@Contorller创建控制器对象， 把对象放入到springmvc容器中， 把创建的对象作为控制器使用<br>  这个控制器对象能接收用户的请求， 显示处理结果，就当做是一个servlet使用。</p>
<p>  使用@Controller注解创建的是一个普通类的对象， 不是Servlet。 springmvc赋予了控制器对象一些额外的功能。</p>
<p>  web开发底层是servlet， springmvc中有一个对象是Servlet ：DispatcherServlet(中央调度器)<br>  DispatcherServlet: 负责接收用户的所有请求， 用户把请求给了DispatherServlet， 之后DispatcherServlet把请求转发给<br>                    我们的Controller对象， 最后是Controller对象处理请求。</p>
<p>​    </p>
<blockquote>
<p>  index.jsp—–DispatcherServlet(Servlet)—-转发，分配给—Controller对象（@Controller注解创建的对象）<br>  main.jsp                                                   MainController<br>  addUser.jsp                                                UserController</p>
</blockquote>
<h3 id="SpringMVC核心-DispatcherServlet"><a href="#SpringMVC核心-DispatcherServlet" class="headerlink" title="SpringMVC核心 DispatcherServlet"></a><strong>SpringMVC核心 DispatcherServlet</strong></h3><h4 id="DispatcherServlet处理流程"><a href="#DispatcherServlet处理流程" class="headerlink" title="DispatcherServlet处理流程"></a>DispatcherServlet处理流程</h4><p><strong>和其他Servlet一样他也是通过Tomcat服务器创建的</strong>需要在web.xml文件中配置这个Servlet类的<servlet>和<servlet-mapping>只有这样Tomcat服务器才知道什么时候去创建这个指定的Servlet </p>
<p><strong>DispatcherServlet</strong>主要负责在tomcat启动的一开始 创建一个Springmvc容器放入ServletContext中, DispatcherServlet初始化时会读取<servlet-name>.xml文件,创建容器和里面的类的实例 比如组件扫描器配置后 @Controller注解所指的类的对象</p>
<p>在整个 Spring MVC 框架中，DispatcherServlet 处于核心位置，它负责协调和组织不同组件完成请求处理并返回响应工作。DispatcherServlet 是 SpringMVC统一的入口，所有的请求都通过它。DispatcherServlet 是前端控制器，配置在web.xml文件中，Servlet依自已定义的具体规则拦截匹配的请求，分发到目标Controller来处理。 初始化 DispatcherServlet时，该框架在web应用程序WEB-INF目录中寻找一个名为[servlet-名称]-servlet.xml的文件，并在那里定义相关的Beans，重写在全局中定义的任何Beans。在看DispatcherServlet 类之前，我们先来看一下请求处理的大致流程：</p>
<blockquote>
<ol>
<li><p>Tomcat 启动，(前提是在&lt;servlet中配置了<load-on-startup>标签 他会告诉tomcat在它启动时实例化该Servlet)对 DispatcherServlet 进行实例化，然后调用它的 init() 进行初始化，在这个初始化过程中完成了：对 web.xml 中初始化参数的加载；建立 WebApplicationContext(SpringMVC的IOC容器)；进行组件的初始化；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DispatcherServlet的初始化会执行init()方法.DispatcherServlet在inti()中&#123;</span><br><span class="line">            <span class="comment">//创建SpringMVC的IOC容器,读取配置文件</span></span><br><span class="line">            <span class="type">WebApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;springmvc.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//把容器对象放到ServletContext中(全局作用域)</span></span><br><span class="line">            getServletContext().getAttribute(key,ctx);</span><br><span class="line">                                                   </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>客户端发出请求，由 Tomcat 接收到这个请求，如果匹配 DispatcherServlet 在 web.xml中配置的映射路径，Tomcat 就将请求转交给 DispatcherServlet 处理；</p>
</li>
<li><p>DispatcherServlet 从容器中取出所有 HandlerMapping 实例（每个实例对应一个 HandlerMapping接口的实现类）并遍历，每个 HandlerMapping 会根据请求信息，通过自己实现类中的方式去找到处理该请求的 Handler(执行程序，如 Controller 中的方法)，并且将这个 Handler 与一堆 HandlerInterceptor (拦截器)封装成一个 HandlerExecutionChain 对象，一旦有一个 HandlerMapping 可以找到 Handler则退出循环；</p>
</li>
<li><p>DispatcherServlet 取出 HandlerAdapter 组件，根据已经找到的 Handler，再从所有HandlerAdapter 中找到可以处理该 Handler 的 HandlerAdapter 对象；</p>
</li>
<li><p>执行 HandlerExecutionChain 中所有拦截器的 preHandler()，然后再利用 HandlerAdapter 执行 Handler ，执行完成得到 ModelAndView，再依次调用拦截器的 postHandler()；</p>
</li>
<li><p>利用 ViewResolver 将 ModelAndView 或是 Exception (可解析成 ModelAndView)解析成View，然后 View 会调用 render() 再根据 ModelAndView 中的数据渲染出页面；</p>
</li>
<li><p>最后再依次调用拦截器的 afterCompletion()，这一次请求就结束了。</p>
</li>
</ol>
</blockquote>
<hr>
<h2 id="SpringMVC配置文件"><a href="#SpringMVC配置文件" class="headerlink" title="SpringMVC配置文件"></a><strong>SpringMVC配置文件</strong></h2><p>web,xml配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明,注册springmvc的核心对象DispatcherServlet</span></span><br><span class="line"><span class="comment">        需要在tomcat服务器启动后,创建DispatcherServlet对象的实例</span></span><br><span class="line"><span class="comment">        为什么要创建DispatcherServlet对象的实例呢?</span></span><br><span class="line"><span class="comment">        因为DispatcherServlet在他创建的过程中会同时创建springmvc容器对象</span></span><br><span class="line"><span class="comment">        读取springmvc的配置文件,把这个配置文件中的对象创建好,当用户发起请求时就可以直接直接使用对象了</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        servlet的初始化会执行init()方法.DispatcherServlet在inti()中&#123;</span></span><br><span class="line"><span class="comment">            //创建容器,读取配置文件</span></span><br><span class="line"><span class="comment">            WebApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;springmvc.xml&quot;);</span></span><br><span class="line"><span class="comment">            //把容器对象放到ServletContext中</span></span><br><span class="line"><span class="comment">            getServletContext().getAttribute(key,ctx);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--自定义springmvc读取的配置文件的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springmvc读取的配置文件的位置的属性--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定配置文件的位置--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--默认tomcat启动后不创建Servlet对象 只有接收到请求才会创建对象</span></span><br><span class="line"><span class="comment">            为了能够在tomcat启动后,创建Servlet对象 load-on-startup:表示tomcat启动后创建对象的顺序</span></span><br><span class="line"><span class="comment">            ,他的值时整数,数值越小,tomcat创建对象的时间越早,大于等于零的整数</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            使用框架的时候,url-pattern可以使用两种值</span></span><br><span class="line"><span class="comment">            1.使用扩展名,语法*.xxx,xxx是自定义扩展名.常用方式 *.do,*.action,*.mvc等</span></span><br><span class="line"><span class="comment">            表示以xxx结尾的请求都由&lt;servlet-name&gt;对应的servlet处理</span></span><br><span class="line"><span class="comment">            http://localhost:8088/myweb/web.do</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            2.使用&quot;/&quot; 与一般servlet使用无差 即拦截所有请求</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置组件扫描器 配合扫描组件的@Controller和其中的@RequestMapping--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置视图解析器 原理就是字符串的拼接--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/page/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是SpringMVC-config.xml;</p>
<hr>
<h2 id="SpringMVC请求处理过程"><a href="#SpringMVC请求处理过程" class="headerlink" title="SpringMVC请求处理过程"></a><strong>SpringMVC请求处理过程</strong></h2><p>springmvc请求的处理流程</p>
<p> 1）发起some.do<br> 2）tomcat(web.xml–url-pattern知道 *.do的请求给DispatcherServlet)<br> 3）DispatcherServlet（根据springmvc.xml配置知道 some.do—doSome()）<br> 4）DispatcherServlet把some.do转发个MyController.doSome()方法<br> 5）框架执行doSome（）把得到ModelAndView进行处理， 转发到show.jsp</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/18868114-b856800a4b003e56.png" alt="img"></p>
<p>上面的过程简化的方式</p>
<p><strong>some.do—DispatcherServlet—MyController</strong></p>
<p>springmvc执行过程源代码分析</p>
<ol>
<li>tomcat启动，创建容器的过程<br>通过load-on-start标签指定的1，创建DisaptcherServlet对象，<br>DisaptcherServlet它的父类是继承HttpServlet的， 它是一个serlvet， 在被创建时，会执行init（）方法。<br>在init（）方法中<br>&#x2F;&#x2F;创建容器，读取配置文件<br> WebApplicationContext ctx &#x3D; new ClassPathXmlApplicationContext(“springmvc.xml”);<br> &#x2F;&#x2F;把容器对象放入到ServletContext中<br> getServletContext().setAttribute(key, ctx);</li>
</ol>
<p>  上面创建容器作用： 创建@controller注解所在的类的对象， 创建MyController对象，<br>   这个对象放入到 springmvc的容器中， 容器是map ， 类似 map.put(“myController”,MyController对象)</p>
<p>2.请求的处理过程<br>  1）执行servlet的service()<br>       protected void service(HttpServletRequest request, HttpServletResponse response)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protected void doService(HttpServletRequest request, HttpServletResponse response)</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DispatcherServlet.doDispatch(request, response)&#123;</span><br><span class="line"></span><br><span class="line">    调用MyController的.doSome()方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>   doDispatch：springmvc中DispatcherServlet的核心方法， 所有的请求都在这个方法中完成的。</p>
<hr>
<h2 id="SpringMVC中的注解"><a href="#SpringMVC中的注解" class="headerlink" title="SpringMVC中的注解"></a><strong>SpringMVC中的注解</strong></h2><h4 id="Controller-控制器"><a href="#Controller-控制器" class="headerlink" title="@Controller(控制器)"></a>@Controller(控制器)</h4><blockquote>
<p>@Controller:创建处理器对象,对象放在springmvc容器中.<br>位置:类的上面<br>和spring中讲的@service和@Component一样</p>
<p>能处理请求的都是控制器(处理器):MyController能处理请,叫做后端控制器(back controller)</p>
</blockquote>
<h4 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h4><blockquote>
<p><strong>表示当前方法为处理器方法。该方法要对 value 属性所指定的 URI进行处理与响应。被注解的方法的方法名可以随意。</strong></p>
<p>@RequestMapping:请求映射:作用是把一个请求地址和一个方法绑定在一起.<br>         一个请求指定一个方法处理<br>    属性: 1.value是一个String,表示请求的uri地址的(some.do). 可以使用数组表示多个请求路径都有这个方法处理<br>         2.value的值必须是唯一的,不能重复. 再使用时推荐地址以”&#x2F;“开头</p>
<p>​            </p>
<pre><code>位置:1.在方法上面,常用的
        2.在类上面
</code></pre>
<p>说明:使用RequestMapping修饰的方法叫做处理器方法或者控制器方法<br>使用@RequestMapping修饰的方法可以处理请求的,类似与Servlet中的doGet() or doPost()</p>
<p>可以在@RequestMapping指定请求的方法 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="meta">@RequestMapping(value = &quot;/some.do&quot;,method = RequestMethod.GET)</span></span><br></pre></td></tr></table></figure>

<p>RequestMethod.GET、RequestMethod.POST</p>
</blockquote>
<p>​    如果不设置就是任意请求方法都能处理不会报405错</p>
<h2 id="请求传参"><a href="#请求传参" class="headerlink" title="请求传参"></a><strong>请求传参</strong></h2><h4 id="处理器方法的参数"><a href="#处理器方法的参数" class="headerlink" title="处理器方法的参数"></a>处理器方法的参数</h4><blockquote>
<p>处理器方法可以包含以下四类参数，这些参数会在系统调用时由系统自动赋值，即程序员可在方法内直接使用。<br>➢ HttpServletRequest<br>➢ HttpServletResponse<br>➢ HttpSession<br>➢ 请求中所携带的请求参数</p>
</blockquote>
<h4 id="方式一-直接在方法中写入与前端页面同样名称的参数（同名匹配规则）"><a href="#方式一-直接在方法中写入与前端页面同样名称的参数（同名匹配规则）" class="headerlink" title="方式一 直接在方法中写入与前端页面同样名称的参数（同名匹配规则）"></a>方式一 直接在方法中写入与前端页面同样名称的参数（同名匹配规则）</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;/springmvc_03/doSome.do&quot;</span>&gt;</span><br><span class="line">        姓名:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span> /&gt;</span><br><span class="line">        年龄:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;age&quot;</span>/&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/doSome.do&quot;, method = RequestMethod.POST)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(String name,Integer age)</span>&#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mv.addObject(<span class="string">&quot;name&quot;</span>,name);</span><br><span class="line">        mv.addObject(<span class="string">&quot;age&quot;</span>,age);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;姓名:&quot;</span>+name);</span><br><span class="line">        System.out.println(<span class="string">&quot;年龄:&quot;</span>+Integer.valueOf(age));</span><br><span class="line">        mv.setViewName(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式二-使用-RequestParam-“前台参数名”-注入"><a href="#方式二-使用-RequestParam-“前台参数名”-注入" class="headerlink" title="方式二 使用@RequestParam(“前台参数名”) 注入"></a>方式二 使用@RequestParam(“前台参数名”) 注入</h4><p>防止前台名称与后台名称不一致导致出错 同时也防止同名匹配规则与前台的耦合 利于更好的分离开发</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/doSome.do&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String sname, <span class="meta">@RequestParam(&quot;age&quot;)</span> Integer sage)</span>&#123;</span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    mv.addObject(<span class="string">&quot;name&quot;</span>,sname);</span><br><span class="line">    mv.addObject(<span class="string">&quot;age&quot;</span>,sage);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;姓名:&quot;</span>+sname);</span><br><span class="line">    System.out.println(<span class="string">&quot;年龄:&quot;</span>+Integer.valueOf(sage));</span><br><span class="line">    mv.setViewName(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>@RequestParam</code> 注解细节：</strong></p>
<blockquote>
<p>该注解有三个变量：**<code>value</code>、<code>required</code>、<code>defaultvalue</code>**</p>
<p><strong>value</strong> ：指定 <code>name</code> 属性的名称是什么，<code>value</code> 属性都可以默认不写</p>
<p><strong>required</strong> ：是否必须要有该参数，可以设置为【true】或者【false】防止出现空指针异常</p>
<p><strong>defaultvalue</strong> ：设置默认值</p>
</blockquote>
<h4 id="方式三-使用模型传参（使用对象）"><a href="#方式三-使用模型传参（使用对象）" class="headerlink" title="方式三 使用模型传参（使用对象）"></a>方式三 使用模型传参（使用对象）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/doSome.do&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(People people)</span>&#123;</span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    mv.addObject(<span class="string">&quot;name&quot;</span>,people.getName());</span><br><span class="line">    mv.addObject(<span class="string">&quot;age&quot;</span>,people.getAge());</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;姓名:&quot;</span>+people.getName());</span><br><span class="line">    System.out.println(<span class="string">&quot;年龄:&quot;</span>+people.getAge());</span><br><span class="line">    mv.setViewName(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用模型传参 要求参数的形参名要和对象的属性名一样,  框架会调用模型类的构造方法 创建一个模型 在调用模型的set方法完成注入 </p>
<p><strong>优点</strong>：可以避免方法参数过多而引起的参数过长，乱而不方便查看，而且可以隐藏信息</p>
<h4 id="注意-："><a href="#注意-：" class="headerlink" title="注意 ："></a>注意 ：</h4><p><strong>中文乱码问题</strong> </p>
<p>这种问题主要出现在POST请求中 对于这种问题如果我们没写一个方法都去写一个setCharacterEncoding的话会 程序会出现很多冗余。</p>
<p>解决方案：使用过滤器 <strong>通过配置 Spring MVC 字符编码过滤器</strong>来解决POST请求传参乱码问题 </p>
<p>**注意:**最好将该过滤器注册在其它过滤器之前。因为过滤器的执行是按照其注册顺序进行的。</p>
<p>在web.xml中配置这样一段</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置过滤器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--设置编码格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--强制请求的编码为utf-8--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--强制响应的编码为utf-8--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--对所有请求路径都修改编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="控制器回显数据"><a href="#控制器回显数据" class="headerlink" title="控制器回显数据"></a><strong>控制器回显数据</strong></h2><p>Controller处理器中的方法返回值为String就代表 视图名  一般用在同步请求</p>
<h4 id="方式一：使用-Spring-MVC-所提供的-ModelAndView-对象"><a href="#方式一：使用-Spring-MVC-所提供的-ModelAndView-对象" class="headerlink" title="方式一：使用 Spring MVC 所提供的 ModelAndView 对象"></a>方式一：使用 Spring MVC 所提供的 ModelAndView 对象</h4><p>​        在使用他之前需要创建一个show.jsp 用来充当视图 前面的演示中也是使用的这样的方式</p>
<p><strong>index.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;/springmvc_03/doSome.do&quot;</span>&gt;</span><br><span class="line">        姓名:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span> /&gt;</span><br><span class="line">        年龄:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;age&quot;</span>/&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>MyController</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/doSome.do&quot;, method = RequestMethod.POST)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(People people)</span>&#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mv.addObject(<span class="string">&quot;name&quot;</span>,people.getName());</span><br><span class="line">        mv.addObject(<span class="string">&quot;age&quot;</span>,people.getAge());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;姓名:&quot;</span>+people.getName());</span><br><span class="line">        System.out.println(<span class="string">&quot;年龄:&quot;</span>+people.getAge());</span><br><span class="line">        mv.setViewName(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>show.jsp</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;$&#123;name&#125;&lt;/h3&gt;</span><br><span class="line">&lt;h3&gt;$&#123;age&#125;&lt;/h3&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>结果如图：</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220109182433561.png" alt="image-20220109182433561"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220109182513274.png" alt="image-20220109182513274"></p>
<h4 id="方式二-使用-Model-对象"><a href="#方式二-使用-Model-对象" class="headerlink" title="方式二 使用 Model 对象"></a>方式二 使用 Model 对象</h4><p>在 Spring MVC 中，我们通常都是使用这样的方式来绑定数据</p>
<p>index.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;/springmvc_04/some.do&quot;</span>&gt;test1-Model方式回显数据&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/some.do&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">doSome</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;这是使用Model方式回显数据&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;show&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回值就是一个就是一个jsp资源可以使用完整路径 也可以使用视图解析器简化</p>
<p>show.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;$&#123;msg&#125;&lt;/h3&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>运行结果:</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220109194719801.png" alt="image-20220109194719801"></p>
<h4 id="方式三-使用-ModelAttribute-注解："><a href="#方式三-使用-ModelAttribute-注解：" class="headerlink" title="方式三 使用 @ModelAttribute 注解："></a>方式三 <strong>使用 <code>@ModelAttribute</code> 注解：</strong></h4><p>单独创建一个方法model用于在一开始向Model中添加数据</p>
<p>MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@ModelAttribute</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">model</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;这是方式三使用@ModelAttribute&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/some.do&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">doSome</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;show&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>这样写就会在访问控制器方法 handleRequest() 时，会首先调用 model() 方法将 <code>message</code> 添加进页面参数中去，在视图中可以直接调用，但是这样写会导致该控制器所有的方法都会首先调用 model() 方法，但同样的也很方便，因为可以加入各种各样的数据。</p>
<h4 id="方式四-使用void-了解"><a href="#方式四-使用void-了解" class="headerlink" title="方式四:使用void(了解)"></a>方式四:使用void(了解)</h4><p>对于处理器方法返回 void 的应用场景，AJAX 响应.</p>
<p>若处理器对请求处理后，无需跳转到其它任何资源，此时可以让处理器方法返回 void。</p>
<p>例如，对于 AJAX 的异步请求的响应。</p>
<h4 id="方式五-使用Object"><a href="#方式五-使用Object" class="headerlink" title="方式五:使用Object"></a>方式五:使用Object</h4><p><strong>主要用于响应Ajax请求</strong></p>
<blockquote>
<p>处理器方法也可以返回 Object 对象。这个 Object 可以是 Integer，String，自定义对象，Map，List 等。但返回的对象不是作为逻辑视图出现的，而是作为直接在页面显示的数据出现的。</p>
<p>返回对象，需要使用@ResponseBody 注解，将转换后的 JSON 数据放入到响应体中。</p>
</blockquote>
<p><strong>环境搭建:</strong></p>
<p>由于返回 Object 数据，一般都是将数据转化为了 JSON 对象后传递给浏览器页面的。而这个由 Object 转换为 JSON，是由 Jackson 工具完成的。所以需要导入 Jackson 的相关 Jar 包。所以需要在maven的pom.xml中添加jackson相关依赖 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>声明注解驱动:</strong></p>
<p>将 Object 数据转化为 JSON 数据，需要由消息转换器 HttpMessageConverter 完成。而转换器的开启，需要由<a href="mvc:annotation-driven/">mvc:annotation-driven/</a>来完成。(注意:一定时路径带有mvc的)</p>
<p>SpringMVC 使用消息转换器实现请求数据和对象，处理器方法返回对象和响应输出之间的自动转换</p>
<p>当 Spring 容器进行初始化过程中，在<a href="mvc:annotation-driven/">mvc:annotation-driven/</a>处创建注解驱动时，默认创建了七个 HttpMessageConverter 对象。也就是说，我们注册<a href="mvc:annotation-driven/">mvc:annotation-driven/</a>，就是为了让容器为我们创建 <strong>HttpMessageConverter</strong> 对象。(对应七个转换不同类型的对象)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">没有加入注解驱动标签时的状态</span><br><span class="line">org.springframework.http.converter.ByteArrayHttpMessageConverter </span><br><span class="line">org.springframework.http.converter.StringHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.xml.SourceHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.support.AllEncompassingFormHttpMessageConverter</span><br><span class="line"></span><br><span class="line">加入注解驱动标签时的状态</span><br><span class="line">org.springframework.http.converter.ByteArrayHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.StringHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.ResourceHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.ResourceRegionHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.xml.SourceHttpMessageConverter </span><br><span class="line">org.springframework.http.converter.support.AllEncompassingFormHttpMessageConverter </span><br><span class="line">org.springframework.http.converter.xml.Jaxb2RootElementHttpMessageConverter</span><br><span class="line">org.springframework.http.converter.json.MappingJackson2HttpMessageConverter</span><br></pre></td></tr></table></figure>



<p><strong>HttpMessageConverter 接口 :</strong> HttpMessageConverter<T>是 Spring3.0 新添加的一个接口，负责将请求信息转换为一个对象（类型为 T），将对象（类型为 T）输出为响应信息</p>
<p><em><strong>HttpMessageConverter<T>接口定义的方法：</strong></em></p>
<ol>
<li><p><strong>boolean canRead(Class&lt;?&gt; clazz,MediaType mediaType)</strong>: 指定转换器可以读取的对象类型，即转 换 器 是 否 可 将 请 求 信 息 转 换 为 clazz 类 型 的 对 象 ， 同 时 指 定 支 持 MIME 类 型(text&#x2F;html,applaiction&#x2F;json 等)</p>
</li>
<li><p>**boolean canWrite(Class&lt;?&gt; clazz,MediaType mediaType):**指定转换器是否可将 clazz 类型的对象写到响应流中，响应流支持的媒体类型在 MediaType 中定义。<br> <strong>LIst<MediaType> getSupportMediaTypes()：</strong>该转换器支持的媒体类型</p>
</li>
<li><p><strong>T read(Class&lt;? extends T&gt; clazz,HttpInputMessage inputMessage)：</strong>将请求信息流转换为 T 类型的对象。</p>
</li>
<li><p>**void write(T t,MediaType contnetType,HttpOutputMessgae outputMessage):**将 T 类型的对象写到响应流中，同时指定相应的媒体类型为 contentType</p>
</li>
</ol>
<p>加入注解驱动<a href="mvc:annotation-driven/">mvc:annotation-driven/</a>后适配器类的 messageConverters 属性值</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/18868114-5a5b24aab0a648c9.webp" alt="18868114-5a5b24aab0a648c9"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/18868114-0248cc96bbce4592.webp" alt="18868114-0248cc96bbce4592"></p>
<p><strong>返回自定义类型对象</strong></p>
<p>返回自定义类型对象时，不能以对象的形式直接返回给客户端浏览器，而是将对象转换为 JSON 格式的数据发送给浏览器的。</p>
<p><strong>在处理器方法上使用@ResponseBody即可使得返回值可以以数据的形式响应</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;myajax.do&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Student <span class="title function_">doStudentJson</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="comment">//创建Student对象</span></span><br><span class="line">    <span class="comment">//返回Student对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回其他对象也同样可以按照这个方法</strong></p>
<hr>
<h2 id="客户端跳转-重定向"><a href="#客户端跳转-重定向" class="headerlink" title="客户端跳转(重定向)"></a><strong>客户端跳转(重定向)</strong></h2><h4 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h4><p>​    框架的底层会在我们使用@Controller方法时, 在指定<strong>视图名称和Model</strong>后,帮助我们将<strong>Modl封装到request请求域</strong>中,然后自动调用**request.getRequestDispatcher(“地址”).forward(request, response);**也就是请求转发. 也就是说 这些都是服务端的跳转</p>
<p>​    在学习servlet中我们可知 请求转发是一次请求 用法为<strong>request.getRequestDispatcher(“xx.jsp”).forward()</strong></p>
<p>重定向是两次转发:<strong>response.sendRedirect(“xxx.jsp”)</strong></p>
<p>​    在SpringMVC框架中把原来 Servlet 中的请求转发和重定向操作进行了封装。现在可以使用简单的方式实现转发和重定向。</p>
<h4 id="服务端跳转"><a href="#服务端跳转" class="headerlink" title="服务端跳转"></a>服务端跳转</h4><p>​    前面对框架的介绍时我说过SpringMVC框架在你指定视图名称之后是自动帮你转发到视图资源上的(来让其获得Model中的资源).</p>
<p>​    也可以手动指定只需要在前方加入”forward”即可</p>
<p>**方式一:**以ModelAndView对象的方式返回</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(...)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">()</span>&#123;</span><br><span class="line">	ModelAndView mv= <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">	</span><br><span class="line">    mv.set(<span class="string">&quot;forward:/...jsp&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**方式二:**以String方式返回</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(...)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">doSome</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/...jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> **方式三:**以ModelAndView初始化的方式 且 以ModelAndView对象的方式返回</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(...)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">()</span>&#123;</span><br><span class="line">	ModelAndView mv= <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;forward:/...jsp&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>如何进行客户端跳转?</strong></p>
<p>注意: <strong>ModeAndView的构造方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 当没有模型数据要公开时，方便的构造函数。也可以与 &#123;<span class="doctag">@code</span> addObject&#125; 结合使用。 <span class="doctag">@param</span> viewName 要渲染的视图名		称，由 DispatcherServlet 的 ViewResolver 解析 <span class="doctag">@see</span> addObject</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 	即可以在创建ModelAndView对象时 没有设置返回的ViewName时 可以指定视图路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ModelAndView</span><span class="params">(String viewName)</span> &#123;</span><br><span class="line">   <span class="built_in">this</span>.view = viewName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**方式一:**MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/jump&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">jump</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;redirect:/jump.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以在创建 ModelAndView对象时指定重定向的资源(html、jsp、controller、servlet等)路径  </p>
<p>格式为 <strong>ModelAndView mav &#x3D; new ModelAndView(“redirect:&#x2F;资源路径”);</strong> 相当于服务器又发了一次请求但这个不能使用视图解析器 因为这是浏览器发来的另一次请求</p>
<p><strong>方式二:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/jump&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">jump</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mav.setViewName(<span class="string">&quot;redirect:/jump.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>方式三:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/jump&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">jump</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/jump.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><blockquote>
<p>​    1. 对于请求转发的页面，可以是WEB-INF中页面；而重定向的页面，是不能为WEB-INF中页的。因为重定向相当于用户再次发出一次请求，而用户是不能直接访问 WEB-INF 中资源的。</p>
</blockquote>
<hr>
<h2 id="解读-lt-url-pattern-gt"><a href="#解读-lt-url-pattern-gt" class="headerlink" title="解读&lt; url-pattern &gt;"></a><strong>解读&lt; url-pattern &gt;</strong></h2><h4 id="配置详解"><a href="#配置详解" class="headerlink" title="配置详解"></a>配置详解</h4><p><strong>（1） “*.xxx”</strong></p>
<p>​    以指定后缀结尾的请求都交由DispatcherServlet处理</p>
<p><strong>（2） “&#x2F;“</strong></p>
<p>​    “&#x2F;“将会 <strong>覆盖容器的default servlet</strong>, 凡是在web.xml文件中找不到匹配的URL，它们的访问请求都将交给该Servlet处理(静态资源也将会拦截). 所以web.xml没有配置其他特殊路径的servlet, 基本上 <strong>所有的请求</strong>都交由DispatcherServlet处理.但DispacherServlet是不能处理图片这样的静态资源的 但也有解决方法 但还是尽量让交给Tomcat去做</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220110145823608.png" alt="image-20220110145823608"></p>
<p><strong>（3）”&#x2F;*”</strong></p>
<p>​    <code>&#39;/*&#39;</code> <strong>错误的配置</strong>,会拦截 <code>*.jsp, *.jspx</code>的请求, 使用这种配置最终要转发到一个JSP页面,仍然会由DispatcherServlet, 解析jsp地址, 不能根据jsp页面找到handler, 会报错</p>
<h4 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h4><p>发起的请求是由哪些服务器程序处理的。</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/ch05_url_pattern/index.jsp">http://localhost:8080/ch05_url_pattern/index.jsp</a> ：tomcat（jsp底层本质是Servlet）<br><a target="_blank" rel="noopener" href="http://localhost:8080/ch05_url_pattern/js/jquery-3.4.1.js">http://localhost:8080/ch05_url_pattern/js/jquery-3.4.1.js</a> ： tomcat<br><a target="_blank" rel="noopener" href="http://localhost:8080/ch05_url_pattern/images/p1.jpg">http://localhost:8080/ch05_url_pattern/images/p1.jpg</a> ： tomcat<br><a target="_blank" rel="noopener" href="http://localhost:8080/ch05_url_pattern/html/test.html%EF%BC%9A">http://localhost:8080/ch05_url_pattern/html/test.html：</a> tomcat<br><a target="_blank" rel="noopener" href="http://localhost:8080/ch05_url_pattern/some.do">http://localhost:8080/ch05_url_pattern/some.do</a> ：  DispatcherServlet（springmvc框架处理的）</p>
<p>tomcat本身能处理静态资源的访问， 像html， 图片， js文件都是静态资源</p>
<h4 id="Tomcat的default"><a href="#Tomcat的default" class="headerlink" title="Tomcat的default"></a>Tomcat的default</h4><p>tomcat的web.xml文件有一个servlet 名称是 default ， 在服务器启动时创建的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>0<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>listings<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span>  表示静态资源和未映射的请求都这个default处理</span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>default这个servlet作用：</strong> </p>
<blockquote>
<p>The default servlet for all web applications, that serves static<br>resources.  It processes all requests that are not mapped to other<br>servlets with servlet mappings (defined either here or in your own<br>web.xml file).</p>
<hr>
<p>所有 Web 应用程序的默认 servlet，提供静态服务<br>资源。它处理所有未映射到其他请求的请求<br>带有 servlet 映射的 servlet（在此处定义或在您自己的<br>web.xml 文件）。</p>
</blockquote>
<ol>
<li>处理静态资源(也就是说Tomcat服务器中的DefaultServlet会处理静态资源)</li>
<li>处理未映射到其它servlet的请求。</li>
</ol>
<h4 id="解决DisPatcherServlet-配置为”-x2F-“-无法处理图片等静态资源的问题"><a href="#解决DisPatcherServlet-配置为”-x2F-“-无法处理图片等静态资源的问题" class="headerlink" title="解决DisPatcherServlet 配置为”&#x2F;“ 无法处理图片等静态资源的问题"></a>解决DisPatcherServlet 配置为”&#x2F;“ 无法处理图片等静态资源的问题</h4><p><url-pattern/>的值并不是说写为&#x2F;后，静态资源就无法访问了。经过一些配置后，该问题也是可以解决的。(.jsp还是可以访问的)</p>
<p><strong>（1） 使用&lt; mvc:default-servlet-handler &#x2F;&gt;</strong></p>
<p>​    声 明 了 <strong>&lt;mvc:default-servlet-handler &#x2F;&gt;</strong> 后 ， springmvc 框 架 会 在 容 器 中 创 建DefaultServletHttpRequestHandler 处理器对象。它会像一个检查员，对进入 DispatcherServlet的 URL 进行筛查，如果发现是静态资源的请求，就将该请求转由 Web 应用服务器默认的Servlet 处理。一般的服务器都有默认的 Servlet。</p>
<p>​    在 Tomcat 中，有一个专门用于处理静态资源访问的 Servlet 名叫 DefaultServlet。其<servlet-name/>为 default。可以处理各种静态资源访问请求。该 Servlet 注册在 Tomcat 服务器的 web.xml 中。在 Tomcat 安装目录&#x2F;conf&#x2F;web.xml。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18868114-31aa480553735354.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/897/format/webp" alt="img"></p>
<p>​    项目：url-pattern-2。在项目 url-pattern 基础上修改。</p>
<p>​    只需要在 springmvc.xml 中添加&lt; mvc:default-servlet-handler&#x2F;&gt;标签即可。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18868114-6cea9309a84d3376.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/589/format/webp" alt="img"></p>
<p>​    &lt; mvc:default-servlet-handler&#x2F;&gt;表示使用 DefaultServletHttpRequestHandler 处理器对象。而该处理器调用了 Tomcat 的 DefaultServlet 来处理静态资源的访问请求。</p>
<p>当然了，要想使用&lt;mvc: …&#x2F;&gt;标签，需要引入 mvc 约束</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18868114-f8b1be1ab1fc19ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/883/format/webp" alt="img"></p>
<p>​    该约束可从 Spring 帮助文档中搜索关键字 spring-mvc.xsd 即可获取：<br> docs&#x2F;spring-framework-reference&#x2F;htmlsingle&#x2F;index.html</p>
<p><strong>（2） 使用&lt; mvc:resources&#x2F;&gt;（掌握）</strong></p>
<p>项目：url-pattern-3。在项目 url-pattern 基础上修改。</p>
<p>​    在 Spring3.0 版本后，Spring 定义了专门用于处理静态资源访问请求的处理器ResourceHttpRequestHandler。并且添加了**&lt; mvc:resources&#x2F;&gt;**标签，专门用于解决静态资源无法访问问题。需要在 springmvc 配置文件中添加如下形式的配置：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18868114-9c8075b366097d7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/729/format/webp" alt="img"></p>
<p>​    location 表示静态资源(webapp-statics)所在目录。当然，目录不要使用&#x2F;WEB-INF&#x2F;及其子目录。</p>
<p>​    mapping 表 示 对 该 资 源 的 请 求 （ 以 &#x2F;images&#x2F; 开 始 的 请 求 ， 如 &#x2F;image&#x2F;beauty.jpg , &#x2F;images&#x2F;car.png 等）。注意，后面是两个星号**。</p>
<p><strong>（3） 声明注解驱动</strong></p>
<p>​    解决动态资源和静态资源冲突的问题，在 springmvc 配置文件加入：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18868114-9226df82b7068704.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/463/format/webp" alt="img"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--为了解决静态资源和动态资源冲突的问题,可以加入 &lt;mvc:annotation-driven/&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--方案一 调用Tomcat的默认Servlet去实现静态资源的请求 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--方案二 通过Springmvc框架去处理静态资源的请求 使用&lt; mvc:resources/&gt;且将静态资源放入webapp下的statics文件夹统一处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;statics/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/statics/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结:"></a>总结:</h4><ol>
<li><p>使用”&#x2F;“符合当今流行的REST风格</p>
</li>
<li><p>处理静态资源文件时应该将尽可能交给Tomcat服务器去做  可以通过配置&lt; mvc:resources&#x2F;&gt;实现 </p>
</li>
<li><p>我们在配置DisPatcherServlet时 应该尽可能将他的<url-pattern>配置为”*.xxxx”的形式 减少DisPatcherServlet的处理压力 增强其功能</p>
</li>
</ol>
<hr>
<h2 id="相对与绝对路径的问题"><a href="#相对与绝对路径的问题" class="headerlink" title="相对与绝对路径的问题"></a><strong>相对与绝对路径的问题</strong></h2><p>在jsp ， html中使用的地址， 都是在前端页面中的地址，都是相对地址</p>
<p><strong>地址分类：</strong></p>
<ol>
<li><p>绝对地址 ， 带有协议名称的是绝对地址，  <a target="_blank" rel="noopener" href="http://www.baidu.com/">http://www.baidu.com</a> , <a href="ftp://202.122.23.1/">ftp://202.122.23.1</a></p>
</li>
<li><p>相对地址， 没有协议开头的， 例如 user&#x2F;some.do  , &#x2F;user&#x2F;some.do<br>          相对地址不能独立使用，必须有一个参考地址。 通过参考地址+相对地址本身才能指定资源。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">张三同学， 1班有张三， 2班也有张三</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>参考地址<ol>
<li>在你的页面中的，访问地址不加 “&#x2F;“</li>
</ol>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">访问的是： http://localhost:8080/ch06_path/index.jsp</span><br><span class="line">  路径： http://localhost:8080/ch06_path/</span><br><span class="line">	资源： index.jsp</span><br><span class="line"></span><br><span class="line">在index.jsp发起 user/some.do请求，访问地址变为 http://localhost:8080/ch06_path/user/some.do</span><br><span class="line">   当你的地址 没有斜杠开头,例如 user/some.do , 当你点击链接时， 访问地址是当前页面的地址</span><br><span class="line">	加上链接的地址。</span><br><span class="line">  http://localhost:8080/ch06_path/ + user/some.do</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> index.jsp  访问 user/some.do  ， 返回后现在的地址： http://localhost:8080/ch06_path/user/some.do</span><br><span class="line"></span><br><span class="line"> http://localhost:8080/ch06_path/user/some.do</span><br><span class="line"> 路径：	  http://localhost:8080/ch06_path/user/</span><br><span class="line"> 资源：   some.do</span><br><span class="line"></span><br><span class="line"> 在index.jsp 再访问 user/some.do ，就变为 http://localhost:8080/ch06_path/user/user/some.do</span><br><span class="line"></span><br><span class="line"> 解决方案：</span><br><span class="line">  1.加入$&#123;pageContext.request.contextPath&#125;</span><br><span class="line">2.加入一个base标签， 是html语言中的标签。 表示当前页面中访问地址的基地址。</span><br><span class="line">  你的页面中所有 没有“/”开头的地址，都是以base标签中的地址为参考地址</span><br><span class="line">   使用base中的地址 + user/some.do 组成访问地址</span><br></pre></td></tr></table></figure>

<h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>index.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;user/some.do&quot;</span>&gt;带有不带斜杠的发起请求&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/some.do&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        mv.setViewName(<span class="string">&quot;/index.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后出现如下问题</p>
<h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><p>在你的页面中的，访问地址加 “&#x2F;“<br>    访问的是： <a target="_blank" rel="noopener" href="http://localhost:8080/ch06_path/index.jsp">http://localhost:8080/ch06_path/index.jsp</a><br>   路径： <a target="_blank" rel="noopener" href="http://localhost:8080/ch06_path/">http://localhost:8080/ch06_path/</a><br>       资源： index.jsp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">点击 /user/some.do, 访问地址变为 http://localhost:8080/user/some.do</span><br><span class="line">参考地址是 你的服务器地址， 也就是 http://localhost:8080</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果你的资源不能访问： 加入$&#123;pageContext.request.contextPath&#125;</span><br><span class="line">&lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/user/some.do&quot;&gt;发起user/some.do的get请求&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结:"></a>总结:</h4><ol>
<li><p>前端页面中href&#x3D;””中最前方加入”&#x2F;“表示为绝对地址 即除去域名端口后的地址包括(&#x2F;项目名&#x2F;资源路径)</p>
</li>
<li><p>前端页面中href&#x3D;””中最前方不加入”&#x2F;“表示为相对地址 即在(1)的基础上还去除了项目名(资源路径)</p>
</li>
<li><p>为了避免使用相对路径出现<img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220110155717000.jpg" alt="image-20220110155717000">的错误可以使用绝对路径 </p>
<blockquote>
<ol>
<li>使用在前面加入完整路径的方式(<a target="_blank" rel="noopener" href="http://localhost:8088/%E9%A1%B9%E7%9B%AE%E5%90%8D/%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84)%E7%9A%84%E6%96%B9%E5%BC%8F">http://localhost:8088/项目名/资源路径)的方式</a></li>
<li>在jsp页面中使用${pageContext.request.contextPath}&#x2F;</li>
<li>在jsp页面中使用<base href="http://localhost:8088/项目名/">的方式 他会在所有的请求路径之前加上base中的内容</li>
<li>但前三种始终是静态的 所以第四种为动态地获取 在jsp页面上方加入如下语句</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">basePath</span> <span class="operator">=</span> request.getScheme()+<span class="string">&quot;://&quot;</span></span><br><span class="line">            +request.getServerName()+<span class="string">&quot;:&quot;</span>+</span><br><span class="line">            request.getServerPort()+</span><br><span class="line">            request.getContextPath()+<span class="string">&quot;/&quot;</span>;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>再再base标签中配置&lt;%&#x3D;basePath%&gt;即可 与第三种的区别在于 第四种可以动态获取前方的地址</p>
<p>这些情况都是解决前端请求路径中不加入”&#x2F;“问题的处理方法</p>
<p>如果使用”&#x2F;“就上项目名即可</p>
</blockquote>
</li>
</ol>
<hr>
<h2 id="SSM整合"><a href="#SSM整合" class="headerlink" title="SSM整合"></a><strong>SSM整合</strong></h2><h4 id="整合思路"><a href="#整合思路" class="headerlink" title="整合思路"></a>整合思路</h4><p>SSM 编程，即 SpringMVC + Spring + MyBatis 整合，是当前最为流行的 JavaEE 开发技术架构。其实 SSM 整合的实质，仅仅就是将 MyBatis整合入 Spring。因为 SpringMVC原本就是 Spring的一部分，不用专门整合。</p>
<p>**第一个容器:**SpringMVC容器,管理Controller控制器对象的.</p>
<p>**第二个容器:**Spring容器,管理Service,Dao,工具类对象的.</p>
<p><strong>整合思路就是:</strong></p>
<ol>
<li><p>我们要将使用的对象交给合适的容器去创建、管理,把Controller还有web开发相关的对象交给SpringMVC容器，这些web用的对象写在SpringMVC配置文件中</p>
</li>
<li><p>service，dao对象定义在Spring的配置文件中，让spring创建和创建这些对象</p>
</li>
</ol>
<p><strong>关键：</strong>由于SpringMVC容器时Spring容器的子容器，类似于java中的继承 子是可以访问父的内容的。也就是说springmvc容器中的对象可以访问spring容器中的对象。</p>
<p><strong>SSM 整合的实现方式可分为两种：</strong>基于 XML 配置方式，基于注解方式。</p>
<h4 id="搭建-SSM-开发环境"><a href="#搭建-SSM-开发环境" class="headerlink" title="搭建 SSM 开发环境"></a>搭建 SSM 开发环境</h4><p><strong>一：</strong>搭建SSM开发环境需要 再maven中添加如下依赖</p>
<blockquote>
<ol>
<li><p>Servlet依赖 (J2EE WEB核心)</p>
</li>
<li><p>JSP依赖</p>
</li>
<li><p>SpringMVC依赖</p>
</li>
<li><p>Spring依赖</p>
</li>
<li><p>Mybatis依赖</p>
</li>
<li><p>jackson依赖</p>
</li>
<li><p>mysql依赖</p>
</li>
<li><p>druid依赖</p>
</li>
</ol>
</blockquote>
<p>需要添加的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--servlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--jsp--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--springmvc--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--spring事务的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--事务相关的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--jackson工具包--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- spring-mybatis整合用到的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mybatis依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mysql驱动依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--druid连接池依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>build中需要添加的Resources</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>二：</strong>编写web.xml</p>
<blockquote>
<ol>
<li>创建DispatcherServlet,<ol>
<li>目的创建springmvc容器,才能船舰controller类对象</li>
<li>创建的时Servlet才能接收请求</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册DispatcherServlet中央调度器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:conf/springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​     配置中央调度器时需要注意，SpringMVC的配置文件名与其它 Spring配置文件名不相同。这样做的目的是 Spring 容器创建管理 Spring 配置文件中的 bean， SpringMVC 容器中负责视图层 bean 的初始。</p>
<hr>
<ol start="2">
<li>创建spring的监听器:ContextLoaderListener<ol>
<li>目的创建spring的容器对象,才能那个创建service,doo等对象.</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册ContextLoadListener 监听器 用于初始化Spring容器的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:conf/spring.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    注册 ServletContext 监听器的实现类 ContextLoaderListener，用于创建 Spring 容器及将创建好的 Spring 容器对象放入到 ServletContext 的作用域中。</p>
<hr>
<ol start="3">
<li>注册字符集过滤器,解决post请求乱码问题</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册请求字符集过滤器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    注册字符集过滤器，用于解决请求参数中携带中文时产生乱码问题。</p>
</blockquote>
<p>**三:**创建包,Controller包,service,dao,实体类包</p>
<p>**四:**Spring、SpringMVC、Mybatis配置文件</p>
<blockquote>
<ol>
<li>Spring配置文件</li>
<li>SpringMVC配置文件</li>
<li>Mybatis主配置文件</li>
<li>数据库的属性配置文件(.properties)</li>
</ol>
</blockquote>
<p>**五:**编写代码</p>
<ol>
<li><strong>写代码、dao接口、mapper配置文件</strong></li>
<li><strong>Service和实现类、controller、实体类</strong></li>
</ol>
<p><strong>六：</strong>写页面</p>
<h4 id="项目执行流程"><a href="#项目执行流程" class="headerlink" title="项目执行流程"></a>项目执行流程</h4><p>index.jsp–addStudent.jsp—student&#x2F;addStudent.do( service的方法，调用dao的方法)–result.jsp</p>
<hr>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a><strong>异常处理</strong></h2><p><strong>异常处理：</strong><br>springmvc框架采用的是统一，全局的异常处理。<br>把controller中的所有异常处理都集中到一个地方。 采用的是aop的思想。把业务逻辑和异常处理代码分开。解耦合。</p>
<p>SpringMVC 框架处理异常的常用方式：使用**@ExceptionHandler** 注解处理异常和**@ControllerAdvice**</p>
<h4 id="ExceptionHandler-注解"><a href="#ExceptionHandler-注解" class="headerlink" title="@ExceptionHandler 注解"></a>@ExceptionHandler 注解</h4><blockquote>
<p>​    使用注解@ExceptionHandler 可以将一个方法指定为异常处理方法。该注解只有一个可选属性 value，为一个 Class&lt;?&gt;数组，用于指定该注解的方法所要处理的异常类，即所要匹配的异常。</p>
<p>​    对于异常处理注解的用法，也可以直接将异常处理方法注解于 Controller 之中。</p>
<p><strong>注意</strong>:如果指定参数那么只处理参数中指定的异常,如果参数为空，则默认为方法参数列表中列出的任何异常</p>
</blockquote>
<h5 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法:"></a>使用方法:</h5><blockquote>
<p>​    定义在Controller类的方法上(一般不用在由@RequestMapping的方法上),在方法上面加入**@ExceptionHandler 注解**并且根据需求指定参数即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doException</span><span class="params">()</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>​    不过,一般不这样使用,而是将异常处理方法专门定义在一个类中,作为全局的异常处理类.    这时需要使用注解**@ControllerAdvice**</p>
</blockquote>
<h4 id="ControllerAdvice注解"><a href="#ControllerAdvice注解" class="headerlink" title="@ControllerAdvice注解"></a>@ControllerAdvice注解</h4><blockquote>
<p>​    字面理解就是“控制器增强”，是给控制器对象增强功能的。使用@ControllerAdvice 修饰的类中可以使用**@ExceptionHandler**。</p>
<p>​    当使用**@RequestMapping** 注解修饰的方法抛出异常时，会执行**@ControllerAdvice** 修饰的类中的异常处理方法。</p>
<p>​    <strong>@ControllerAdvice</strong> 是使用**@Component** 注解修饰的，可以&lt; context:component-scan&gt;扫描到@ControllerAdvice 所在的类路径(包名)，创建对象。</p>
</blockquote>
<h5 id="使用方法-1"><a href="#使用方法-1" class="headerlink" title="使用方法:"></a>使用方法:</h5><blockquote>
<p>定义在一个类的上面 然后里面的方法使用**@ExceptionHandler注解**, 表示异常处理方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionController</span> &#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doException</span><span class="params">()</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SpringMVC.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">使用@ControllerAdvice注解需要注册注解驱动</span><br><span class="line"><span class="comment">&lt;!--声明组件扫描器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.dyw.Execp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注册注解驱动--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>


</blockquote>
<hr>
<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a><strong>拦截器</strong></h2><h4 id="拦截器-1"><a href="#拦截器-1" class="headerlink" title="拦截器"></a>拦截器</h4><p>​    SpringMVC 中的 Interceptor 拦截器是非常重要和相当有用的，它的主要作用是拦截指定的用户请求，并进行相应的预处理与后处理。其拦截的时间点在“处理器映射器根据用户提交的请求映射出了所要执行的处理器类，并且也找到了要执行该处理器类的处理器适配器，在处理器适配器执行处理器之前”。当然，在处理器映射器映射出所要执行的处理器类时，已经将拦截器与处理器组合为了一个处理器执行链，并返回给了中央调度器。</p>
<h4 id="自定义拦截器"><a href="#自定义拦截器" class="headerlink" title="自定义拦截器"></a>自定义拦截器</h4><p>​    自定义拦截器，需要实现 HandlerInterceptor 接口。而该接口中含有三个方法：</p>
<blockquote>
<p>➢ <strong>preHandle(request,response, Object handler)：</strong><br> 该方法在处理器方法执行之前执行。其返回值为 boolean，若为 true，则紧接着会执行处理器方法，且会将 afterCompletion()方法放入到一个专门的方法栈中等待执行。</p>
<p>➢ <strong>postHandle(request,response, Object handler,modelAndView)：</strong><br> 该方法在处理器方法执行之后执行。处理器方法若最终未被执行，则该方法不会执行。由于该方法是在处理器方法执行完后执行，且该方法参数中包含 ModelAndView，所以该方法可以修改处理器方法的处理结果数据，且可以修改跳转方向。</p>
<p>➢ <strong>afterCompletion(request,response, Object handler, Exception ex)：</strong><br> 当 preHandle()方法返回 true 时，会将该方法放到专门的方法栈中，等到对请求进行响应的所有工作完成之后才执行该方法。即该方法是在中央调度器渲染（数据填充）了响应页面之后执行的，此时对 ModelAndView 再操作也对响应无济于事。</p>
<p><strong>afterCompletion 最后执行的方法，清除资源，例如在 Controller 方法中加入数据</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行MyInterceptor-------preHandle()&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行MyInterceptor-------postHandle()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行MyInterceptor-------afterCompletion()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>拦截器中的方法与处理器方法的执行顺序如下：（会在请求到达处理器方法之前进行拦截的预处理，也会在处理器方法返回后响应前进行后处理）</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/18868114-b27c6ef989f87246.webp" alt="18868114-b27c6ef989f87246"></p>
<h4 id="注册拦截器"><a href="#注册拦截器" class="headerlink" title="注册拦截器"></a>注册拦截器</h4><p>需要在SpringMVC.xml配置文件中 注册拦截器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册拦截器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Interceptor.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中 &lt; mvc:mapping&#x2F;&gt;用于指定当前所注册的拦截器可以拦截的请求路径，而&#x2F;**表示拦截所有请求。</p>
<p>MyController.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/some.do&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(String name, Integer age, HttpSession session)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行MyController处理器方法&quot;</span>);</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;myname&quot;</span>,name);</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;myage&quot;</span>,age);</span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;atter&quot;</span>,<span class="string">&quot;session中的数据&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220110213638275.png" alt="image-20220110213638275"></p>
<h4 id="多个拦截器的执行"><a href="#多个拦截器的执行" class="headerlink" title="多个拦截器的执行"></a>多个拦截器的执行</h4><p>再创建一个拦截器 Myinterceptor2.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor2</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;124&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;125&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多个拦截器可以注册再一个&lt; mvc:interceptors&gt;&lt; &#x2F;mvc:interceptors&gt;中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册多个拦截器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Interceptor.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.dyw.Interceptor.MyInterceptor2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>执行情况：</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220110214156717.png" alt="image-20220110214156717"></p>
<p><strong>可以推断出 一个请求的拦截会依次经过注册的拦截器 且拦截器的处理顺序与注册顺序有关</strong></p>
<blockquote>
<p>当有多个拦截器时，形成拦截器链。拦截器链的执行顺序，与其注册顺序一致。需要再次强调一点的是，当某一个拦截器的 preHandle()方法返回 true 并被执行到时，会向一个专门的方法栈中放入该拦截器的 afterCompletion()方法。</p>
</blockquote>
<p>多个拦截器中方法与处理器方法的执行顺序如下：</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/18868114-97a75714642e9b19.png" alt="img"></p>
<h4 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h4><p>我们将第一个拦截器的preHandle（）方法返回值设为false</p>
<p>执行结果</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220110214845745.png" alt="image-20220110214845745"></p>
<p>可以发现 后面的的Interceptor没有执行结合上图（多个拦截器执行情况图）可知 只要有一个 preHandle()方法返回 false，则上部的执行链将被断开，其后续的处理器方法与 postHandle()方法将无法执行。但，无论执行链执行情况怎样，只要方法栈中有方法，即执行链中只要有 preHandle()方法返回 true，就会执行方法栈中的afterCompletion()方法。最终都会给出响应。</p>
<h4 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h4><p>可以用作检查用户权限 当用户访问一个资源时可以通过注册拦截器的方式 去检测用户的权限、用户登录处理和记录日志</p>
<p>例如：只有经过登录的用户方可访问处理器，否则，将返回“无权访问”提示。</p>
<h4 id="解惑："><a href="#解惑：" class="headerlink" title="解惑："></a>解惑：</h4><p><strong>拦截器与过滤器的区别：</strong></p>
<ol>
<li><p>过滤器是servlet中的对象，  拦截器是框架中的对象</p>
</li>
<li><p>过滤器实现Filter接口的对象， 拦截器是实现HandlerInterceptor</p>
</li>
<li><p>过滤器是用来设置request，response的参数，属性的，侧重对数据过滤的。<br>拦截器是用来验证请求的，能截断请求。</p>
</li>
<li><p>过滤器是在拦截器之前先执行的。</p>
</li>
<li><p>过滤器是tomcat服务器创建的对象<br>拦截器是springmvc容器中创建的对象</p>
</li>
<li><p>过滤器是一个执行时间点。<br>  拦截器有三个执行时间点</p>
</li>
<li><p>过滤器可以处理jsp，js，html等等<br>拦截器是侧重拦截对Controller的对象。 如果你的请求不能被DispatcherServlet接收， 这个请求不会执行拦截器内容</p>
</li>
<li><p>拦截器拦截普通类方法执行，过滤器过滤servlet请求响应</p>
</li>
</ol>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p><strong>拦截器：</strong></p>
<ol>
<li>拦截器是springmvc中的一种，需要实现HandlerInterceptor接口。</li>
<li>拦截器和过滤器类似，功能方向侧重点不同。 过滤器是用来过滤器请求参数，设置编码字符集等工作。<br>拦截器是拦截用户的请求，做请求做判断处理的。</li>
<li>拦截器是全局的，可以对多个Controller做拦截。 一个项目中可以有0个或多个拦截器， 他们在一起拦截用户的请求。<br>拦截器常用在：用户登陆验证，权限验证，日志记录</li>
</ol>
<p><strong>拦截器的使用步骤：</strong><br> 1.定义类实现HandlerInterceptor接口<br> 2.在springmvc配置文件中，声明拦截器， 让框架知道拦截器的存在。</p>
<p><strong>拦截器的执行时间：</strong><br>  1）在请求处理之前， 也就是controller类中的方法执行之前先被拦截。<br>  2）在控制器方法执行之后也会执行拦截器。<br>  3）在请求处理完成后也会执行拦截器。</p>
<p><strong>拦截器：看做是多个Controller中公用的功能，集中到拦截器统一处理。使用的aop的思想</strong></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1><h4 id=""><a href="#" class="headerlink" title=""></a></h4>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/28/MyBatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Devil">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Devil的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/28/MyBatis/" class="post-title-link" itemprop="url">Mybatis/Mybatis-Plus</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-02-28 20:58:54 / 修改时间：21:02:27" itemprop="dateCreated datePublished" datetime="2022-02-28T20:58:54+08:00">2022-02-28</time>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>20k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a><strong>MyBatis</strong></h1><h2 id="第一章-ssm-x3D-spring-springmvc-mybatis"><a href="#第一章-ssm-x3D-spring-springmvc-mybatis" class="headerlink" title="第一章(ssm &#x3D; spring + springmvc + mybatis)"></a><strong>第一章(ssm &#x3D; spring + springmvc + mybatis)</strong></h2><ol>
<li>三层架构<br>界面层： 和用户打交道的， 接收用户的请求参数， 显示处理结果的。（jsp ，html ，servlet）<br>业务逻辑层： 接收了界面层传递的数据，计算逻辑，调用数据库，获取数据<br>数据访问层： 就是访问数据库， 执行对数据的查询，修改，删除等等的。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">三层对应的包</span><br><span class="line">  界面层： controller包 （servlet）</span><br><span class="line">  业务逻辑层： service 包（XXXService类）</span><br><span class="line">  数据访问层： dao包（XXXDao类）</span><br></pre></td></tr></table></figure>


<pre><code> 三层中类的交互
   用户使用界面层--&gt; 业务逻辑层---&gt;数据访问层（持久层）--&gt;数据库（mysql）
</code></pre>
<p>​     三层对应的处理框架<br>​       界面层—servlet—springmvc（框架）<br>​       业务逻辑层—service类–spring（框架）<br>​       数据访问层—dao类–mybatis（框架）</p>
<p> 2.框架<br>   框架是一个舞台， 一个模版</p>
<p>   模版：<br>     1. 规定了好一些条款，内容。<br>          2. 加入自己的东西</p>
<p>   框架是一个模块<br>    1.框架中定义好了一些功能。这些功能是可用的。<br>    2.可以加入项目中自己的功能， 这些功能可以利用框架中写好的功能。</p>
<p>   框架是一个软件，半成品的软件，定义好了一些基础功能， 需要加入你的功能就是完整的。<br>   基础功能是可重复使用的，可升级的。</p>
<p>   框架特点：<br>    1. 框架一般不是全能的， 不能做所有事情<br>        2. 框架是针对某一个领域有效。 特长在某一个方面，比如mybatis做数据库操作强，但是他不能做其它的。<br>        3. 框架是一个软件</p>
<p> mybatis框架<br>   一个框架，早期叫做ibatis,  代码在github。<br>   mybatis是 MyBatis SQL Mapper Framework for Java （sql映射框架）<br>   1）sql mapper :sql映射<br>         可以把数据库表中的一行数据  映射为 一个java对象。<br>     一行数据可以看做是一个java对象。操作这个对象，就相当于操作表中的数据</p>
<p>   2） Data Access Objects（DAOs） : 数据访问 ， 对数据库执行增删改查。</p>
<p> mybatis提供了哪些功能：</p>
<ol>
<li>提供了创建Connection ,Statement, ResultSet的能力 ，不用开发人员创建这些对象了</li>
<li>提供了执行sql语句的能力， 不用你执行sql</li>
<li>提供了循环sql， 把sql的结果转为java对象， List集合的能力<br> while (rs.next()) {<br>   Student stu &#x3D; new Student();<br>   stu.setId(rs.getInt(“id”));<br>   stu.setName(rs.getString(“name”));<br>   stu.setAge(rs.getInt(“age”));<br>   &#x2F;&#x2F;从数据库取出数据转为 Student 对象，封装到 List 集合<br>   stuList.add(stu);<br> }</li>
</ol>
<pre><code>4.提供了关闭资源的能力，不用你关闭Connection, Statement, ResultSet
</code></pre>
<p> 开发人员做的是： 提供sql语句<br> 最后是： 开发人员提供sql语句–mybatis处理sql—开发人员得到List集合或java对象（表中的数据）</p>
<p> 总结：<br>  mybatis是一个sql映射框架，提供的数据库的操作能力。增强的JDBC,<br>  使用mybatis让开发人员集中精神写sql就可以了，不必关心Connection,Statement,ResultSet<br>  的创建，销毁，sql的执行。 </p>
<h2 id="第二章："><a href="#第二章：" class="headerlink" title="第二章："></a><strong>第二章：</strong></h2><p>  1 主要类的介绍<br>   1） Resources： mybatis中的一个类， 负责读取主配置文件<br>      InputStream in &#x3D; Resources.getResourceAsStream(“mybatis.xml”);</p>
<pre><code>2)SqlSessionFactoryBuilder : 创建SqlSessionFactory对象， 
     SqlSessionFactoryBuilder builder  = new SqlSessionFactoryBuilder();
    //创建SqlSessionFactory对象
    SqlSessionFactory factory = builder.build(in);
</code></pre>
<p>  3）SqlSessionFactory ： 重量级对象， 程序创建一个对象耗时比较长，使用资源比较多。<br>        在整个项目中，有一个就够用了。</p>
<pre><code> SqlSessionFactory:接口  ， 接口实现类： DefaultSqlSessionFactory
  SqlSessionFactory作用： 获取SqlSession对象。SqlSession sqlSession = factory.openSession();

  openSession()方法说明：
   1. openSession() ：无参数的， 获取是非自动提交事务的SqlSession对象
    2. openSession(boolean): openSession(true)  获取自动提交事务的SqlSession. 
                             openSession(false)  非自动提交事务的SqlSession对象
</code></pre>
<p> 4)SqlSession:<br>   SqlSession接口 ：定义了操作数据的方法 例如 selectOne() ,selectList() ,insert(),update(), delete(), commit(), rollback()<br>   SqlSession接口的实现类DefaultSqlSession。</p>
<pre><code>使用要求： SqlSession对象不是线程安全的，需要在方法内部使用， 在执行sql语句之前，使用openSession()获取SqlSession对象。
在执行完sql语句后，需要关闭它，执行SqlSession.close(). 这样能保证他的使用是线程安全的。
</code></pre>
<h2 id="第三章："><a href="#第三章：" class="headerlink" title="第三章："></a><strong>第三章：</strong></h2><ol>
<li><p>动态代理： 使用SqlSession.getMapper(dao接口.class) 获取这个dao接口的对象</p>
</li>
<li><p>传入参数： 从java代码中把数据传入到mapper文件的sql语句中。<br>1）parameterType ： 写在mapper文件中的 一个属性。 表示dao接口中方法的参数的数据类型。<br>例如StudentDao接口<br> public Student  selectStudentById(Integer id) </p>
<ol start="2">
<li>一个简单类型的参数：<br>简单类型： mybatis把java的基本数据类型和String都叫简单类型。<br>在mapper文件获取简单类型的一个参数的值，使用 #{任意字符}</li>
</ol>
<p> 接口：public Student  selectStudentById(Integer id)<br> mapper:select id,name, email,age from student where id&#x3D;#{studentId}</p>
</li>
</ol>
<pre><code>3) 多个参数，使用@Param命名参数
  接口 public List&lt;Student&gt; selectMulitParam(@Param(&quot;myname&quot;) String name, @Param(&quot;myage&quot;) Integer age)
  使用  @Param(&quot;参数名&quot;)  String name 
 mapper文件：
     &lt;select&gt;
         select * from student where name=#&#123;myname&#125; or age=#&#123;myage&#125;
      &lt;/select&gt;

4) 多个参数，使用java对象
   语法 #&#123;属性名&#125;
</code></pre>
<p>   vo: value object , 放一些存储数据的类。比如说 提交请求参数， name ,age<br>         现在想把name ,age 传给一个service 类。</p>
<p>   vo: view object , 从servlet把数据返回给浏览器使用的类，表示显示结果的类。</p>
<p>   pojo: 普通的有set， get方法的java类。 普通的java对象</p>
<pre><code>      Servlet --- StudentService( addStudent( MyParam  param)  )
</code></pre>
<p>   entity（domain域）: 实体类， 和数据库中的表对应的类， </p>
<pre><code>5) # 和  $

  select id,name, email,age from student where id=#&#123;studentId&#125;
  # 的结果： select id,name, email,age from student where id=? 


   select id,name, email,age from student where id=$&#123;studentId&#125;
  $ 的结果：select id,name, email,age from student where id=1001

  String sql=&quot;select id,name, email,age from student where id=&quot; + &quot;1001&quot;;
  使用的Statement对象执行sql， 效率比PreparedStatement低。


  $:可以替换表名或者列名， 你能确定数据是安全的。可以使用$


  # 和 $区别
  1. #使用 ？在sql语句中做站位的， 使用PreparedStatement执行sql，效率高
  2. #能够避免sql注入，更安全。
  3. $不使用占位符，是字符串连接方式，使用Statement对象执行sql，效率低
  4. $有sql注入的风险，缺乏安全性。
  5. $:可以替换表名或者列名
</code></pre>
<ol start="3">
<li><p>mybatis的输出结果<br>mybatis执行了sql语句，得到java对象。</p>
<p> 1）resultType结果类型， 指sql语句执行完毕后， 数据转为的java对象， java类型是任意的。<br>   resultType结果类型的它值 1. 类型的全限定名称   2. 类型的别名， 例如 java.lang.Integer别名是int</p>
<pre><code>处理方式：
   1. mybatis执行sql语句， 然后mybatis调用类的无参数构造方法，创建对象。
    2. mybatis把ResultSet指定列值付给同名的属性。


    &lt;select id=&quot;selectMultiPosition&quot; resultType=&quot;com.bjpowernode.domain.Student&quot;&gt;
  select id,name, email,age from student
&lt;/select&gt;

  对等的jdbc
  ResultSet rs = executeQuery(&quot; select id,name, email,age from student&quot; )
  while(rs.next())&#123;
       Student  student = new Student();
            student.setId(rs.getInt(&quot;id&quot;));
            student.setName(rs.getString(&quot;name&quot;))
  &#125;
</code></pre>
</li>
</ol>
<ol start="2">
<li>定义自定义类型的别名<br> 1）在mybatis主配置文件中定义，使<typeAlias>定义别名<br>  2）可以在resultType中使用自定义别名</li>
</ol>
<p>   3）resultMap:结果映射， 指定列名和java对象的属性对应关系。<br>        1）你自定义列值赋值给哪个属性<br>         2）当你的列名和属性名不一样时，一定使用resultMap</p>
<pre><code>     resultMap和resultType不要一起用，二选一
</code></pre>
<p>dao接口中的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示使用ResultMap</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> List&lt;Student&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;Student&gt; <span class="title function_">selectStudents</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p>StudentDao.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用ResultMap 必须先定义ResultMap</span></span><br><span class="line"><span class="comment">可以防止实体类中的属性名与数据库表中的列名的不同的囧境--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--定义ResultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.dyw.Domain.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--主键列使用 id标签</span></span><br><span class="line"><span class="comment">        column 表的列名</span></span><br><span class="line"><span class="comment">        property java类型的属性名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--非主键列使用result标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudents&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentMap&quot;</span>&gt;</span></span><br><span class="line">    select id,name,age from student order by id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>输出:</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220111153344824.png" alt="image-20220111153344824"></p>
<p><strong>注意</strong>:如果Dao接口使用Map作为返回结果的话 需要在ResultType中配置Map的全限定名称 而不是实体类的名称(如果返回值为List则依旧使用实体类的全限定名称) 并且返回的结果是以列名作为键 列值作为值  </p>
<h2 id="第四章动态sql"><a href="#第四章动态sql" class="headerlink" title="第四章动态sql"></a><strong>第四章动态sql</strong></h2><h4 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询:"></a>模糊查询:</h4><p>​    **like:**在dao.xml配置文件中 直接使用like即可 当使用#{}拼接时 我们前面说过 他是以占位符?(即preparedStatement)所以格式为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--模糊查询的两种方式</span></span><br><span class="line"><span class="comment">        1.直接传入一个字符串 类似与%丁%</span></span><br><span class="line"><span class="comment">        2.使用字符串拼接</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentsByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dyw.Domain.Student&quot;</span>&gt;</span></span><br><span class="line">        select id,name,age from student where name like &quot;%&quot; #&#123;name&#125; &quot;%&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">底层为</span><br><span class="line"><span class="comment">&lt;!--Preparing: select id,name,age from student where name like &quot;%&quot; ? &quot;%&quot;--&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    但是使用${}时不一样它是使用Statement即字符串拼接 所以格式为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentsByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dyw.Domain.Student&quot;</span>&gt;</span></span><br><span class="line">        select id,name,age from student where name like &quot;%$&#123;name&#125;%&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">底层</span><br><span class="line"><span class="comment">&lt;!--Preparing: select id,name,age from student where name like &quot;%丁%&quot;--&gt;</span></span><br></pre></td></tr></table></figure>



<p> 动态sql: sql的内容是变化的，可以根据条件获取到不同的sql语句。<br>           主要是where部分发生变化。</p>
<p> 动态sql的实现，使用的是mybatis提供的标签， <if> ,<where>,<foreach></p>
<p> 1)<if>是判断条件的，<br>   语法<if test="判断java对象的属性值"><br>            部分sql语句<br>        </if></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用标签&lt;if&gt;可以判断条件 如果条件满足要求则将条件拼接在where后 可以防止sql运行时报错--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    多个if拼接的时候一般在where后面加一个1=1 保证拼接时不会出错</span></span><br><span class="line"><span class="comment">        注意使用动态sql语句 一定要传java对象作为参数</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentsByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dyw.Domain.Student&quot;</span>&gt;</span></span><br><span class="line">    select id,name,age from student</span><br><span class="line">        where 1=1</span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name !=null and name != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and name like #&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age &gt; 0&quot;</span>&gt;</span></span><br><span class="line">            and age &gt; #&#123;age&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但这样有弊端，就是为了避免拼接错误，需要使用or 1&#x3D;1， 但是这样又会导致另一个错误，那就是可以会将所有的内容都查出来，这是我们不想看到的。</p>
<p> 2)<where> 用来包含 多个<if>的， 当多个if有一个成立的， <where>会自动增加一个where关键字，<br>            并去掉 if中多余的 and ，or等。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用where标签时就不会出现拼接错误现象 底层会自动判别然后进行拼接 可以自动去除and or等连接词比直接用&lt;if&gt;安全性好--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectStudentsByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dyw.Domain.Student&quot;</span>&gt;</span></span><br><span class="line">    select id,name,age from student</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null and name !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            and name like #&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age &gt; 0&quot;</span>&gt;</span></span><br><span class="line">            and age &gt;#&#123;age&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    使用&lt; where&gt;标签就不会出现上述&lt; if&gt;的情况 &lt; where&gt;标签可以智能帮助我们去除and or 等 防止拼接错误</p>
<p> 3）<foreach> 循环java中的数组，list集合的。 主要用在sql的in语句中。(用于当传入的参数为集合时 为了获取里面的数据)<br>    学生id是 1001,1002,1003的三个学生</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select * from student where id <span class="title function_">in</span> <span class="params">(<span class="number">1001</span>,<span class="number">1002</span>,<span class="number">1003</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;Student&gt; <span class="title function_">selectFor</span><span class="params">(List&lt;Integer&gt; idlist)</span></span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ...</span><br><span class="line">list.add(<span class="number">1001</span>);</span><br><span class="line">list.add(<span class="number">1002</span>);</span><br><span class="line">list.add(<span class="number">1003</span>);</span><br><span class="line"></span><br><span class="line">dao.selectFor(list)</span><br></pre></td></tr></table></figure>


<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;&quot;</span> <span class="attr">item</span>=<span class="string">&quot;&quot;</span> <span class="attr">open</span>=<span class="string">&quot;&quot;</span> <span class="attr">close</span>=<span class="string">&quot;&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">         #&#123;xxx&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"></span><br><span class="line">collection:表示接口中的方法参数的类型， 如果是数组使用array , 如果是list集合使用list</span><br><span class="line"> item:自定义的，表示数组和集合成员的变量</span><br><span class="line"> open:循环开始是的字符</span><br><span class="line"> close:循环结束时的字符</span><br><span class="line">separator:集合成员之间的分隔符</span><br></pre></td></tr></table></figure>

<p>  4）sql代码片段， 就是复用一些语法<br>    步骤<br>     1.先定义 <sql id="自定义名称唯一">  sql语句， 表名，字段等 </sql><br>    2.再使用， <include refid="id的值" /></p>
<h2 id="第五章："><a href="#第五章：" class="headerlink" title="第五章："></a><strong>第五章：</strong></h2><ol>
<li>数据库的属性配置文件： 把数据库连接信息放到一个单独的文件中。 和mybatis主配置文件分开。<br>目的是便于修改，保存，处理多个数据库的信息。<br><!--便于维护,管理与使用--><ol>
<li><p>在resources目录中定义一个属性配置文件， xxxx.properties ,例如 jdbc.properties<br>   在属性配置文件中， 定义数据，格式是 key&#x3D;value<br>     key： 一般使用 . 做多级目录的。<br>     例如 jdbc.mysql.driver    , jdbc.driver, mydriver<br>     jdbc.driver&#x3D;com.mysql.jdbc.Driver<br>     jdbc.url&#x3D;jdbc:mysql&#x2F;&#x2F;…..<br>     jdbc.username&#x3D;root<br>     jdbc.password&#x3D;123456</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--指定properties文件路径 从类路径根开始查找--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>​     </p>
</li>
<li><p>在mybatis的主配置文件，使用<property> 指定文件的位置<br> 在需要使用值的地方， ${key}</p>
</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.user&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p> 2.mapper文件，使用package指定路径<br>    在MyBatis-config文件中可以指定多个mapper文件 第一个中方式直接在<mappers></mappers>中加入多个<mapper/><br>    注意mapper的路径从类路径的根开始(target&#x2F;classes)<br>     <mappers></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--第二种方式： 使用包名</span></span><br><span class="line"><span class="comment">        name: xml文件（mapper文件）所在的包名, 这个包中所有xml文件一次都能加载给mybatis</span></span><br><span class="line"><span class="comment">        使用package的要求：</span></span><br><span class="line"><span class="comment">         1. mapper文件名称需要和接口名称一样， 区分大小写的一样</span></span><br><span class="line"><span class="comment">         2. mapper文件和dao接口需要在同一目录</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.bjpowernode.dao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第六章：PageHelper"><a href="#第六章：PageHelper" class="headerlink" title="第六章：PageHelper"></a><strong>第六章：PageHelper</strong></h2><p> <strong>PageHelper做数据分页的。</strong>(国人写的)</p>
<ol>
<li><p>maven中添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>在MyBatis-config中配置插件<br>注意:<strong>MyBatis-config配置顺序如下properties, settings,plugins</strong>;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在&lt;plugins&gt;标签中配置--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置pageHelper插件放在setting后面--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>配置完成后在使用时调用 pagehelper.startpage(页码(int),每页显示条数(int))方法 注意放在执行sql语句之前 输出会自动显示参数指定的几条</p>
</li>
</ol>
<hr>
<h2 id="MyBatis的缓存机制"><a href="#MyBatis的缓存机制" class="headerlink" title="MyBatis的缓存机制"></a><strong>MyBatis的缓存机制</strong></h2><p>​                                                                            <a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000041193993">https://segmentfault.com/a/1190000041193993</a></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">缓存机制减轻数据库压力，提高数据库性能</span><br><span class="line">mybatis的缓存分为两级：一级缓存、二级缓存</span><br></pre></td></tr></table></figure>

<h4 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存:"></a><strong>一级缓存</strong>:</h4><p>​    一级缓存为 <code>sqlsession</code> 缓存，缓存的数据只在 SqlSession 内有效。在操作数据库的时候需要先  创建 SqlSession 会话对象，在对象中有一个 HashMap 用于存储缓存数据，此 HashMap 是当前    会话对象私有的，别的 SqlSession 会话对象无法访问。</p>
<p>​    具体流程：</p>
<p>​    第一次执行 select 完毕会将查到的数据写入 <strong>SqlSession</strong> 内的 <strong>HashMap</strong> 中缓存起来</p>
<p>​    第二次执行(可能多次) select 会从<strong>缓存</strong>中查数据，如果 select 同传参数一样，那么就能从缓存中返回数据，不用去数据库了，从而提高了效率</p>
<h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a><strong>注意：</strong></h4><p>​    1、如果 在<strong>同</strong>一个SqlSession 执行了 DML 操作（insert、update、delete），并 commit 了，那么 mybatis 就会清空当前 SqlSession 缓存中的所有缓存数据，这样可以保证缓存中的存的数据永远和数据库中一致，避免出现差异</p>
<p>​    2、当一个 SqlSession 结束后那么他里面的一级缓存也就不存在了， mybatis 默认是开启一级缓存且默认作用范围时SESSION，也可以手动配置为STATEMENT(让一级缓存仅针对当前执行的<code>SQL</code>语句生效；)，不需要配置二级缓存默认时没有开启的为false 需要手动在Mybatis-config中配置(<setting></setting>中)</p>
<p>​    3、 mybatis 的缓存是基于 [namespace:sql语句:参数] 来进行缓存的，意思就是， SqlSession 的 HashMap 存储缓存数据时，是使用 [namespace:sql:参数] 作为 key ，查询返回的语句作为 value 保存的,**即{key&#x3D;namespace:sql:参数，value&#x3D;查询到的数据}**。</p>
<p>​    4. 不同会话持有不同的一级缓存，本会话内的操作不会影响其它会话内的一级缓存。</p>
<h4 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a><strong>二级缓存</strong></h4><p>二级缓存是<code> mapper</code> 级别的缓存，也就是同一个 namespace 的 mapper.xml ，当多个 SqlSession 使用同一个 Mapper 操作数据库的时候，得到的数据会缓存在同一个二级缓存区域</p>
<p>二级缓存默认是没有开启的。需要在 setting 全局参数中配置开启二级缓存</p>
<p>开启二级缓存步骤：</p>
<p>1、<code>conf.xml</code> 配置全局变量开启二级缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span>默认是false：关闭二级缓存</span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、在<code>userMapper.xml</code>中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;LRU&quot;</span> <span class="attr">type</span>=<span class="string">&quot;org.apache.ibatis.cache.impl.PerpetualCache&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;512&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span>当前mapper下所有语句开启二级缓存</span><br></pre></td></tr></table></figure>

<p>这里配置了一个 LRU 缓存，并每隔60秒刷新，最大存储512个对象，而返回的对象是只读的</p>
<p>若想禁用当前<code>select</code>语句的二级缓存，添加 <code>useCache=&quot;false&quot;</code>修改如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getCountByName&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.Map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">statementType</span>=<span class="string">&quot;CALLABLE&quot;</span> <span class="attr">useCache</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>具体流程：</p>
<p>1.当一个<code>sqlseesion</code>执行了一次<code> select</code> 后，在关闭此<code> session</code> 的时候，会将查询结果缓存到二级缓存</p>
<p>2.当另一个<code>sqlsession</code>执行<code> select</code> 时，（前提二级缓存开启时）首先会在他自己的二级缓存中找，如果没找到，就回去一级缓存中找，找到了就返回，就不用去数据库了，从而减少了数据库压力提高了性能</p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h4><ol>
<li><p>如果 <code>SqlSession</code> 执行了 DML 操作<code>（insert、update、delete）</code>，并 <code>commit</code> 了，那么 <code>mybatis</code> 就会清空当前<code> mapper</code> 缓存中的所有缓存数据，这样可以保证缓存中的存的数据永远和数据库中一致，避免出现差异（如果没有commit）就不会清空mybatis中的二级缓存</p>
</li>
<li><p><code> mybatis</code> 的缓存是基于<code>[namespace:sql语句:参数]</code>来进行缓存的，意思就是，<code>SqlSession</code> 的 <code>HashMap</code> 存储缓存数据时，是使用 <code>[namespace:sql:参数] </code>作为 <code>key</code> ，查询返回的语句作为 <code>value</code> 保存的。</p>
</li>
<li><p><code>Mybatis</code>中需要在映射文件中添加<code>&lt;cache&gt;</code>标签来为映射文件配置二级缓存，也可以在映射文件中添加<code>&lt;cache-ref&gt;</code>标签来引用其它映射文件的二级缓存以达到多个映射文件持有同一份二级缓存的效果。</p>
</li>
<li><p><cache-ref namespace="com.mybatis.learn.dao.BookMapper"/>该语句可以在另一个mybatis-mapper中指定二级缓存（一个mapper拥有一个二级缓存 这里指定了缓存的指向）这样两个mapper可以共享一个二级缓存</p>
<hr>
</li>
</ol>
<p><strong><code>&lt;cache&gt;</code>标签如下所示。</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
<th>默认值</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>eviction</strong></td>
<td>缓存淘汰策略。<strong>LRU</strong>表示最近使用频次最少的优先被淘汰；<strong>FIFO</strong>表示先被缓存的会先被淘汰；<strong>SOFT</strong>表示基于软引用规则来淘汰；<strong>WEAK</strong>表示基于弱引用规则来淘汰</td>
<td><strong>LRU</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>flushInterval</strong></td>
<td>缓存刷新间隔。单位毫秒</td>
<td>空，表示永不过期</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>type</strong></td>
<td>缓存的类型</td>
<td><code>PerpetualCache</code>(永久缓存)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>size</strong></td>
<td>最多缓存的对象个数</td>
<td>1024</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>blocking</strong></td>
<td>缓存未命中时是否阻塞</td>
<td><strong>false</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>readOnly</strong></td>
<td>缓存中的对象是否只读。配置为<strong>true</strong>时，表示缓存对象只读，命中缓存时会直接将缓存的对象返回，性能更快，但是线程不安全；配置为<strong>false</strong>时，表示缓存对象可读写，命中缓存时会将缓存的对象克隆然后返回克隆的对象，性能更慢，但是线程安全</td>
<td><strong>false</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th>含义</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>namespace</strong></td>
<td>其它映射文件的命名空间，设置之后则当前映射文件将和其它映射文件将持有同一份二级缓存</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left"></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="MyBatis-Plus"><a href="#MyBatis-Plus" class="headerlink" title="MyBatis-Plus"></a><strong>MyBatis-Plus</strong></h1><p><strong>注意</strong>：引入 <code>MyBatis-Plus</code> 之后请不要再次引入 <code>MyBatis</code> 以及 <code>MyBatis-Spring</code>，以避免因版本差异导致的问题。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h2><p><a target="_blank" rel="noopener" href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus (opens new window)</a>（简称 MP）是一个 <a target="_blank" rel="noopener" href="https://www.mybatis.org/mybatis-3/">MyBatis (opens new window)</a>的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</p>
<blockquote>
<p> 愿景</p>
<p>我们的愿景是成为 MyBatis 最好的搭档，就像 <a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/img/contra.jpg">魂斗罗</a> 中的 1P、2P，基友搭配，效率翻倍。</p>
</blockquote>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><ul>
<li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li>
<li><strong>损耗小</strong>：启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作</li>
<li><strong>强大的 CRUD 操作</strong>：内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求</li>
<li><strong>支持 Lambda 形式调用</strong>：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li>
<li><strong>支持主键自动生成</strong>：支持多达 4 种主键策略（内含分布式唯一 ID 生成器 - Sequence），可自由配置，完美解决主键问题</li>
<li><strong>支持 ActiveRecord 模式</strong>：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li>
<li><strong>支持自定义全局通用操作</strong>：支持全局通用方法注入（ Write once, use anywhere ）</li>
<li><strong>内置代码生成器</strong>：采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 Service 、 Controller 层代码，支持模板引擎，更有超多自定义配置等您来使用</li>
<li><strong>内置分页插件</strong>：基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</li>
<li><strong>分页插件支持多种数据库</strong>：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer 等多种数据库</li>
<li><strong>内置性能分析插件</strong>：可输出 SQL 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li>
<li><strong>内置全局拦截插件</strong>：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li>
</ul>
<h3 id="支持数据库"><a href="#支持数据库" class="headerlink" title="#支持数据库"></a><a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/#%E6%94%AF%E6%8C%81%E6%95%B0%E6%8D%AE%E5%BA%93">#</a>支持数据库</h3><blockquote>
<p>任何能使用 <code>mybatis</code> 进行 CRUD, 并且支持标准 SQL 的数据库，具体支持情况如下，如果不在下列表查看分页部分教程 PR 您的支持。</p>
</blockquote>
<ul>
<li>mysql，oracle，db2，h2，hsql，sqlite，postgresql，sqlserver，Phoenix，Gauss ，clickhouse，Sybase，OceanBase，Firebird，cubrid，goldilocks，csiidb</li>
<li>达梦数据库，虚谷数据库，人大金仓数据库，南大通用(华库)数据库，南大通用数据库，神通数据库，瀚高数据库</li>
</ul>
<h3 id="框架结构"><a href="#框架结构" class="headerlink" title="#框架结构"></a><a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/#%E6%A1%86%E6%9E%B6%E7%BB%93%E6%9E%84">#</a>框架结构</h3><p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/mybatis-plus-framework.jpg" alt="framework"></p>
<p><strong>就是在mybatis的基础上再次简化操作 让原来需要程序员写的curd代码都节省了</strong> 同时还优化了性能</p>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a><strong>快速开始</strong></h2><h4 id="一：创建一个boot工程（SpringBoot-Initializr）"><a href="#一：创建一个boot工程（SpringBoot-Initializr）" class="headerlink" title="一：创建一个boot工程（SpringBoot Initializr）"></a>一：创建一个boot工程（SpringBoot Initializr）</h4><p>勾选SQL中的MySQL Driver</p>
<h4 id="二：引入mybatis-plus相关依赖"><a href="#二：引入mybatis-plus相关依赖" class="headerlink" title="二：引入mybatis-plus相关依赖"></a>二：引入mybatis-plus相关依赖</h4><p>引入 Spring Boot Starter 父工程：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>spring-latest-version<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>引入 <code>spring-boot-starter</code>、<code>spring-boot-starter-test</code>、<code>mybatis-plus-boot-starter</code> <code>、mysql-connector-java、lombok</code>依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="三：配置"><a href="#三：配置" class="headerlink" title="三：配置"></a>三：配置</h4><ul>
<li>在application.yml中配置数据库连接的相关信息</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/my_db</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">devil</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在 Spring Boot 启动类中添加 <code>@MapperScan</code> 注解，扫描 Mapper 文件夹：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.dyw.mybatisplus01pre.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlus01PreApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MybatisPlus01PreApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>借助lombok插件编写实体类 Student.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@TableId</span> 指定之间的方式：</span></span><br><span class="line"><span class="comment">     * value：主键字段的名称，如果时id，可以不用写</span></span><br><span class="line"><span class="comment">     * type:指定主键的类型，主键的值如何生成。idType.AUTO,表示自动增长</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">            type = IdType.AUTO</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写Mapper接口 <code>StudentMapper.java</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义Mapper，就是Dao接口</span></span><br><span class="line"><span class="comment"> * 1.要继承BaseMapper</span></span><br><span class="line"><span class="comment"> * 2.指定实体类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * BaseMapper是Mp框架中的对象，定义了十七个方法（CRUD）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Student&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试类 测试</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MybatisPlus01PreApplicationTests</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentMapper studentMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Student&gt; students = studentMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (Student student : students) &#123;</span><br><span class="line">            System.out.println(student);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220121180912055.png" alt="image-20220121180912055"></p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>*　通过以上几个简单的步骤，我们就实现了 Student 表的 CRUD 功能，甚至连 XML 文件都不用编写！<br>*　从以上步骤中，我们可以看到集成<code>MyBatis-Plus</code>非常的简单，只需要引入 starter 工程，并配置 mapper 扫描路径即可。<br>*　<strong>对于mapper的扫描可以选择在启动类中写@MapperScan() 也可以在mapper接口上加@mapper 前者适合mapper接口多的情况 后者则书写更方便。</strong><br>*　在执行插入操作时 执行成功后 会将结果返回到传入的对象中（例如我们可以通过传入的对象获得主键自增长的主键值）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">People</span> <span class="variable">people1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>(<span class="literal">null</span>, <span class="string">&quot;王裴豫川&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> peopleMapper.insert(people1);</span><br><span class="line"></span><br><span class="line">        System.out.println(row&gt;<span class="number">0</span>?<span class="string">&quot;成功&quot;</span>:<span class="string">&quot;失败&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;主键id：&quot;</span>+people1.getId());</span><br><span class="line">        System.out.println();</span><br><span class="line">        List&lt;People&gt; people = peopleMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (People person : people) &#123;</span><br><span class="line">            System.out.println(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>​    可以看到我们没有对传入的对象的主键赋值（自动增长）但我们通过执行操作后的对象获得了插入到表中的该行数据的主    键 证实了上述结论</p>
<h2 id="Spring整合Mybatis-Plus"><a href="#Spring整合Mybatis-Plus" class="headerlink" title="Spring整合Mybatis-Plus"></a><strong>Spring整合Mybatis-Plus</strong></h2><ul>
<li>上面的快速开始我们介绍了通过SpringBoot整合MyBatis-Plus</li>
</ul>
<h4 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h4><p><strong>加入Spring依赖和数据库JDBC依赖后还需要加入Mybatis-Plus的依赖</strong></p>
<p><strong>引入 <code>MyBatis-Plus</code> 之后请不要再次引入 <code>MyBatis</code> 以及 <code>MyBatis-Spring</code>，以避免因版本差异导致的问题。</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>MyBatis-Plus 的配置异常的简单，我们仅需要一些简单的配置即可使用 MyBatis-Plus 的强大功能！</p>
<p>配置 MapperScan  spring.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.dyw.mapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>要想使用mybatis-plus的日志功能 需要在application.yml中添加如下语句</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<h2 id="CRUD接口"><a href="#CRUD接口" class="headerlink" title="CRUD接口"></a><strong>CRUD接口</strong></h2><h2 id="Service-CRUD-接口"><a href="#Service-CRUD-接口" class="headerlink" title="Service CRUD 接口"></a><a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/crud-interface.html#service-crud-%E6%8E%A5%E5%8F%A3">Service CRUD 接口</a></h2><blockquote>
<p>说明:</p>
<ul>
<li><p>通用 Service CRUD 封装<a target="_blank" rel="noopener" href="https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-extension/src/main/java/com/baomidou/mybatisplus/extension/service/IService.java">IService (opens new window)</a>接口，进一步封装 CRUD 采用 <code>get 查询单行</code> <code>remove 删除</code> <code>list 查询集合</code> <code>page 分页</code> 前缀命名方式区分 <code>Mapper</code> 层避免混淆，</p>
</li>
<li><p>泛型 <code>T</code> 为任意实体对象</p>
</li>
<li><p>建议如果存在自定义通用 Service 方法的可能，请创建自己的 <code>IBaseService</code> 继承 <code>Mybatis-Plus</code> 提供的基类</p>
</li>
<li><p>对象 <code>Wrapper</code> 为 <a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/wrapper.html">条件构造器</a></p>
</li>
<li><p>&#96;&#96;&#96;java<br>@SuppressWarnings(“all”)<br>public interface BookService extends IService<Book> {<br>&#x2F;&#x2F;boolean save(Book book);<br>&#x2F;&#x2F;boolean update(Book book);<br>&#x2F;&#x2F;boolean delete(Integer id);<br>&#x2F;&#x2F;Book getById(Integer id);<br>List<Book> getAll();<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 可以追加自定义操作 需要自己编写方法实体 模板如下</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  @Service</span><br><span class="line">  @SuppressWarnings(&quot;all&quot;)</span><br><span class="line">  public class BookServiceImpl extends ServiceImpl&lt;BookMapper,Book&gt; implements BookService&#123;</span><br><span class="line">      @Autowired</span><br><span class="line">      private BookMapper mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      @Override</span><br><span class="line">      public List&lt;Book&gt; getAll() &#123;</span><br><span class="line">          return null;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<hr>
<h2 id="Mapper-CRUD-接口"><a href="#Mapper-CRUD-接口" class="headerlink" title="Mapper CRUD 接口"></a><a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/crud-interface.html#mapper-crud-%E6%8E%A5%E5%8F%A3">Mapper CRUD 接口</a></h2><blockquote>
<p>说明:</p>
<ul>
<li>通用 CRUD 封装<a target="_blank" rel="noopener" href="https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-core/src/main/java/com/baomidou/mybatisplus/core/mapper/BaseMapper.java">BaseMapper (opens new window)</a>接口，为 <code>Mybatis-Plus</code> 启动时自动解析实体表关系映射转换为 <code>Mybatis</code> 内部对象注入容器</li>
<li>泛型 <code>T</code> 为任意实体对象</li>
<li>参数 <code>Serializable</code> 为任意类型主键 <code>Mybatis-Plus</code> 不推荐使用复合主键约定每一张表都有自己的唯一 <code>id</code> 主键</li>
<li>对象 <code>Wrapper</code> 为 <a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/wrapper.html">条件构造器</a></li>
</ul>
</blockquote>
<hr>
<p>以下是Mapper接口中的CRUD方法介绍</p>
<h4 id="一-查询"><a href="#一-查询" class="headerlink" title="一:查询"></a>一:查询</h4><ol>
<li>selectById() 通过单个主键值查询 只需要传入主键值即可  <strong>SELECT id,name FROM people WHERE id&#x3D;?</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * selectById 根据单个主键值查询</span></span><br><span class="line"><span class="comment"> * 参数:主键值</span></span><br><span class="line"><span class="comment"> * 返回值:实体对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">People</span> <span class="variable">people1</span> <span class="operator">=</span> peopleMapper.selectById(<span class="number">1</span>);</span><br><span class="line">System.out.println(people1);</span><br></pre></td></tr></table></figure>

<p><strong>如果id值对应的行不存在 会返回空 所以一般使用会判断是否为空 再做其他操作</strong></p>
<ol start="2">
<li>selectBatchIds() 批处理查询 通过多个主键值的一个集合 来查询满足条件的数据 返回值是一个集合 如果没有满足条件的数据 则返回null  <strong>SELECT id,name FROM people WHERE id IN ( ? , ? , ? )</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * selectBatchIds 批处理查询 根据多个主键值查询</span></span><br><span class="line"><span class="comment"> * 参数:id的集合</span></span><br><span class="line"><span class="comment"> * 返回值:集合List&lt;T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;Integer&gt; collect = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>).collect(Collectors.toList());</span><br><span class="line">List&lt;People&gt; people1 = peopleMapper.selectBatchIds(collect);</span><br><span class="line">System.out.println(people1);</span><br><span class="line"><span class="keyword">for</span> (People people2 : people1) &#123;</span><br><span class="line">    System.out.println(people2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>selectByMap() 通过将多条件字段字段封装到map中 通过读取map中的值来拼接条件 来实现  <strong>SELECT id,name FROM people WHERE name &#x3D; ? AND id &#x3D; ?</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * selectMap 使用map封装多条件字段查询</span></span><br><span class="line"><span class="comment">  * 参数:Map&lt;String,Object&gt;</span></span><br><span class="line"><span class="comment">  * 返回值:集合List&lt;T&gt;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"> map.put(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>);</span><br><span class="line"> map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;易顺坤&quot;</span>);</span><br><span class="line"> List&lt;People&gt; people1 = peopleMapper.selectByMap(map);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (People people2 : people1) &#123;</span><br><span class="line">     System.out.println(people2);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>4.selectList() 通过传入实体类 更具实体类中的字段值解析为条件 查询</p>
<p>……</p>
<p><strong>注意:</strong> 当select操作条件为null时默认查询表中全部数据</p>
<h4 id="二-更新"><a href="#二-更新" class="headerlink" title="二:更新"></a>二:更新</h4><ol>
<li>updateById(实体类对象);</li>
</ol>
<p>通过传入实体类对象根据实体类对象中的声明主键的值, 自动生成where条件 where id&#x3D;?  , 然后以实体类中的其他非null属性的值对表中的数据进行修改(<strong>注意:包装类的默认值是null 而基本数据类型默认值不一定是null 如int类型默认值是0</strong>)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新操作（update）</span></span><br><span class="line"><span class="comment">     * 通过对象的形式传入要修改的数据 默认修改传入对象中非null属性的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextLoads1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">        people.setId(<span class="number">2</span>);</span><br><span class="line">        people.setName(<span class="string">&quot;易顺坤&quot;</span>);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * updateById()顾名思义就是条件是根据id的</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> peopleMapper.updateById(people);</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;cg&quot;</span>:<span class="string">&quot;sb&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;People&gt; people1 = peopleMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (People people2 : people1) &#123;</span><br><span class="line">            System.out.println(people2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="三-删除"><a href="#三-删除" class="headerlink" title="三:删除"></a>三:删除</h4><ol>
<li>deleteById 通过传入的实体类中声明的主键值 来生成where条件 delete from tablename where id &#x3D; ?  也可以直接传入一个id值</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> peopleMapper.deleteById(<span class="number">3</span>);</span><br><span class="line"><span class="comment">/**************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">people.setId(<span class="number">2</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* deleteById()顾名思义就是条件是根据id的</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> peopleMapper.deleteById(people);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>deleteByMap 将字段条件通过键值对的方式封装到map中 再调用deleteByMap方法 将map中的值读取填入where之后 多个字段以and方式连接 <strong>DELETE FROM people WHERE name &#x3D; ? AND id &#x3D; ?</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * deleteByMap()通过map存储条件字段键值对 多个字段 在where条件后用and连接</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * DELETE FROM people WHERE name = ? AND id = ?</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">map.put(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>);</span><br><span class="line">map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;丁杨维&quot;</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> peopleMapper.deleteByMap(map);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>deleteBatchIds 通过id批量删除 是通过in关键字 填入where条件关键字之后 <strong>DELETE FROM people WHERE id IN ( ? , ? )</strong></li>
</ol>
<blockquote>
<ul>
<li><p>deleteBatchIds() 批处理方式:使用多个主键值,删除数据</p>
</li>
<li><p>参数:Collection&lt;? extends Serializable&gt; </p>
</li>
<li><p>返回值删除的记录数</p>
</li>
</ul>
</blockquote>
<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">         * deleteBatchIds() 批处理方式:使用多个主键值,删除数据</span></span><br><span class="line"><span class="comment">         * 参数:Collection&lt;? extends Serializable&gt;</span></span><br><span class="line"><span class="comment">         * 返回值删除的记录数</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="number">4</span>);</span><br><span class="line">        list.add(<span class="number">6</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> peopleMapper.deleteBatchIds(list);</span><br></pre></td></tr></table></figure>

<p>新知识:可以通过Stream.Of().collect(Collectors.toList())的方式创建List集合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;?&gt; list = Stream.of(Object,Object....).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>

<h4 id="四-插入"><a href="#四-插入" class="headerlink" title="四:插入"></a>四:插入</h4><ul>
<li>insert() 通过创建一个实体对象 再调用mapper的insert方法即可完成插入 <strong>INSERT INTO people ( name ) VALUES ( ? )</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">People</span> <span class="variable">people1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>(<span class="literal">null</span>, <span class="string">&quot;fan&quot;</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> peopleMapper.insert(people1);</span><br></pre></td></tr></table></figure>

<h2 id="AR操作"><a href="#AR操作" class="headerlink" title="AR操作"></a><strong>AR操作</strong></h2><h4 id="ActiveRecord简介"><a href="#ActiveRecord简介" class="headerlink" title="ActiveRecord简介:"></a>ActiveRecord简介:</h4><ul>
<li>每一个数据库表对应创建一个类,类的每一个对象实例对应于数据库中表的一行记录;通常表的每个字段在类中都有相应的Field;</li>
<li>ActiveRecord 负责把自己持久化,在ActiveRecord中封装了对数据库的访问,通过对象自己实现CRUD,实现优雅的数据库操作</li>
<li>ActiveRecord也封住给你了部分业务逻辑.可以作为业务对象使用</li>
</ul>
<h4 id="快速开始-1"><a href="#快速开始-1" class="headerlink" title="快速开始"></a>快速开始</h4><ul>
<li>创建表</li>
<li>创建springboot整合mybatis-plus项目 与前面操作一致</li>
<li>编写实体类 继承Model<T>(这个Model时Mybatis-plus中的 这个Model中封装了很多crud方法实现机制 也是mybatis中的sqlsession)</li>
</ul>
<p>​    entity.People.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Devil</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2022-01-21-23:08</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 使用AR,要求实体类需要继承MP中的Model</span></span><br><span class="line"><span class="comment"> *Model中提供了对数据库的CRUD的操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">extends</span> <span class="title class_">Model</span>&lt;People&gt; &#123;</span><br><span class="line">    <span class="comment">//定义属性,属性名和表的列名一样</span></span><br><span class="line">    <span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">            value = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">            type = IdType.AUTO</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写Mapper接口继承BaseMapper<T></li>
</ul>
<p>​    加上@Mapper注解</p>
<p>​    注意:<strong>我们后续使用不使用该mapper而是使用实体类的对象(继承了Model的原因 实体类对象已经具有了对数据库表的crud操作)</strong> 该mapper是不需要使用的,MP需要使用该mapper获取数据库的表的信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Devil</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2022-01-21-23:22</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * PeopleMapper是不需要使用的,Mp需要使用PeopleMapper获取数据库的表的信息.</span></span><br><span class="line"><span class="comment"> * 如果不定义DeptMapper,MP会报错</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PeopleMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;People&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="AR的CRUD操作"><a href="#AR的CRUD操作" class="headerlink" title="AR的CRUD操作"></a>AR的CRUD操作</h4><h5 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h5><ul>
<li>创建一个实体对象 设置属性 再使用该对象调用继承来的insert方法 就可以完成插入操作</li>
<li>返回值是一个boolean值</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">people.setId(<span class="number">4</span>);</span><br><span class="line">people.setName(<span class="string">&quot;xie&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">insert</span> <span class="operator">=</span> people.insert();</span><br></pre></td></tr></table></figure>

<h5 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h5><ul>
<li>deleteById() 创建一个实体对象 只需要设置属性主键值(也可不设置 直接在方法参数上写) 再调用该方法 就会识别主键值 并根据主键值进行删除操作 <strong>DELETE FROM people WHERE id&#x3D;?</strong></li>
<li>返回值是boolean(注意与其他操作不同 这里的删除操作只要语句正确就不会为false)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">people.setId(<span class="number">5</span>);</span><br><span class="line"><span class="comment">/** 根据对象设置的主键id的值删除记录*/</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">delete</span> <span class="operator">=</span> people.deleteById();</span><br></pre></td></tr></table></figure>

<h5 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h5><ul>
<li>selectById() 创建一个实体对象 只需要设置属性主键值(也可不设置 直接在方法参数上写) 再调用该方法 就会识别主键值 并根据主键值进行查询操作 <strong>SELECT id,name FROM people WHERE id&#x3D;?</strong></li>
<li><strong>有记录返回值是一个Object 如果在创建实体类时继承Model设置了泛型那么返回值就是实体类的类型 无记录就是一个null</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">        people.setId(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">/** 根据对象设置的主键id的值查询记录*/</span></span><br><span class="line">        <span class="type">People</span> <span class="variable">people1</span> <span class="operator">=</span> people.selectById(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>还有如下方法</p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122174725782.png" alt="image-20220122174725782"></p>
<h5 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h5><ol>
<li>updateById() 创建一个实体对象 设置属性主键值 和其他属性 调用对象的updateById()方法 它会自动识别主键值(前面我们创建类时 设置了主键信息)并 修改 <strong>默认修改对象中非空的值</strong><ul>
<li>返回值是boolean</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">People</span> <span class="variable">people</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">        people.setId(<span class="number">1</span>);</span><br><span class="line">        people.setName(<span class="string">&quot;kun&quot;</span>);</span><br><span class="line">        <span class="comment">/** 根据对象设置的主键id的值更新记录*/</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">update</span> <span class="operator">=</span> people.updateById();</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="主键类型"><a href="#主键类型" class="headerlink" title="主键类型"></a><strong>主键类型</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">IdType</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库ID自增</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;该类型请确保数据库设置了 ID自增 否则无效&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AUTO(<span class="number">0</span>),</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该类型为未设置主键类型(注解里等于跟随全局,全局里约等于 INPUT)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    NONE(<span class="number">1</span>),</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户输入ID</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;该类型可以通过自己注册自动填充插件进行填充&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    INPUT(<span class="number">2</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 以下3种类型、只有当插入对象ID 为空，才自动填充。 */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分配ID (主键类型为number或string）,</span></span><br><span class="line"><span class="comment">     * 默认实现类 &#123;<span class="doctag">@link</span> com.baomidou.mybatisplus.core.incrementer.DefaultIdentifierGenerator&#125;(雪花算法)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 3.3.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ASSIGN_ID(<span class="number">3</span>),</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分配UUID (主键类型为 string)</span></span><br><span class="line"><span class="comment">     * 默认实现类 &#123;<span class="doctag">@link</span> com.baomidou.mybatisplus.core.incrementer.DefaultIdentifierGenerator&#125;(UUID.replace(&quot;-&quot;,&quot;&quot;))</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ASSIGN_UUID(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> key;</span><br><span class="line"></span><br><span class="line">    IdType(<span class="type">int</span> key) &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过上述枚举类型 我们可以知道共有五种主键类型</p>
<p><strong>IdType</strong> 对于自动填充 只有当插入对象ID 为空，才自动填充。</p>
<ul>
<li><strong>0.NONE</strong> : 没有主键类型</li>
<li><strong>1.AUTO</strong> : 自动增长 前提是确保数据库设置了 ID自增 否则无效</li>
<li><strong>2.INPUT</strong> : 手工输入</li>
<li><strong>3.ASSIGN_ID</strong> :</li>
</ul>
<blockquote>
<p>分配ID (主键类型为number或string）  </p>
<p>默认实现类 {@link com.baomidou.mybatisplus.core.incrementer.DefaultIdentifierGenerator}(雪花算法) </p>
</blockquote>
<ul>
<li><strong>4.ASSIGN_UUID</strong> :</li>
</ul>
<blockquote>
<p> 分配UUID (主键类型为 string)</p>
<p>默认实现类 {@link com.baomidou.mybatisplus.core.incrementer.DefaultIdentifierGenerator}(UUID.replace(“-“,””))</p>
</blockquote>
<p>​    </p>
<h4 id="IdType-AUTO"><a href="#IdType-AUTO" class="headerlink" title="IdType.AUTO"></a>IdType.AUTO</h4><ol>
<li>表中建表使用数字作为主键, 设置主键id自增</li>
</ol>
<p>​    <img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122180836796.png" alt="image-20220122180836796"></p>
<ol start="2">
<li>实体类表中主键值也要为数字类型 并添加注解@TableId 设置主键以及主键类型</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">extends</span> <span class="title class_">Model</span>&lt;People&gt; &#123;</span><br><span class="line">    <span class="comment">//定义属性,属性名和表的列名一样</span></span><br><span class="line">    <span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">            value = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">            type = IdType.AUTO</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="IdType-ASSIGN-ID"><a href="#IdType-ASSIGN-ID" class="headerlink" title="IdType.ASSIGN_ID"></a>IdType.ASSIGN_ID</h4><ol>
<li>使用时需要在数据库表中 需要取消主键自动增长 并且设置主键类型时bigint 因为这个主键的值很大 int类型大小不够 <strong>还可以使用varchar(50)类型</strong></li>
</ol>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122182035368.png" alt="image-20220122182035368"></p>
<ol start="2">
<li>实体类中将主键类型设置为Long原因与上述一样 并且设置注解@TableId中type的值为<strong>IdType.ASSIGN_ID</strong> <strong>如果数据库中主键使用varchar(50)那么相应的实体类中的主键类型也应当为String类型</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">extends</span> <span class="title class_">Model</span>&lt;People&gt; &#123;</span><br><span class="line">    <span class="comment">//定义属性,属性名和表的列名一样</span></span><br><span class="line">    <span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">            value = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">            type = IdType.ASSIGN_ID</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> Long/String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122182324329.png" alt="image-20220122182324329"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122182719124.png" alt="image-20220122182719124"></p>
<h4 id="IdType-ASSIGN-UUID"><a href="#IdType-ASSIGN-UUID" class="headerlink" title="IdType.ASSIGN_UUID"></a>IdType.ASSIGN_UUID</h4><ol>
<li>使用时需要在数据库表中, 将主键类型设置为varchar(50)类型</li>
</ol>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122183109184.png" alt="image-20220122183109184"></p>
<ol start="2">
<li>实体类中的主键类型设置为String类型 并且注解@TableId中需要将type设置为<strong>IdType.ASSIGN_UUID</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">extends</span> <span class="title class_">Model</span>&lt;People&gt; &#123;</span><br><span class="line">    <span class="comment">//定义属性,属性名和表的列名一样</span></span><br><span class="line">    <span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">            value = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">            type = IdType.ASSIGN_UUID</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122183419332.png" alt="image-20220122183419332"></p>
<p>分布式中推荐使用 <strong>IdType.ASSIGN_ID</strong> 它可以生成数字而且长度更短更有规律</p>
<hr>
<h2 id="指定表名"><a href="#指定表名" class="headerlink" title="指定表名"></a><strong>指定表名</strong></h2><ul>
<li>定义实体类,默认的表名和实体类同名; 如果不一致,在实体类上面使用@TableName说明表名称</li>
<li>例如: <strong>@TableName(value&#x3D;”数据库表名”)</strong> </li>
<li>使用: 在实体类的上方</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableName(value = &quot;people&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">extends</span> <span class="title class_">Model</span>&lt;People&gt; &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="指定列名"><a href="#指定列名" class="headerlink" title="指定列名"></a><strong>指定列名</strong></h2><ul>
<li>在实际开发中, 不能完全出现实体类中的属性名与 数据库表中的列名完全一致; 如果不一致,在实体类上面使用@TableField完成两者之间的映射关系</li>
<li>例如:<strong>@TableField(value&#x3D;”数据库表中的列名”)</strong> 查询时需要将结果封装成一个一个的对象时 需要在@TableName中设置<strong>autoResultMap &#x3D; true</strong> 否则在使用了@TableField后可能会出现控制的情况</li>
<li>使用: 在实体类中的属性的上方</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义属性,属性名和表的列名一样</span></span><br><span class="line"><span class="meta">@TableId(</span></span><br><span class="line"><span class="meta">        value = &quot;pid&quot;,</span></span><br><span class="line"><span class="meta">        type = IdType.ASSIGN_UUID</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@TableField(value = &quot;pid&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String id;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="驼峰命名"><a href="#驼峰命名" class="headerlink" title="驼峰命名"></a>驼峰命名</h4><p>上述 在开发中使用@TableField指定属性与表中的列名的映射关系十分麻烦</p>
<p>一般在设计数据库表时采用下划线的方式命名 如<strong>user_name</strong></p>
<p>​    这就引申出Mybatis-plus的另一个特性 驼峰命名 即: <strong>列名使用下划线,属性名时驼峰命名的方式.Mybatis-plus默认支持这种规则.</strong> (即列名为: user_name  属性名为:userName 不需要使用@TableField Mybatis-plus同样能够识别)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">列名: people_name</span><br><span class="line">属性名: <span class="keyword">private</span> String peopleName;</span><br></pre></td></tr></table></figure>

<h2 id="自定义mapper"><a href="#自定义mapper" class="headerlink" title="自定义mapper"></a><strong>自定义mapper</strong></h2><p>自定义mapper</p>
<p>与mybatis一样 需要在创建一个接口写入自定义的方法 然后再编写一个mapper.xml文件 声明namespace 方法标签 resultType 和自定义方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.dyw.mybatisplus05mapper.mapper.PersonMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectAllPerson&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.dyw.mybatisplus05mapper.entity.Person&quot;</span>&gt;</span></span><br><span class="line">        select pid,people_name from people order by pid</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>做完一切之后可以选择再mapper接口上加上@Mapper注解 或者 在启动类上加上@MapperScan(value&#x3D;”mapper接口路径”) 用来指明mapper的位置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PersonMapper</span> &#123;</span><br><span class="line">    List&lt;Person&gt; <span class="title function_">selectAllPerson</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后在application.yml中声明mapper.xml的路径</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath*:xml/*mapper.xml</span></span><br></pre></td></tr></table></figure>

<p><strong>这样的方法也同样适用于Springboot+mybatis(@Mapper&#x2F;@MapperScan+mapper.xml)</strong></p>
<p><strong>还有一种方法 @Mapper&#x2F;@MapperScan+@crud操作</strong> 也同样适用于mybatis 或者说正是因为mybatis有 所以mybatis-plus也支持</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Mapper</span><br><span class="line">@SuppressWarnings(&quot;all&quot;)</span><br><span class="line">public interface PersonMapper &#123;</span><br><span class="line">    @Select(&quot;select pid,people_name from people order by pid&quot;)</span><br><span class="line">    List&lt;Person&gt; selectAllPerson();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Mapper和@MapperScan作用 告诉了程序mapper接口在哪 </p>
<h2 id="条件构造器"><a href="#条件构造器" class="headerlink" title="条件构造器"></a><strong>条件构造器</strong></h2><h4 id="条件构造器-Wrapper"><a href="#条件构造器-Wrapper" class="headerlink" title="条件构造器: Wrapper"></a>条件构造器: Wrapper</h4><p>QueryWrapper(LambdaQueryWrapper) 和 UpdateWrapper(LambdaUpdateWrapper)的父类 用于生成sql的where条件,entity属性也用于生成sql的where条件,MP3.0开始支持lambda表达式, LambdaQueryWrapper, LambdaUpdateWrapper 支持lambda表达式的构造查询条件</p>
<p><strong>注意:</strong> entity 生成的 where 条件与 使用各个 api 生成的 where 条件<strong>没有任何关联行为</strong></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122210417087.png" alt="image-20220122210417087"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122210440192.png" alt="image-20220122210440192"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122210457290.png" alt="image-20220122210457290"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122210545890.png" alt="image-20220122210545890"></p>
<p><strong>使用时根据不同的crud操作选择不同的条件封装类</strong></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122211725390.png" alt="image-20220122211725390"></p>
<p>实际使用的例子都在官方文档中可以查看<a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/wrapper.html#abstractwrapper">条件构造器</a></p>
<p>具体使用</p>
<h5 id="allEq"><a href="#allEq" class="headerlink" title="allEq"></a>allEq</h5><h6 id="1-allEq-Map-lt-R-V-gt-params"><a href="#1-allEq-Map-lt-R-V-gt-params" class="headerlink" title="1. allEq(Map&lt;R, V&gt; params)"></a>1. allEq(Map&lt;R, V&gt; params)</h6><ul>
<li>根据不同的crud选择不同的条件封装类 创建相应的条件封装类实体 </li>
<li>由于要使用allEq(Map&lt;R, V&gt; params)方法, 它的参数是一个map 所以需要新建一个map, map中的键值对 就是条件 用<strong>and连接</strong></li>
<li>再调用mapper的方法将封装类实体传入</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 alleq</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*map&lt;key,value&gt; key:列名 value:条件的值 */</span></span><br><span class="line">map.put(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>);</span><br><span class="line">map.put(<span class="string">&quot;people_name&quot;</span>,<span class="string">&quot;kun&quot;</span>);</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.allEq(map);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122212326283.png" alt="image-20220122212326283"></p>
<hr>
<h6 id="2-allEq-Map-lt-R-V-gt-params-boolean-null2IsNull"><a href="#2-allEq-Map-lt-R-V-gt-params-boolean-null2IsNull" class="headerlink" title="2. allEq(Map&lt;R, V&gt; params,boolean null2IsNull)"></a>2. allEq(Map&lt;R, V&gt; params,boolean null2IsNull)</h6><ul>
<li><p>后面的boolean值是用来处理传入的map中的value空值的.</p>
<blockquote>
<p>true: 将map中value控制用is 拼接</p>
<p>false: 忽略空value和key 不对该字段进行拼接</p>
</blockquote>
</li>
</ul>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122213108202.png" alt="image-20220122213108202"></p>
<p><img src="https://gitee.com/Devildyw/blogimage/raw/master/img/image-20220122213134669.png" alt="image-20220122213134669"></p>
<hr>
<h5 id="eq-封装单个条件"><a href="#eq-封装单个条件" class="headerlink" title="eq: 封装单个条件"></a>eq: 封装单个条件</h5><h6 id="eq-R-column-Object-val-列名-值"><a href="#eq-R-column-Object-val-列名-值" class="headerlink" title="eq(R column, Object val): 列名,值"></a>eq(R column, Object val): 列名,值</h6><p>使用条件封装类的实体类的eq方法 调用直接填入列名和相应的值即可 是使用的’&#x3D;’连接</p>
<p><code>SELECT pid,people_name FROM people WHERE (pid = ?)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 eq</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.eq(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="ne-不等于"><a href="#ne-不等于" class="headerlink" title="ne:不等于"></a>ne:不等于</h5><h6 id="ne-R-column-Object-val-表示-lt-gt-和-x3D"><a href="#ne-R-column-Object-val-表示-lt-gt-和-x3D" class="headerlink" title="ne(R column, Object val) 表示&lt;&gt; 和 !&#x3D;"></a>ne(R column, Object val) 表示&lt;&gt; 和 !&#x3D;</h6><ul>
<li>使用列名, 值 通过&lt;&gt; 拼接  </li>
<li><code>Preparing: SELECT pid,people_name FROM people WHERE (pid &lt;&gt; ?)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 eq</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.ne(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="gt-大于"><a href="#gt-大于" class="headerlink" title="gt:大于"></a>gt:大于</h5><h6 id="gt-R-column-Object-val-表示-gt"><a href="#gt-R-column-Object-val-表示-gt" class="headerlink" title="gt(R column, Object val) 表示 &gt;"></a>gt(R column, Object val) 表示 &gt;</h6><ul>
<li>使用列名, 值 通过&gt; 拼接  </li>
<li><code>SELECT pid,people_name FROM people WHERE (pid &gt; ?)</code></li>
</ul>
<hr>
<h5 id="ge-大于等于"><a href="#ge-大于等于" class="headerlink" title="ge:大于等于"></a>ge:大于等于</h5><h6 id="ge-R-column-Object-val-表示-gt-x3D"><a href="#ge-R-column-Object-val-表示-gt-x3D" class="headerlink" title="ge(R column, Object val) 表示 &gt;&#x3D;"></a>ge(R column, Object val) 表示 &gt;&#x3D;</h6><ul>
<li>使用列名, 值 通过&gt;&#x3D; 拼接  </li>
<li><code>SELECT pid,people_name FROM people WHERE (pid &gt;= ?)</code></li>
</ul>
<hr>
<h5 id="lt-小于"><a href="#lt-小于" class="headerlink" title="lt:小于"></a>lt:小于</h5><h6 id="lt-R-column-Object-val-表示-lt"><a href="#lt-R-column-Object-val-表示-lt" class="headerlink" title="lt(R column, Object val) 表示 &lt;"></a>lt(R column, Object val) 表示 &lt;</h6><ul>
<li>使用列名, 值 通过&lt; 拼接  </li>
<li><code>SELECT pid,people_name FROM people WHERE (pid &lt; ?)</code></li>
</ul>
<hr>
<h5 id="le-小于等于"><a href="#le-小于等于" class="headerlink" title="le:小于等于"></a>le:小于等于</h5><h6 id="lt-R-column-Object-val-表示-lt-x3D"><a href="#lt-R-column-Object-val-表示-lt-x3D" class="headerlink" title="lt(R column, Object val) 表示 &lt;&#x3D;"></a>lt(R column, Object val) 表示 &lt;&#x3D;</h6><ul>
<li>使用列名, 值 通过&lt;&#x3D; 拼接  </li>
<li><code>SELECT pid,people_name FROM people WHERE (pid &lt;= ?)</code></li>
</ul>
<hr>
<h5 id="between-两个值范围之间-gt-x3D-and-lt-x3D"><a href="#between-两个值范围之间-gt-x3D-and-lt-x3D" class="headerlink" title="between: 两个值范围之间(&gt;&#x3D; and &lt;&#x3D;)"></a>between: 两个值范围之间(&gt;&#x3D; and &lt;&#x3D;)</h5><h6 id="1-between-R-column-Object-val1-Object-val2-列名-值1-值2"><a href="#1-between-R-column-Object-val1-Object-val2-列名-值1-值2" class="headerlink" title="1.between(R column, Object val1, Object val2) 列名 值1 值2"></a>1.between(R column, Object val1, Object val2) 列名 值1 值2</h6><ul>
<li><p>通过列名相同的两个值 来创建两个值范围之间的条件 通过<strong>between</strong>拼接</p>
</li>
<li><p><code>SELECT pid,people_name FROM people WHERE (pid BETWEEN ? AND ?)</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 between</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.between(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="2-notBetween-R-column-Object-val1-Object-val2-列名-值1-值2"><a href="#2-notBetween-R-column-Object-val1-Object-val2-列名-值1-值2" class="headerlink" title="2. notBetween(R column, Object val1, Object val2) 列名 值1 值2"></a>2. notBetween(R column, Object val1, Object val2) 列名 值1 值2</h6><ul>
<li><p>通过列名相同的两个值 来创建两个值范围之间的条件 通过<strong>between</strong>拼接</p>
</li>
<li><p><code>SELECT pid,people_name FROM people WHERE (pid NOT BETWEEN ? AND ?)</code></p>
</li>
</ul>
<hr>
<h5 id="like-模糊查询"><a href="#like-模糊查询" class="headerlink" title="like 模糊查询"></a>like 模糊查询</h5><h6 id="1-like-R-column-Object-val-列名-值"><a href="#1-like-R-column-Object-val-列名-值" class="headerlink" title="1. like(R column, Object val) 列名 值"></a>1. like(R column, Object val) 列名 值</h6><ul>
<li>like模糊查询 在值的前后都是用%拼接( %val% ) 查询之中存在val的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name LIKE ?)  Parameters: %k%(String)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 like</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.like(<span class="string">&quot;people_name&quot;</span>,<span class="string">&quot;k&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="2-notLike-R-column-Object-val-列名-值"><a href="#2-notLike-R-column-Object-val-列名-值" class="headerlink" title="2. notLike(R column, Object val) 列名 值"></a>2. notLike(R column, Object val) 列名 值</h6><ul>
<li>notLike模糊查询 在值的前后都是用%拼接( %val%)  查询之中不存在val的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name NOT LIKE ?)  Parameters: %k%(String)</code></li>
</ul>
<hr>
<h6 id="3-likeLeft-R-column-Object-val-列名-值"><a href="#3-likeLeft-R-column-Object-val-列名-值" class="headerlink" title="3. likeLeft(R column, Object val) 列名 值"></a>3. likeLeft(R column, Object val) 列名 值</h6><ul>
<li>likeLeft模糊查询 在值的左边用%拼接( %val)  查询以val结尾的的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name LIKE ?)  Parameters: %k(String)</code></li>
</ul>
<hr>
<h6 id="4-likeLeft-R-column-Object-val-列名-值"><a href="#4-likeLeft-R-column-Object-val-列名-值" class="headerlink" title="4. likeLeft(R column, Object val) 列名 值"></a>4. likeLeft(R column, Object val) 列名 值</h6><ul>
<li>likeLeft模糊查询 在值的右边用%拼接( val%)  查询以val开头的的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name LIKE ?)  Parameters: k%(String)</code></li>
</ul>
<hr>
<h5 id="null-判空"><a href="#null-判空" class="headerlink" title="null: 判空"></a>null: 判空</h5><h6 id="1-isNull-R-column-列名"><a href="#1-isNull-R-column-列名" class="headerlink" title="1.isNull(R column) 列名"></a>1.isNull(R column) 列名</h6><ul>
<li>判断所指列名为空的情况 以 is null 连接</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name IS NULL)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 like</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.isNull(<span class="string">&quot;people_name&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="1-isNull-R-column-列名-1"><a href="#1-isNull-R-column-列名-1" class="headerlink" title="1.isNull(R column) 列名"></a>1.isNull(R column) 列名</h6><ul>
<li>判断所指列名为不为空的情况 以 is not null 连接</li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name IS NOT NULL)</code></li>
</ul>
<hr>
<h5 id="in-集合查询"><a href="#in-集合查询" class="headerlink" title="in 集合查询"></a>in 集合查询</h5><h6 id="1-in-R-column-Object…-values-列名-值1…-也可以传入一个集合"><a href="#1-in-R-column-Object…-values-列名-值1…-也可以传入一个集合" class="headerlink" title="1. in(R column, Object… values) 列名,值1…..  也可以传入一个集合"></a>1. in(R column, Object… values) 列名,值1…..  也可以传入一个集合</h6><ul>
<li>in查询 将值封装到一个集合中 底层是or连接 查询满足集合范围中条件的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (pid IN (?,?,?))</code></li>
</ul>
<h6 id="2-notIn-R-column-Object…-values-列名-值1…-也可以传入一个集合"><a href="#2-notIn-R-column-Object…-values-列名-值1…-也可以传入一个集合" class="headerlink" title="2. notIn(R column, Object… values) 列名,值1…..  也可以传入一个集合"></a>2. notIn(R column, Object… values) 列名,值1…..  也可以传入一个集合</h6><ul>
<li>in查询 将值封装到一个集合中 底层是or连接 查询不符合集合范围中条件的数据</li>
<li><code>SELECT pid,people_name FROM people WHERE (pid NOT IN (?,?,?))</code></li>
</ul>
<hr>
<h5 id="inSql-子查询"><a href="#inSql-子查询" class="headerlink" title="inSql 子查询"></a>inSql 子查询</h5><h6 id="1-inSql-R-column-String-inValue-列名-子查询语句"><a href="#1-inSql-R-column-String-inValue-列名-子查询语句" class="headerlink" title="1. inSql(R column, String inValue) 列名, 子查询语句"></a>1. inSql(R column, String inValue) 列名, 子查询语句</h6><ul>
<li>类型于in(),  前面的列名用来筛选子查询结果中符合条件的值 将其放在in()的集合中 后续步骤与in查询一致  </li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name IN (select people_name from people where pid = 1))</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 inSql</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.inSql(<span class="string">&quot;people_name&quot;</span>,<span class="string">&quot;select people_name from people where pid = 1&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="2-notInSql-R-column-String-inValue-列名-子查询语句"><a href="#2-notInSql-R-column-String-inValue-列名-子查询语句" class="headerlink" title="2. notInSql(R column, String inValue) 列名, 子查询语句"></a>2. notInSql(R column, String inValue) 列名, 子查询语句</h6><ul>
<li>类型于notIn(),  前面的列名用来筛选子查询结果中符合条件的值 将其放在in()的集合中 后续步骤与notIn查询一致  </li>
<li><code>SELECT pid,people_name FROM people WHERE (people_name NOT IN (select people_name from people where pid = 1))</code></li>
</ul>
<hr>
<h5 id="groupBy-分组函数"><a href="#groupBy-分组函数" class="headerlink" title="groupBy 分组函数"></a>groupBy 分组函数</h5><h6 id="1-groupBy-R-column-列名"><a href="#1-groupBy-R-column-列名" class="headerlink" title="1. groupBy(R column): 列名"></a>1. groupBy(R column): 列名</h6><ul>
<li><p>在使用分组函数之前 需要调用Wrapper的select方法 指定要输出的参数 例如<code>select(&quot;people_name, count(*)&quot;);</code></p>
</li>
<li><p>按指定的列名进行分组</p>
</li>
<li><p><code>SELECT people_name, count(*) FROM people GROUP BY people_name</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 groupBy</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">/*封装到Wrapper中*/</span></span><br><span class="line">qw.select(<span class="string">&quot;people_name, count(*)&quot;</span>);</span><br><span class="line">qw.groupBy(<span class="string">&quot;people_name&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="orderBy-排序"><a href="#orderBy-排序" class="headerlink" title="orderBy 排序"></a>orderBy 排序</h5><h6 id="1-orderByAsc-R-column-列名"><a href="#1-orderByAsc-R-column-列名" class="headerlink" title="1. orderByAsc(R column) 列名"></a>1. orderByAsc(R column) 列名</h6><ul>
<li><p>按列名字段升序排序 还可以设置多个列名字段 来作为第二排序字段 也可以是集合</p>
</li>
<li><p><code>SELECT pid,people_name FROM people ORDER BY pid ASC</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 orderBy</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">qw.orderByAsc(<span class="string">&quot;pid&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="2-orderByDesc-R-column-列名"><a href="#2-orderByDesc-R-column-列名" class="headerlink" title="2. orderByDesc(R column) 列名"></a>2. orderByDesc(R column) 列名</h6><ul>
<li><p>按列名字段降序排序 还可以设置多个列名字段 来作为第二排序字段 也可以是集合</p>
</li>
<li><p><code>SELECT pid,people_name FROM people ORDER BY pid DESC</code></p>
</li>
</ul>
<hr>
<h6 id="3-orderBy-boolean-condition-boolean-isAsc-R-column-条件-是否升序-列名字段"><a href="#3-orderBy-boolean-condition-boolean-isAsc-R-column-条件-是否升序-列名字段" class="headerlink" title="3. orderBy(boolean condition, boolean isAsc, R column) 条件 是否升序 列名字段"></a>3. orderBy(boolean condition, boolean isAsc, R column) 条件 是否升序 列名字段</h6><ul>
<li><p>按列isAsc来判断是否是升序 还是降序排序 还可以设置多个列名字段 来作为第二排序字段 也可以是集合</p>
</li>
<li><p><code>SELECT pid,people_name FROM people ORDER BY pid ASC/DESC</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 orderBy</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">qw.orderBy(<span class="literal">true</span>,<span class="literal">true</span>,<span class="string">&quot;pid&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<h6 id="4-多字段不同排序规则排序"><a href="#4-多字段不同排序规则排序" class="headerlink" title="4. 多字段不同排序规则排序"></a>4. 多字段不同排序规则排序</h6><ul>
<li><p>可以在上述的方法后再调用orderBy()相关方法 完成多字段不同排序规则排序 可拼接多个</p>
</li>
<li><p><code>qw.orderBy(true,true,&quot;pid&quot;).orderBy(true,false,&quot;people_name&quot;);</code></p>
</li>
<li><p><code>SELECT pid,people_name FROM people ORDER BY pid ASC,people_name DESC</code></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 orderBy</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">qw.orderBy(<span class="literal">true</span>,<span class="literal">true</span>,<span class="string">&quot;pid&quot;</span>).orderBy(<span class="literal">true</span>,<span class="literal">false</span>,<span class="string">&quot;people_name&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="or-and-连接词"><a href="#or-and-连接词" class="headerlink" title="or and 连接词"></a>or and 连接词</h5><h6 id="1-and"><a href="#1-and" class="headerlink" title="1. and"></a>1. and</h6><ul>
<li>与or() 有关 再显式调用or()方法时 时使用or来连接 不调用or()方法连接 默认使用and连接</li>
<li><code>qw.eq(&quot;pid&quot;,1).eq(&quot;people_name&quot;,&quot;k&quot;);</code></li>
<li><code>SELECT pid,people_name FROM people WHERE (pid = ? AND people_name = ?)</code></li>
</ul>
<hr>
<h6 id="2-or-无参"><a href="#2-or-无参" class="headerlink" title="2.or() 无参"></a>2.or() 无参</h6><ul>
<li>在单个条件方法后面使用 or() 再拼接另一个条件 以此类推 可拼接多个</li>
<li><code>qw.eq(&quot;pid&quot;,1).or().eq(&quot;people_name&quot;,&quot;k&quot;);</code></li>
<li><code>SELECT pid,people_name FROM people WHERE (pid = ? OR people_name = ?)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建条件构造器 or</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">qw.eq(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>).or().eq(<span class="string">&quot;people_name&quot;</span>,<span class="string">&quot;k&quot;</span>);</span><br><span class="line"><span class="comment">/*调用方法 将条件构造器填入*/</span></span><br><span class="line">List&lt;Person&gt; people = personMapper.selectList(qw);</span><br></pre></td></tr></table></figure>



<p>还有or 和 and 的嵌套用法 再官方文档可以了解<a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/wrapper.html#or">or and 的嵌套</a></p>
<hr>
<h5 id="last-末尾拼接"><a href="#last-末尾拼接" class="headerlink" title="last 末尾拼接"></a>last 末尾拼接</h5><h6 id="1-last-String-lastSql-拼接的sql语句"><a href="#1-last-String-lastSql-拼接的sql语句" class="headerlink" title="1. last(String lastSql) 拼接的sql语句"></a>1. last(String lastSql) 拼接的sql语句</h6><ul>
<li>无视优化规则直接拼接到 sql 的最后</li>
<li>会将参数中的sql语句 拼接到末尾 可以调用了方法之后调用</li>
<li><code>qw.gt(&quot;pid&quot;,1).last(&quot;limit 1,10&quot;);</code></li>
<li><code>SELECT pid,people_name FROM people WHERE (pid &gt; ?) limit 1,10</code></li>
</ul>
<p><strong>这种方法存在sql注入风险</strong></p>
<p>**注意: **只能调用一次,多次调用以最后一次为准 有sql注入的风险,请谨慎使用</p>
<hr>
<h5 id="exists"><a href="#exists" class="headerlink" title="exists"></a>exists</h5><h6 id="1-exists-String-existsSql-sql语句"><a href="#1-exists-String-existsSql-sql语句" class="headerlink" title="1. exists(String existsSql) sql语句"></a>1. exists(String existsSql) sql语句</h6><ul>
<li>判断参数中的sql语句 是否成立 符合条件即成立</li>
<li><code> qw.exists(&quot;select pid from people where pid &gt; 7&quot;);</code></li>
<li><code>SELECT pid,people_name FROM people WHERE (EXISTS (select pid from people where pid &gt; 7))</code></li>
</ul>
<hr>
<h6 id="1-notExists-String-existsSql-sql语句"><a href="#1-notExists-String-existsSql-sql语句" class="headerlink" title="1. notExists(String existsSql) sql语句"></a>1. notExists(String existsSql) sql语句</h6><ul>
<li>判断参数中的sql语句 是否成立 不符合条件即成立</li>
<li><code> qw.notExists(&quot;select pid from people where pid &lt;0 &quot;);</code></li>
<li><code>SELECT pid,people_name FROM people WHERE (NOT EXISTS (select pid from people where pid &lt;0 ))</code></li>
</ul>
<hr>
<h5 id="注意-1"><a href="#注意-1" class="headerlink" title="注意:"></a>注意:</h5><p>方法参数<strong>boolean condition</strong> (可以防止条件判断例如name!&#x3D;null)决定后面该条件是否添加 true:添加 false:不添加</p>
<hr>
<h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a><strong>分页</strong></h2><h3 id="InnerInterceptor插件"><a href="#InnerInterceptor插件" class="headerlink" title="InnerInterceptor插件"></a>InnerInterceptor插件</h3><p>我们提供的插件都将基于此接口来实现功能</p>
<p>目前已有的功能:</p>
<ul>
<li>自动分页: <strong>PaginationInnerInterceptor</strong></li>
<li>多租户: TenantLineInnerInterceptor</li>
<li>动态表名: DynamicTableNameInnerInterceptor</li>
<li>乐观锁: OptimisticLockerInnerInterceptor</li>
<li>sql性能规范: IllegalSQLInnerInterceptor</li>
<li>防止全表更新与删除: BlockAttackInnerInterceptor</li>
</ul>
<p>前提: 配置分页插件,实现物理分页. 默认是内存分页</p>
<h3 id="spring-boot"><a href="#spring-boot" class="headerlink" title="spring-boot"></a>spring-boot</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;scan.your.mapper.package&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新的分页插件,一缓和二缓遵循mybatis的规则,需要设置 MybatisConfiguration#useDeprecatedExecutor = false 避免缓存出现问题(该属性会在旧插件移除后一同移除)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">    @Bean</span></span><br><span class="line"><span class="comment">    public ConfigurationCustomizer configurationCustomizer() &#123;</span></span><br><span class="line"><span class="comment">        return configuration -&gt; configuration.setUseDeprecatedExecutor(false);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SpringBoot中创建配置上述配置类 @Configuration @Bean</p>
<p>将MybatisPlusInterceptor组件交给SpringBoot容器</p>
<p>再在使用的时候创建IPage接口对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IPage&lt;Person&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;();<span class="comment">//也可使用有参构造</span></span><br></pre></td></tr></table></figure>

<p>设置完参数过后 使用mapper对象的selectPage方法 返回一个Ipage对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IPage&lt;Person&gt; personIPage = peopleMapper.selectPage(page, qw);</span><br></pre></td></tr></table></figure>

<p>通过该对象 可以获得分页相关的信息(包括查询的记录)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;Person&gt; qw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        qw.ge(<span class="string">&quot;pid&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        IPage&lt;Person&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//设置分页的数据</span></span><br><span class="line"></span><br><span class="line">        page.setCurrent(<span class="number">1</span>);<span class="comment">//设置第几页</span></span><br><span class="line">        page.setSize(<span class="number">4</span>);<span class="comment">//显示多少条记录</span></span><br><span class="line">        IPage&lt;Person&gt; personIPage = peopleMapper.selectPage(page, qw);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取分页后的记录 getRecords()</span></span><br><span class="line">        List&lt;Person&gt; records = personIPage.getRecords();</span><br><span class="line">        System.out.println(records.size());</span><br><span class="line">        <span class="keyword">for</span> (Person record : records) &#123;</span><br><span class="line">            System.out.println(record);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//页数</span></span><br><span class="line">        System.out.println(personIPage.getPages());</span><br><span class="line">        <span class="comment">//总记录数</span></span><br><span class="line">        System.out.println(personIPage.getTotal());</span><br><span class="line">        <span class="comment">//当前页码</span></span><br><span class="line">        System.out.println(personIPage.getCurrent());</span><br><span class="line">        <span class="comment">//每页记录数</span></span><br><span class="line">        System.out.println(personIPage.getSize());</span><br></pre></td></tr></table></figure>



<p><strong>会根据指定的数据库选择分页操作</strong>(mysql是limit)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT pid,people_name FROM people <span class="title function_">WHERE</span> <span class="params">(pid &gt;= ?)</span> LIMIT ?</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="mybatis-config-xml"><a href="#mybatis-config-xml" class="headerlink" title="mybatis-config.xml"></a>mybatis-config.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;@page&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;page:dbType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="代码生成器"><a href="#代码生成器" class="headerlink" title="代码生成器"></a><strong><a target="_blank" rel="noopener" href="https://www.mybatis-plus.com/guide/generator-new.html#%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8-3-5-1-%E7%89%88%E6%9C%AC">代码生成器</a></strong></h2><h4 id="优点"><a href="#优点" class="headerlink" title="优点:"></a>优点:</h4><p>AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p>
<blockquote>
<p>特别说明:</p>
<p>自定义模板有哪些可用参数？<a target="_blank" rel="noopener" href="https://github.com/baomidou/generator/blob/develop/mybatis-plus-generator/src/main/java/com/baomidou/mybatisplus/generator/engine/AbstractTemplateEngine.java">Github (opens new window)</a>AbstractTemplateEngine 类中方法 getObjectMap 返回 objectMap 的所有值都可用。</p>
</blockquote>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用:"></a>使用:</h4><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   // 注意！！当前包未传递依赖 mp 包，需要自己引入</span><br><span class="line">   <span class="comment">&lt;!--模板引擎--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Devil</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">79k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:12</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>-->

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
